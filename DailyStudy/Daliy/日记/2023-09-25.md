# Elasticsearch漏洞防御与检测
## Elasticsearch介绍
[Elasticsearch](https://so.csdn.net/so/search?q=Elasticsearch&spm=1001.2101.3001.7020)是一个开源的高扩展的分布式全文检索引擎，它可以近乎实时的存储、检索数据；本身扩展性很好，可以扩展到上百台服务器，处理PB级别的数据。Elasticsearch也使用Java开发并使用Lucene作为其核心来实现所有索引和搜索的功能，但是它的目的是通过简单的RESTful API来隐藏Lucene的复杂性，从而让全文搜索变得简单。
当ElasticSearch的节点启动后，它会利用多播(multicast)(或者单播，如果用户更改了配置)寻找集群中的其它节点，并与之建立连接。这个过程如下图所示：![[Pasted image 20230925153506.png]]
## 漏洞描述
[ElasticSearch未授权访问的检测与利用思路 // Neurohazard (blkstone.github.io)](https://blkstone.github.io/2017/09/27/elasticsearch-unauthorized-access/)
ES未授权访问：Elasticsearch的增删改查操作全部由http接口完成。由于Elasticsearch授权模块需要付费，所以免费开源的Elasticsearch可能存在未授权访问漏洞。该漏洞导致，攻击者可以拥有Elasticsearch的所有权限。可以对数据进行任意操作。业务系统将面临敏感数据泄露、数据丢失、数据遭到破坏甚至遭到攻击者的勒索。**Elasticsearch服务普遍存在一个未授权访问的问题，攻击者通常可以请求一个开放9200或9300的服务器端口进行恶意攻击。访问ES相关API，可直接读取敏感数据，甚至可以操作相关数据。**
API：
```http
http://localhost:9200/_plugin/head/ web管理界面 http://localhost:9200/_cat/indices http://localhost:9200/_river/_search 查看数据库敏感信息 http://localhost:9200/_nodes 查看节点数据
```

## 漏洞修复

1. 限制IP访问，禁止未授权IP访问ElasticSearch端口(默认9200)。
   ![[Pasted image 20230925173723.png]]

1. 针对elasticsearch2.x以后的版本可采用search-guard插件。同样在config/elasticsearch.yml中统一配置,在末尾追加以下内容，参考：[elasticsearch使用search-guard访问控制安全加固_search guard_奋斗鹿的博客-CSDN博客](https://blog.csdn.net/lu_wei_wei/article/details/100727090):
```yml
searchguard.ssl.transport.pemcert_filepath: certificates/esnode.pem
searchguard.ssl.transport.pemkey_filepath: certificates/esnode-key.pem
searchguard.ssl.transport.pemtrustedcas_filepath: certificates/root-ca.pem
searchguard.ssl.transport.enforce_hostname_verification: false
searchguard.ssl.http.enabled: true
searchguard.ssl.http.pemcert_filepath: certificates/esnode.pem
searchguard.ssl.http.pemkey_filepath: certificates/esnode-key.pem
searchguard.ssl.http.pemtrustedcas_filepath: certificates/root-ca.pem
searchguard.allow_unsafe_democertificates: true
searchguard.allow_default_init_sgindex: true
searchguard.authcz.admin_dn:
  - CN=kirk,OU=client,O=client,L=test,C=de
searchguard.enable_snapshot_restore_privilege: true
searchguard.check_snapshot_restore_write_privileges: true
searchguard.restapi.roles_enabled: ["sg_all_access"]
```

# 悖论对科学的发展和促进
## 相关链接
[祖父悖论 - 维基百科，自由的百科全书 (wikipedia.org)](https://zh.wikipedia.org/zh-cn/%E7%A5%96%E7%88%B6%E6%82%96%E8%AB%96)
## 祖父悖论的介绍1
源自[祖父悖论 - 维基百科，自由的百科全书 (wikipedia.org)](https://zh.wikipedia.org/zh-cn/%E7%A5%96%E7%88%B6%E6%82%96%E8%AB%96)
### 介绍
**祖父悖论**（又称**祖母悖论**）是一种[时间旅行](https://zh.wikipedia.org/wiki/%E6%97%B6%E9%97%B4%E6%97%85%E8%A1%8C "时间旅行")的[悖论](https://zh.wikipedia.org/wiki/%E6%82%96%E8%AE%BA "悖论")，[科幻](https://zh.wikipedia.org/wiki/%E7%A7%91%E5%B9%BB "科幻")故事中常见的主题。最先由法国科幻小说作家[赫内·巴赫札维勒](https://zh.wikipedia.org/wiki/%E8%B5%AB%E5%86%85%C2%B7%E5%B7%B4%E8%B5%AB%E6%9C%AD%E7%BB%B4%E5%8B%92 "赫内·巴赫札维勒")（René Barjavel）在他1943年的小说《[不小心的旅游者](https://zh.wikipedia.org/w/index.php?title=%E4%B8%8D%E5%B0%8F%E5%BF%83%E7%9A%84%E6%97%85%E6%B8%B8%E8%80%85&action=edit&redlink=1 "不小心的旅游者（页面不存在）")》（_Le Voyageur Imprudent_）中提出。情景如下：

> 假如你回到过去，在自己[父亲](https://zh.wikipedia.org/wiki/%E7%88%B6%E4%BA%B2 "父亲")出生前把自己的[祖父](https://zh.wikipedia.org/wiki/%E7%A5%96%E7%88%B6 "祖父")母杀死，但此举动会产生一矛盾的情况：
> 
> 你回到过去杀了你年轻的祖父，祖父死了就没有父亲，没有父亲也不会有你，那么是谁杀了祖父呢？ 或者看作：你的存在表示，祖父没有因你而死，那你何以杀死祖父？
> 
> 这就是祖父悖论。

### 物理中的祖父悖论
#### 平行宇宙
物理学家认为，也许世界是由无数个[平行宇宙](https://zh.wikipedia.org/wiki/%E5%B9%B3%E8%A1%8C%E5%AE%87%E5%AE%99 "平行宇宙")组成的，而当某人回到过去杀你的祖父母时，此人杀的其实是另一个宇宙的人（或者你的这个举动也可以创造一个新的平行宇宙），而此人的“祖父”或“祖母”的死只会使那个平行宇宙的此人不再存在，而这个平行宇宙的此人则平安无事。
- 在[量子物理](https://zh.wikipedia.org/wiki/%E9%87%8F%E5%AD%90%E7%89%A9%E7%90%86 "量子物理")中，“[多个世界](https://zh.wikipedia.org/wiki/%E5%A4%9A%E4%B8%96%E7%95%8C%E8%AF%A0%E9%87%8A "多世界诠释")（世界线理论）”理论可以如此理解：对于每一个似乎随机的事件来说，只要它的可能性不是零，它所有可能的情形都会在不同的平行世界中发生，造成历史的分支。物理学家[戴维·多伊奇](https://zh.wikipedia.org/wiki/%E6%88%B4%E7%BB%B4%C2%B7%E5%A4%9A%E4%BC%8A%E5%A5%87 "戴维·多伊奇")认为，当你回到过去去杀你的祖父母时，你其实进入了另一个世界，杀的是另一个世界的人。（那个世界与你的世界的差别仅在于你祖父母死了）
- [M理论](https://zh.wikipedia.org/wiki/M%E7%90%86%E8%AB%96 "M理论")，作为至今最有可能结合5种不同的[弦论](https://zh.wikipedia.org/wiki/%E5%BC%A6%E8%AB%96 "弦论")的理论，是如此解释平行宇宙的：多个三维的“[膜](https://zh.wikipedia.org/wiki/%E8%86%9C "膜")”可以同时在一个四维的宇宙（不是爱因斯坦的三维空间加一维时间；见[膜宇宙学](https://zh.wikipedia.org/wiki/%E8%86%9C%E5%AE%87%E5%AE%99%E5%AD%B8 "膜宇宙学")）中存在；这些[膜](https://zh.wikipedia.org/wiki/%E8%86%9C "膜")之间的撞击会在[膜](https://zh.wikipedia.org/wiki/%E8%86%9C "膜")中产生大量的能量——这也可以解释大爆炸是如何起源的。可是，M理论并不能解释不同[膜](https://zh.wikipedia.org/wiki/%E8%86%9C "膜")的历史之间的关系，也不能肯定，当你回到过去时，你会进到另一个[膜](https://zh.wikipedia.org/wiki/%E8%86%9C "膜")里面。
#### 时空修复（时空自清洁效应）
另一派的物理学家则认为，当你回到过去杀了你的祖父母之后，时空为了要自行修复这件事情所造成的问题，会让你自己和你的父母以一种合理的自然或意外事故死去，例如：地震、海啸、交通事故等。你的祖父母原本所造成的其他影响也会以合理的方式被抹除。
#### 时空虚拟论
承上，当你回到过去让你的父母不会相遇之后，如同在祖父悖论中所说的，在你回去前基点的你之后时间轴就不存在了，但是当你回到过去的时候，你就会在过去做出改变的当下，一直活着直到你的生命周期结束而再也无法传送回到未来与改变后的现在（因为时空基点理论），（过去的所有几率事件集合创造了现在，现在的所有几率集合创造了未来，但是未来却会被过去的残留集合几率所影响），而当你穿梭到了过去，改变了未来后，在你，（还没穿梭基点时间轴上的你与含有对你记忆的人现，则会彻底的遗忘你，就如同世界上没有你的诞生。但是就如同前题所说的时空基点所说的，假设你现在回到过去修改了历史，并被现在的人遗忘（因为你活在过去），但假设未修改与已修改的未来因为几率的关系，某件事重叠起来了话，将会有短暂时光或是长久时光，记忆会再次恢复。 时空基点一个核心，时间是由不可预测相对性几率，与双极数字所组成物，未来所发生的事请件率永远不会为0，但是将会因为你的改变而降低或是升高几率。

假设你今天买了一张保证赚的股票，但你能确定你的寿命活到那个时候吗？ 即使你修改了一件事，但是那件事是单一时空相对体几率，而时空则是群体相对几率的东西。
## 祖父悖论的介绍2
