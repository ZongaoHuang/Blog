# Elasticsearch漏洞防御与检测
## Elasticsearch介绍
[Elasticsearch](https://so.csdn.net/so/search?q=Elasticsearch&spm=1001.2101.3001.7020)是一个开源的高扩展的分布式全文检索引擎，它可以近乎实时的存储、检索数据；本身扩展性很好，可以扩展到上百台服务器，处理PB级别的数据。Elasticsearch也使用Java开发并使用Lucene作为其核心来实现所有索引和搜索的功能，但是它的目的是通过简单的RESTful API来隐藏Lucene的复杂性，从而让全文搜索变得简单。
当ElasticSearch的节点启动后，它会利用多播(multicast)(或者单播，如果用户更改了配置)寻找集群中的其它节点，并与之建立连接。这个过程如下图所示：![[Pasted image 20230925153506.png]]
## 漏洞描述
ES未授权访问：Elasticsearch的增删改查操作全部由http接口完成。由于Elasticsearch授权模块需要付费，所以免费开源的Elasticsearch可能存在未授权访问漏洞。该漏洞导致，攻击者可以拥有Elasticsearch的所有权限。可以对数据进行任意操作。业务系统将面临敏感数据泄露、数据丢失、数据遭到破坏甚至遭到攻击者的勒索。**Elasticsearch服务普遍存在一个未授权访问的问题，攻击者通常可以请求一个开放9200或9300的服务器进行恶意攻击。**
## 漏洞修复

1.限制IP访问，禁止未授权IP访问ElasticSearch端口(默认9200)。

2.通过ES插件形式来增加访问验证，需要注意增加验证后切勿使用弱口令:
针对elasticsearch2.x以后的版本可采用search-guard插件。
同样在config/elasticsearch.yml中统一配置,在末尾追加以下内容:
配置完成之后，默认访问口令为”username:admin,pwd:admin”,修改默认admin密码操作可参考[elasticsearch使用search-guard访问控制安全加固_search guard_奋斗鹿的博客-CSDN博客](https://blog.csdn.net/lu_wei_wei/article/details/100727090)
