# Daily Plan
- [ ] Acwing + LeetCode
- [ ] 
# Daily Study
# Daily Problem

源程序文档（要求：提供前连续40页和后连续40页共80页代码，每页不少于50行，如代码总量不足80页则全部提交；代码最后一页必须是程序的结尾或一个模块的结尾。）

  

---

暂时无法在飞书文档外展示此内容

# 1. 前端代码src
## 1.1 api
### 1.1.1 alarms.js
import service from '@/utils/request'

  

// @Tags Alarms

// @Summary 创建告警日志表

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body model.Alarms true "创建告警日志表"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"创建成功"}"

// @Router /alarms/createAlarms [post]

export const createAlarms = (data) => {

return service({

url: '/alarms/createAlarms',

method: 'post',

data

})

}

  

// @Tags Alarms

// @Summary 删除告警日志表

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body model.Alarms true "删除告警日志表"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"删除成功"}"

// @Router /alarms/deleteAlarms [delete]

export const deleteAlarms = (data) => {

return service({

url: '/alarms/deleteAlarms',

method: 'delete',

data

})

}

  

// @Tags Alarms

// @Summary 批量删除告警日志表

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body request.IdsReq true "批量删除告警日志表"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"删除成功"}"

// @Router /alarms/deleteAlarms [delete]

export const deleteAlarmsByIds = (data) => {

return service({

url: '/alarms/deleteAlarmsByIds',

method: 'delete',

data

})

}

  

// @Tags Alarms

// @Summary 更新告警日志表

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body model.Alarms true "更新告警日志表"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"更新成功"}"

// @Router /alarms/updateAlarms [put]

export const updateAlarms = (data) => {

return service({

url: '/alarms/updateAlarms',

method: 'put',

data

})

}

  

// @Tags Alarms

// @Summary 用id查询告警日志表

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data query model.Alarms true "用id查询告警日志表"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"查询成功"}"

// @Router /alarms/findAlarms [get]

export const findAlarms = (params) => {

return service({

url: '/alarms/findAlarms',

method: 'get',

params

})

}

  

// @Tags Alarms

// @Summary 分页获取告警日志表列表

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data query request.PageInfo true "分页获取告警日志表列表"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"获取成功"}"

// @Router /alarms/getAlarmsList [get]

export const getAlarmsList = (params) => {

return service({

url: '/alarms/getAlarmsList',

method: 'get',

params

})

}

### 1.1.2 alarmse.js

import service from '@/utils/request'

  

// @Tags Alarmsex

// @Summary 创建告警日志表扩展

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body model.Alarmsex true "创建告警日志表扩展"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"创建成功"}"

// @Router /alarmsex/createAlarmsex [post]

export const createAlarmsex = (data) => {

return service({

url: '/alarmsex/createAlarmsex',

method: 'post',

data

})

}

  

// @Tags Alarmsex

// @Summary 删除告警日志表扩展

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body model.Alarmsex true "删除告警日志表扩展"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"删除成功"}"

// @Router /alarmsex/deleteAlarmsex [delete]

export const deleteAlarmsex = (data) => {

return service({

url: '/alarmsex/deleteAlarmsex',

method: 'delete',

data

})

}

  

// @Tags Alarmsex

// @Summary 批量删除告警日志表扩展

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body request.IdsReq true "批量删除告警日志表扩展"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"删除成功"}"

// @Router /alarmsex/deleteAlarmsex [delete]

export const deleteAlarmsexByIds = (data) => {

return service({

url: '/alarmsex/deleteAlarmsexByIds',

method: 'delete',

data

})

}

  

// @Tags Alarmsex

// @Summary 更新告警日志表扩展

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body model.Alarmsex true "更新告警日志表扩展"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"更新成功"}"

// @Router /alarmsex/updateAlarmsex [put]

export const updateAlarmsex = (data) => {

return service({

url: '/alarmsex/updateAlarmsex',

method: 'put',

data

})

}

  

// @Tags Alarmsex

// @Summary 用id查询告警日志表扩展

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data query model.Alarmsex true "用id查询告警日志表扩展"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"查询成功"}"

// @Router /alarmsex/findAlarmsex [get]

export const findAlarmsex = (params) => {

return service({

url: '/alarmsex/findAlarmsex',

method: 'get',

params

})

}

  

// @Tags Alarmsex

// @Summary 分页获取告警日志表扩展列表

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data query request.PageInfo true "分页获取告警日志表扩展列表"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"获取成功"}"

// @Router /alarmsex/getAlarmsexList [get]

export const getAlarmsexList = (params) => {

return service({

url: '/alarmsex/getAlarmsexList',

method: 'get',

params

})

}

### 1.1.3 api.js

import service from '@/utils/request'

  

// @Tags api

// @Summary 分页获取角色列表

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body modelInterface.PageInfo true "分页获取用户列表"

// @Success 200 {string} json "{"success":true,"data":{},"msg":"获取成功"}"

// @Router /api/getApiList [post]

// {

// page int

// pageSize int

// }

export const getApiList = (data) => {

return service({

url: '/api/getApiList',

method: 'post',

data

})

}

  

// @Tags Api

// @Summary 创建基础api

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body api.CreateApiParams true "创建api"

// @Success 200 {string} json "{"success":true,"data":{},"msg":"获取成功"}"

// @Router /api/createApi [post]

export const createApi = (data) => {

return service({

url: '/api/createApi',

method: 'post',

data

})

}

  

// @Tags menu

// @Summary 根据id获取菜单

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body api.GetById true "根据id获取菜单"

// @Success 200 {string} json "{"success":true,"data":{},"msg":"获取成功"}"

// @Router /menu/getApiById [post]

export const getApiById = (data) => {

return service({

url: '/api/getApiById',

method: 'post',

data

})

}

  

// @Tags Api

// @Summary 更新api

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body api.CreateApiParams true "更新api"

// @Success 200 {string} json "{"success":true,"data":{},"msg":"更新成功"}"

// @Router /api/updateApi [post]

export const updateApi = (data) => {

return service({

url: '/api/updateApi',

method: 'post',

data

})

}

  

// @Tags Api

// @Summary 更新api

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body api.CreateApiParams true "更新api"

// @Success 200 {string} json "{"success":true,"data":{},"msg":"更新成功"}"

// @Router /api/setAuthApi [post]

export const setAuthApi = (data) => {

return service({

url: '/api/setAuthApi',

method: 'post',

data

})

}

  

// @Tags Api

// @Summary 获取所有的Api 不分页

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Success 200 {string} json "{"success":true,"data":{},"msg":"获取成功"}"

// @Router /api/getAllApis [post]

export const getAllApis = (data) => {

return service({

url: '/api/getAllApis',

method: 'post',

data

})

}

  

// @Tags Api

// @Summary 删除指定api

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body dbModel.Api true "删除api"

// @Success 200 {string} json "{"success":true,"data":{},"msg":"删除成功"}"

// @Router /api/deleteApi [post]

export const deleteApi = (data) => {

return service({

url: '/api/deleteApi',

method: 'post',

data

})

}

  

// @Tags SysApi

// @Summary 删除选中Api

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body request.IdsReq true "ID"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"删除成功"}"

// @Router /api/deleteApisByIds [delete]

export const deleteApisByIds = (data) => {

return service({

url: '/api/deleteApisByIds',

method: 'delete',

data

})

}

  

// FreshCasbin

// @Tags SysApi

// @Summary 刷新casbin缓存

// @accept application/json

// @Produce application/json

// @Success 200 {object} response.Response{msg=string} "刷新成功"

// @Router /api/freshCasbin [get]

export const freshCasbin = () => {

return service({

url: '/api/freshCasbin',

method: 'get'

})

}

### 1.1.4 authority.js

import service from '@/utils/request'

// @Router /authority/getAuthorityList [post]

export const getAuthorityList = (data) => {

return service({

url: '/authority/getAuthorityList',

method: 'post',

data

})

}

  

// @Summary 删除角色

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body {authorityId uint} true "删除角色"

// @Success 200 {string} json "{"success":true,"data":{},"msg":"获取成功"}"

// @Router /authority/deleteAuthority [post]

export const deleteAuthority = (data) => {

return service({

url: '/authority/deleteAuthority',

method: 'post',

data

})

}

  

// @Summary 创建角色

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body api.CreateAuthorityPatams true "创建角色"

// @Success 200 {string} json "{"success":true,"data":{},"msg":"获取成功"}"

// @Router /authority/createAuthority [post]

export const createAuthority = (data) => {

return service({

url: '/authority/createAuthority',

method: 'post',

data

})

}

  

// @Tags authority

// @Summary 拷贝角色

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body api.CreateAuthorityPatams true "拷贝角色"

// @Success 200 {string} json "{"success":true,"data":{},"msg":"拷贝成功"}"

// @Router /authority/copyAuthority [post]

export const copyAuthority = (data) => {

return service({

url: '/authority/copyAuthority',

method: 'post',

data

})

}

  

// @Summary 设置角色资源权限

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body sysModel.SysAuthority true "设置角色资源权限"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"设置成功"}"

// @Router /authority/setDataAuthority [post]

export const setDataAuthority = (data) => {

return service({

url: '/authority/setDataAuthority',

method: 'post',

data

})

}

  

// @Summary 修改角色

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body model.SysAuthority true "修改角色"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"设置成功"}"

// @Router /authority/setDataAuthority [post]

export const updateAuthority = (data) => {

return service({

url: '/authority/updateAuthority',

method: 'put',

data

})

}

### 1.1.5 authorityBtn.js

  

import service from '@/utils/request'

  

export const getAuthorityBtnApi = (data) => {

return service({

url: '/authorityBtn/getAuthorityBtn',

method: 'post',

data

})

}

  

export const setAuthorityBtnApi = (data) => {

return service({

url: '/authorityBtn/setAuthorityBtn',

method: 'post',

data

})

}

  

export const canRemoveAuthorityBtnApi = (params) => {

return service({

url: '/authorityBtn/canRemoveAuthorityBtn',

method: 'post',

params

})

}

  

### 1.1.6 autoCode.js

import service from '@/utils/request'

  

export const preview = (data) => {

return service({

url: '/autoCode/preview',

method: 'post',

data

})

}

  

export const createTemp = (data) => {

return service({

url: '/autoCode/createTemp',

method: 'post',

data,

responseType: 'blob'

})

}

  

// @Tags SysApi

// @Summary 获取当前所有数据库

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Success 200 {string} string "{"success":true,"data":{},"msg":"创建成功"}"

// @Router /autoCode/getDatabase [get]

export const getDB = (params) => {

return service({

url: '/autoCode/getDB',

method: 'get',

params

})

}

  

// @Tags SysApi

// @Summary 获取当前数据库所有表

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Success 200 {string} string "{"success":true,"data":{},"msg":"创建成功"}"

// @Router /autoCode/getTables [get]

export const getTable = (params) => {

return service({

url: '/autoCode/getTables',

method: 'get',

params

})

}

  

// @Tags SysApi

// @Summary 获取当前数据库所有表

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Success 200 {string} string "{"success":true,"data":{},"msg":"创建成功"}"

// @Router /autoCode/getColumn [get]

export const getColumn = (params) => {

return service({

url: '/autoCode/getColumn',

method: 'get',

params

})

}

  

export const getSysHistory = (data) => {

return service({

url: '/autoCode/getSysHistory',

method: 'post',

data

})

}

  

export const rollback = (data) => {

return service({

url: '/autoCode/rollback',

method: 'post',

data

})

}

  

export const getMeta = (data) => {

return service({

url: '/autoCode/getMeta',

method: 'post',

data

})

}

  

export const delSysHistory = (data) => {

return service({

url: '/autoCode/delSysHistory',

method: 'post',

data

})

}

  

export const createPackageApi = (data) => {

return service({

url: '/autoCode/createPackage',

method: 'post',

data

})

}

  

export const getPackageApi = () => {

return service({

url: '/autoCode/getPackage',

method: 'post'

})

}

  

export const deletePackageApi = (data) => {

return service({

url: '/autoCode/delPackage',

method: 'post',

data

})

}

  

export const createPlugApi = (data) => {

return service({

url: '/autoCode/createPlug',

method: 'post',

data

})

}

  

export const installPlug = (data) => {

return service({

url: '/autoCode/installPlug',

method: 'post',

data

})

}

  

export const pubPlug = (params) => {

return service({

url: '/autoCode/pubPlug',

method: 'post',

params

})

}

### 1.1.7 breakpoint.js

import service from '@/utils/request'

// @Summary 设置角色资源权限

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body sysModel.SysAuthority true "设置角色资源权限"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"设置成功"}"

// @Router /authority/setDataAuthority [post]

  

export const findFile = (params) => {

return service({

url: '/fileUploadAndDownload/findFile',

method: 'get',

params

})

}

  

export const breakpointContinue = (data) => {

return service({

url: '/fileUploadAndDownload/breakpointContinue',

method: 'post',

donNotShowLoading: true,

headers: { 'Content-Type': 'multipart/form-data' },

data

})

}

  

export const breakpointContinueFinish = (params) => {

return service({

url: '/fileUploadAndDownload/breakpointContinueFinish',

method: 'post',

params

})

}

  

export const removeChunk = (data, params) => {

return service({

url: '/fileUploadAndDownload/removeChunk',

method: 'post',

data,

params

})

}

### 1.1.8 casbin.js

import service from '@/utils/request'

// @Tags authority

// @Summary 更改角色api权限

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body api.CreateAuthorityPatams true "更改角色api权限"

// @Success 200 {string} json "{"success":true,"data":{},"msg":"获取成功"}"

// @Router /casbin/UpdateCasbin [post]

export const UpdateCasbin = (data) => {

return service({

url: '/casbin/updateCasbin',

method: 'post',

data

})

}

  

// @Tags casbin

// @Summary 获取权限列表

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body api.CreateAuthorityPatams true "获取权限列表"

// @Success 200 {string} json "{"success":true,"data":{},"msg":"获取成功"}"

// @Router /casbin/getPolicyPathByAuthorityId [post]

export const getPolicyPathByAuthorityId = (data) => {

return service({

url: '/casbin/getPolicyPathByAuthorityId',

method: 'post',

data

})

}

### 1.1.9 customer.js

import service from '@/utils/request'

// @Tags SysApi

// @Summary 删除客户

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body dbModel.ExaCustomer true "删除客户"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"获取成功"}"

// @Router /customer/customer [post]

export const createExaCustomer = (data) => {

return service({

url: '/customer/customer',

method: 'post',

data

})

}

  

// @Tags SysApi

// @Summary 更新客户信息

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body dbModel.ExaCustomer true "更新客户信息"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"获取成功"}"

// @Router /customer/customer [put]

export const updateExaCustomer = (data) => {

return service({

url: '/customer/customer',

method: 'put',

data

})

}

  

// @Tags SysApi

// @Summary 创建客户

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body dbModel.ExaCustomer true "创建客户"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"获取成功"}"

// @Router /customer/customer [delete]

export const deleteExaCustomer = (data) => {

return service({

url: '/customer/customer',

method: 'delete',

data

})

}

  

// @Tags SysApi

// @Summary 获取单一客户信息

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body dbModel.ExaCustomer true "获取单一客户信息"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"获取成功"}"

// @Router /customer/customer [get]

export const getExaCustomer = (params) => {

return service({

url: '/customer/customer',

method: 'get',

params

})

}

  

// @Tags SysApi

// @Summary 获取权限客户列表

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body modelInterface.PageInfo true "获取权限客户列表"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"获取成功"}"

// @Router /customer/customerList [get]

export const getExaCustomerList = (params) => {

return service({

url: '/customer/customerList',

method: 'get',

params

})

}

### 1.1.10 dashboard2.js

import request from '@/utils/request'

  

// export const getAttackData = (data) => {

// return service({

// url: '/dashboard2/attackData',

// method: 'get',

// data

// })

// }

  

export function getAttackData() {

return request({

url: '/dashboard2/attackData',

method: 'get'

})

}

  

export async function getTrendsData() {

const res = await request({

url: '/dashboard2/attackTrends',

method: 'get'

})

const option = {

title: {

text: ''

},

tooltip: {

trigger: 'axis',

axisPointer: {

type: 'cross',

label: {

backgroundColor: '#6a7985'

}

}

},

legend: {

data: ['告警日志', '记录日志']

},

grid: {

left: '3%',

right: '4%',

bottom: '3%',

containLabel: true

},

xAxis: [

{

type: 'category',

boundaryGap: false,

data: ['2022-02-01', '2022-02-02', '2022-02-03', '2022-02-04', '2022-02-05', '2022-02-06', '2022-02-07']

}

],

yAxis: [

{

type: 'value'

}

],

series: [

{

name: '告警日志',

type: 'line',

lineStyle: {

color: '#FF0000'

},

itemStyle: {

color: '#FF0000'

},

areaStyle: {

color: '#FF0000',

opacity: 0.3

},

data: [60, 132, 101, 134, 90, 230, 210]

},

{

name: '记录日志',

type: 'line',

lineStyle: {

color: '#FFCC00'

},

itemStyle: {

color: '#FFCC00'

},

areaStyle: {

color: '#FFCC00',

opacity: 0.3

},

data: [80, 182, 191, 234, 290, 330, 310]

}

]

}

option.xAxis[0].data = res.data.date

option.series[0].data = res.data.block

option.series[1].data = res.data.warn

return option

}

  

export async function getAttackTypeData() {

const res = await request({

url: '/dashboard2/attackTypes',

method: 'get'

})

const option = {

tooltip: {

trigger: 'item'

},

legend: {

top: '5%',

left: 'center'

},

series: [

{

name: '告警类型',

type: 'pie',

radius: ['40%', '70%'],

avoidLabelOverlap: false,

label: {

show: false,

position: 'center'

},

emphasis: {

label: {

show: true,

fontSize: 20,

fontWeight: 'bold'

}

},

labelLine: {

show: false

},

data: [

{ value: 1048, name: 'Search Engine' },

{ value: 735, name: 'Direct' },

{ value: 580, name: 'Email' },

{ value: 484, name: 'Union Ads' },

{ value: 300, name: 'Video Ads' }

]

}

]

}

option.series[0].data = res.data.list

return option

}

### 1.1.11 jwt.js

import service from '@/utils/request'

// @Tags jwt

// @Summary jwt加入黑名单

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Success 200 {string} string "{"success":true,"data":{},"msg":"拉黑成功"}"

// @Router /jwt/jsonInBlacklist [post]

export const jsonInBlacklist = () => {

return service({

url: '/jwt/jsonInBlacklist',

method: 'post'

})

}

### 1.1.12 menu.js

import service from '@/utils/request'

// @Summary 用户登录 获取动态路由

// @Produce application/json

// @Param 可以什么都不填 调一下即可

// @Router /menu/getMenu [post]

export const asyncMenu = () => {

return service({

url: '/menu/getMenu',

method: 'post'

})

}

  

// @Summary 获取menu列表

// @Produce application/json

// @Param {

// page int

// pageSize int

// }

// @Router /menu/getMenuList [post]

export const getMenuList = (data) => {

return service({

url: '/menu/getMenuList',

method: 'post',

data

})

}

  

// @Summary 新增基础menu

// @Produce application/json

// @Param menu Object

// @Router /menu/getMenuList [post]

export const addBaseMenu = (data) => {

return service({

url: '/menu/addBaseMenu',

method: 'post',

data

})

}

  

// @Summary 获取基础路由列表

// @Produce application/json

// @Param 可以什么都不填 调一下即可

// @Router /menu/getBaseMenuTree [post]

export const getBaseMenuTree = () => {

return service({

url: '/menu/getBaseMenuTree',

method: 'post'

})

}

  

// @Summary 添加用户menu关联关系

// @Produce application/json

// @Param menus Object authorityId string

// @Router /menu/getMenuList [post]

export const addMenuAuthority = (data) => {

return service({

url: '/menu/addMenuAuthority',

method: 'post',

data

})

}

  

// @Summary 获取用户menu关联关系

// @Produce application/json

// @Param authorityId string

// @Router /menu/getMenuAuthority [post]

export const getMenuAuthority = (data) => {

return service({

url: '/menu/getMenuAuthority',

method: 'post',

data

})

}

  

// @Summary 删除menu

// @Produce application/json

// @Param ID float64

// @Router /menu/deleteBaseMenu [post]

export const deleteBaseMenu = (data) => {

return service({

url: '/menu/deleteBaseMenu',

method: 'post',

data

})

}

  

// @Summary 修改menu列表

// @Produce application/json

// @Param menu Object

// @Router /menu/updateBaseMenu [post]

export const updateBaseMenu = (data) => {

return service({

url: '/menu/updateBaseMenu',

method: 'post',

data

})

}

  

// @Tags menu

// @Summary 根据id获取菜单

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body api.GetById true "根据id获取菜单"

// @Success 200 {string} json "{"success":true,"data":{},"msg":"获取成功"}"

// @Router /menu/getBaseMenuById [post]

export const getBaseMenuById = (data) => {

return service({

url: '/menu/getBaseMenuById',

method: 'post',

data

})

}

  

### 1.1.13 initdb.js

import service from '@/utils/request'

// @Tags InitDB

// @Summary 初始化用户数据库

// @Produce application/json

// @Param data body request.InitDB true "初始化数据库参数"

// @Success 200 {string} string "{"code":0,"data":{},"msg":"自动创建数据库成功"}"

// @Router /init/initdb [post]

export const initDB = (data) => {

return service({

url: '/init/initdb',

method: 'post',

data

})

}

  

// @Tags CheckDB

// @Summary 初始化用户数据库

// @Produce application/json

// @Success 200 {string} string "{"code":0,"data":{},"msg":"探测完成"}"

// @Router /init/checkdb [post]

export const checkDB = () => {

return service({

url: '/init/checkdb',

method: 'post'

})

}

### 1.1.14 rules.js

import service from '@/utils/request'

  

// @Tags Rule

// @Summary 创建告警规则

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body model.Rule true "创建告警规则"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"创建成功"}"

// @Router /rule/createRule [post]

export const createRule = (data) => {

return service({

url: '/rule/createRule',

method: 'post',

data

})

}

  

// @Tags Rule

// @Summary 删除告警规则

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body model.Rule true "删除告警规则"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"删除成功"}"

// @Router /rule/deleteRule [delete]

export const deleteRule = (data) => {

return service({

url: '/rule/deleteRule',

method: 'delete',

data

})

}

  

// @Tags Rule

// @Summary 批量删除告警规则

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body request.IdsReq true "批量删除告警规则"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"删除成功"}"

// @Router /rule/deleteRule [delete]

export const deleteRuleByIds = (data) => {

return service({

url: '/rule/deleteRuleByIds',

method: 'delete',

data

})

}

  

// @Tags Rule

// @Summary 更新告警规则

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body model.Rule true "更新告警规则"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"更新成功"}"

// @Router /rule/updateRule [put]

export const updateRule = (data) => {

return service({

url: '/rule/updateRule',

method: 'put',

data

})

}

  

// @Tags Rule

// @Summary 用id查询告警规则

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data query model.Rule true "用id查询告警规则"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"查询成功"}"

// @Router /rule/findRule [get]

export const findRule = (params) => {

return service({

url: '/rule/findRule',

method: 'get',

params

})

}

  

// @Tags Rule

// @Summary 分页获取告警规则列表

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data query request.PageInfo true "分页获取告警规则列表"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"获取成功"}"

// @Router /rule/getRuleList [get]

export const getRuleList = (params) => {

return service({

url: '/rule/getRuleList',

method: 'get',

params

})

}

### 1.1.15 sysDictionary.js

import service from '@/utils/request'

// @Tags SysDictionary

// @Summary 创建SysDictionary

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body model.SysDictionary true "创建SysDictionary"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"获取成功"}"

// @Router /sysDictionary/createSysDictionary [post]

export const createSysDictionary = (data) => {

return service({

url: '/sysDictionary/createSysDictionary',

method: 'post',

data

})

}

  

// @Tags SysDictionary

// @Summary 删除SysDictionary

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body model.SysDictionary true "删除SysDictionary"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"删除成功"}"

// @Router /sysDictionary/deleteSysDictionary [delete]

export const deleteSysDictionary = (data) => {

return service({

url: '/sysDictionary/deleteSysDictionary',

method: 'delete',

data

})

}

  

// @Tags SysDictionary

// @Summary 更新SysDictionary

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body model.SysDictionary true "更新SysDictionary"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"更新成功"}"

// @Router /sysDictionary/updateSysDictionary [put]

export const updateSysDictionary = (data) => {

return service({

url: '/sysDictionary/updateSysDictionary',

method: 'put',

data

})

}

  

// @Tags SysDictionary

// @Summary 用id查询SysDictionary

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body model.SysDictionary true "用id查询SysDictionary"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"查询成功"}"

// @Router /sysDictionary/findSysDictionary [get]

export const findSysDictionary = (params) => {

return service({

url: '/sysDictionary/findSysDictionary',

method: 'get',

params

})

}

  

// @Tags SysDictionary

// @Summary 分页获取SysDictionary列表

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body request.PageInfo true "分页获取SysDictionary列表"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"获取成功"}"

// @Router /sysDictionary/getSysDictionaryList [get]

export const getSysDictionaryList = (params) => {

return service({

url: '/sysDictionary/getSysDictionaryList',

method: 'get',

params

})

}

### 1.1.16 sysOperationRecord.js

import service from '@/utils/request'

// @Tags SysOperationRecord

// @Summary 删除SysOperationRecord

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body model.SysOperationRecord true "删除SysOperationRecord"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"删除成功"}"

// @Router /sysOperationRecord/deleteSysOperationRecord [delete]

export const deleteSysOperationRecord = (data) => {

return service({

url: '/sysOperationRecord/deleteSysOperationRecord',

method: 'delete',

data

})

}

  

// @Tags SysOperationRecord

// @Summary 删除SysOperationRecord

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body request.IdsReq true "删除SysOperationRecord"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"删除成功"}"

// @Router /sysOperationRecord/deleteSysOperationRecord [delete]

export const deleteSysOperationRecordByIds = (data) => {

return service({

url: '/sysOperationRecord/deleteSysOperationRecordByIds',

method: 'delete',

data

})

}

  

// @Tags SysOperationRecord

// @Summary 分页获取SysOperationRecord列表

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body request.PageInfo true "分页获取SysOperationRecord列表"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"获取成功"}"

// @Router /sysOperationRecord/getSysOperationRecordList [get]

export const getSysOperationRecordList = (params) => {

return service({

url: '/sysOperationRecord/getSysOperationRecordList',

method: 'get',

params

})

}

### 1.1.17 system.js

import service from '@/utils/request'

// @Tags systrm

// @Summary 获取配置文件内容

// @Security ApiKeyAuth

// @Produce application/json

// @Success 200 {string} string "{"success":true,"data":{},"msg":"返回成功"}"

// @Router /system/getSystemConfig [post]

export const getSystemConfig = () => {

return service({

url: '/system/getSystemConfig',

method: 'post'

})

}

  

// @Tags system

// @Summary 设置配置文件内容

// @Security ApiKeyAuth

// @Produce application/json

// @Param data body sysModel.System true

// @Success 200 {string} string "{"success":true,"data":{},"msg":"返回成功"}"

// @Router /system/setSystemConfig [post]

export const setSystemConfig = (data) => {

return service({

url: '/system/setSystemConfig',

method: 'post',

data

})

}

  

// @Tags system

// @Summary 获取服务器运行状态

// @Security ApiKeyAuth

// @Produce application/json

// @Success 200 {string} string "{"success":true,"data":{},"msg":"返回成功"}"

// @Router /system/getServerInfo [post]

export const getSystemState = () => {

return service({

url: '/system/getServerInfo',

method: 'post',

donNotShowLoading: true

})

}

### 1.1.18 user.js

import service from '@/utils/request'

// @Summary 用户登录

// @Produce application/json

// @Param data body {username:"string",password:"string"}

// @Router /base/login [post]

export const login = (data) => {

return service({

url: '/base/login',

method: 'post',

data: data

})

}

  

// @Summary 获取验证码

// @Produce application/json

// @Param data body {username:"string",password:"string"}

// @Router /base/captcha [post]

export const captcha = (data) => {

return service({

url: '/base/captcha',

method: 'post',

data: data

})

}

  

// @Summary 用户注册

// @Produce application/json

// @Param data body {username:"string",password:"string"}

// @Router /base/resige [post]

export const register = (data) => {

return service({

url: '/user/admin_register',

method: 'post',

data: data

})

}

  

// @Summary 修改密码

// @Produce application/json

// @Param data body {username:"string",password:"string",newPassword:"string"}

// @Router /user/changePassword [post]

export const changePassword = (data) => {

return service({

url: '/user/changePassword',

method: 'post',

data: data

})

}

  

// @Tags User

// @Summary 分页获取用户列表

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body modelInterface.PageInfo true "分页获取用户列表"

// @Success 200 {string} json "{"success":true,"data":{},"msg":"获取成功"}"

// @Router /user/getUserList [post]

export const getUserList = (data) => {

return service({

url: '/user/getUserList',

method: 'post',

data: data

})

}

  

// @Tags User

// @Summary 设置用户权限

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body api.SetUserAuth true "设置用户权限"

// @Success 200 {string} json "{"success":true,"data":{},"msg":"修改成功"}"

// @Router /user/setUserAuthority [post]

export const setUserAuthority = (data) => {

return service({

url: '/user/setUserAuthority',

method: 'post',

data: data

})

}

  

// @Tags SysUser

// @Summary 删除用户

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body request.SetUserAuth true "删除用户"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"修改成功"}"

// @Router /user/deleteUser [delete]

export const deleteUser = (data) => {

return service({

url: '/user/deleteUser',

method: 'delete',

data: data

})

}

  

// @Tags SysUser

// @Summary 设置用户信息

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body model.SysUser true "设置用户信息"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"修改成功"}"

// @Router /user/setUserInfo [put]

export const setUserInfo = (data) => {

return service({

url: '/user/setUserInfo',

method: 'put',

data: data

})

}

  

// @Tags SysUser

// @Summary 设置用户信息

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body model.SysUser true "设置用户信息"

// @Success 200 {string} string "{"success":true,"data":{},"msg":"修改成功"}"

// @Router /user/setSelfInfo [put]

export const setSelfInfo = (data) => {

return service({

url: '/user/setSelfInfo',

method: 'put',

data: data

})

}

  

// @Tags User

// @Summary 设置用户权限

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Param data body api.setUserAuthorities true "设置用户权限"

// @Success 200 {string} json "{"success":true,"data":{},"msg":"修改成功"}"

// @Router /user/setUserAuthorities [post]

export const setUserAuthorities = (data) => {

return service({

url: '/user/setUserAuthorities',

method: 'post',

data: data

})

}

  

// @Tags User

// @Summary 获取用户信息

// @Security ApiKeyAuth

// @accept application/json

// @Produce application/json

// @Success 200 {string} json "{"success":true,"data":{},"msg":"获取成功"}"

// @Router /user/getUserInfo [get]

export const getUserInfo = () => {

return service({

url: '/user/getUserInfo',

method: 'get'

})

}

  

export const resetPassword = (data) => {

return service({

url: '/user/resetPassword',

method: 'post',

data: data

})

}

## 1.2 components

### 1.2.1 chooseImg.vue

<template>

<el-drawer

v-model="drawer"

title="媒体库"

size="650px"

>   

<warning-bar

title="点击“文件名/备注”可以编辑文件名或者备注内容。"

/>

<div class="gva-btn-list">

<upload-common

v-model:imageCommon="imageCommon"

class="upload-btn-media-library"

@on-success="open"

/>

<upload-image

v-model:imageUrl="imageUrl"

:file-size="512"

:max-w-h="1080"

class="upload-btn-media-library"

@on-success="open"

/>

<el-form

ref="searchForm"

:inline="true"

:model="search"

>

<el-form-item label="">

<el-input

v-model="search.keyword"

class="keyword"

placeholder="请输入文件名或备注"

/>

</el-form-item>

  

<el-form-item>

<el-button

type="primary"

icon="search"

@click="open"

>查询</el-button>

</el-form-item>

</el-form>

</div>

<div class="media">

<div

v-for="(item,key) in picList"

:key="key"

class="media-box"

>

<div class="header-img-box-list">

<el-image

:key="key"

:src="getUrl(item.url)"

@click="chooseImg(item.url,target,targetKey)"

>

<template #error>

<div class="header-img-box-list">

<el-icon>

<picture />

</el-icon>

</div>

</template>

</el-image>

</div>

<div

class="img-title"

@click="editFileNameFunc(item)"

>{{ item.name }}</div>

</div>

</div>

<el-pagination

:current-page="page"

:page-size="pageSize"

:total="total"

:style="{'justify-content':'center'}"

layout="total, prev, pager, next, jumper"

@current-change="handleCurrentChange"

@size-change="handleSizeChange"

/>

</el-drawer>

</template>

  

<script setup>

import { getUrl } from '@/utils/image'

import { ref } from 'vue'

import { getFileList, editFileName } from '@/api/fileUploadAndDownload'

import UploadImage from '@/components/upload/image.vue'

import UploadCommon from '@/components/upload/common.vue'

import { ElMessage, ElMessageBox } from 'element-plus'

import WarningBar from '@/components/warningBar/warningBar.vue'

  

const imageUrl = ref('')

const imageCommon = ref('')

  

const search = ref({})

const page = ref(1)

const total = ref(0)

const pageSize = ref(20)

  

// 分页

const handleSizeChange = (val) => {

pageSize.value = val

open()

}

  

const handleCurrentChange = (val) => {

page.value = val

open()

}

  

const emit = defineEmits(['enterImg'])

defineProps({

target: {

type: Object,

default: null,

},

targetKey: {

type: String,

default: '',

},

})

  

const drawer = ref(false)

const picList = ref([])

  

const chooseImg = (url, target, targetKey) => {

if (target && targetKey) {

target[targetKey] = url

}

emit('enterImg', url)

drawer.value = false

}

  

const open = async() => {

const res = await getFileList({ page: page.value, pageSize: pageSize.value, ...search.value })

if (res.code === 0) {

picList.value = res.data.list

total.value = res.data.total

page.value = res.data.page

pageSize.value = res.data.pageSize

drawer.value = true

}

}

  

/**

- 编辑文件名或者备注
    
- @param row
    
- @returns {Promise<void>}
    

*/

const editFileNameFunc = async(row) => {

ElMessageBox.prompt('请输入文件名或者备注', '编辑', {

confirmButtonText: '确定',

cancelButtonText: '取消',

inputPattern: /\S/,

inputErrorMessage: '不能为空',

inputValue: row.name

}).then(async({ value }) => {

row.name = value

// console.log(row)

const res = await editFileName(row)

if (res.code === 0) {

ElMessage({

type: 'success',

message: '编辑成功!',

})

open()

}

}).catch(() => {

ElMessage({

type: 'info',

message: '取消修改'

})

})

}

  

defineExpose({ open })

</script>

  

<style lang="scss">

.upload-btn-media-library {

margin-left: 20px;

}

  

.media {

display: flex;

flex-wrap: wrap;

  

.media-box {

width: 120px;

margin-left: 20px;

  

.img-title {

white-space: nowrap;

overflow: hidden;

text-overflow: ellipsis;

line-height: 36px;

text-align: center;

cursor: pointer;

}

  

.header-img-box-list {

width: 120px;

height: 120px;

border: 1px dashed #ccc;

border-radius: 8px;

text-align: center;

line-height: 120px;

cursor: pointer;

overflow: hidden;

.el-image__inner {

max-width: 120px;

max-height: 120px;

vertical-align: middle;

width: unset;

height: unset;

}

}

}

}

  

</style>

### 1.2.2 commandMenu.vue

<template>

<el-dialog

v-model="dialogVisible"

width="30%"

class="overlay"

:show-close="false"

>   

<template #header>

<input

v-model="searchInput"

class="quick-input"

placeholder="请输入你需要快捷到达的功能"

>

</template>

  

<div

v-for="(option,index) in options"

:key="index"

>

<div

v-if="option.children.length"

class="quick-title"

>{{ option.label }}</div>

<div

v-for="(item,key) in option.children"

:key="index+'-'+key"

class="quick-item"

@click="item.func"

>

{{ item.label }}

</div>

</div>

  

<template #footer>

<span class="dialog-footer">

<el-button @click="close">关闭</el-button>

</span>

</template>

</el-dialog>

</template>

  

<script setup>

import { reactive, ref, watch } from 'vue'

import { useRouter, useRoute } from 'vue-router'

import { useRouterStore } from '@/pinia/modules/router'

import { useUserStore } from '@/pinia/modules/user'

  

defineOptions({

name: 'CommandMenu',

})

  

const router = useRouter()

const route = useRouter()

const userStore = useUserStore()

const routerStore = useRouterStore()

const dialogVisible = ref(false)

const searchInput = ref('')

const options = reactive([])

const deepMenus = (menus) => {

const arr = []

menus.forEach(menu => {

if (menu.children && menu.children.length > 0) {

arr.push(...deepMenus(menu.children))

} else {

if (menu.meta.title && menu.meta.title.indexOf(searchInput.value) > -1) {

arr.push({

label: menu.meta.title,

func: () => changeRouter(menu)

})

}

}

})

return arr

}

  

const addQuickMenu = () => {

const option = {

label: '跳转',

children: []

}

const menus = deepMenus(routerStore.asyncRouters[0].children)

option.children.push(...menus)

options.push(option)

}

  

const addQuickOption = () => {

const option = {

label: '操作',

children: []

}

const quickArr = [

{

label: '亮色主题',

func: () => changeMode('light')

}, {

label: '暗色主题',

func: () => changeMode('dark')

}, {

label: '退出登录',

func: () => userStore.LoginOut()

}

]

option.children.push(...quickArr.filter(item => item.label.indexOf(searchInput.value) > -1))

options.push(option)

}

  

addQuickMenu()

addQuickOption()

  

const open = () => {

dialogVisible.value = true

}

  

const changeRouter = (e) => {

const index = e.name

const query = {}

const params = {}

routerStore.routeMap[index]?.parameters &&

routerStore.routeMap[index]?.parameters.forEach((item) => {

if (item.type === 'query') {

query[item.key] = item.value

} else {

params[item.key] = item.value

}

})

if (index === route.name) return

if (e.name.indexOf('http://') > -1 || e.name.indexOf('https://') > -1) {

window.open(e.name)

} else {

router.push({ name: index, query, params })

}

dialogVisible.value = false

}

  

const changeMode = (e) => {

if (e === null) {

userStore.changeSideMode('dark')

return

}

userStore.changeSideMode(e)

}

  

const close = () => {

dialogVisible.value = false

}

  

defineExpose({ open })

  

watch(searchInput, () => {

options.length = 0

addQuickMenu()

addQuickOption()

})

</script>

  

<style lang="scss">

.overlay {

border-radius: 4px;

.el-dialog__header{

padding:0 !important;

margin-right:0 !important;

}

.el-dialog__body{

padding: 12px !important;

height: 50vh;

overflow: auto !important;

}

.quick-title{

margin-top: 8px;

font-size: 12px;

font-weight: 600;

color: #666;

}

.quick-input{

color: #666;

border-radius: 4px 4px 0 0;

border:none;

padding: 12px 16px;

box-sizing: border-box;

width: 100%;

font-size: 16px;

border-bottom: 1px solid #ddd;

}

.quick-item{

font-size: 14px;

padding: 8px;

margin: 4px 0;

&:hover{

cursor: pointer;

background: #eee;

border-radius: 4px;

}

}

}

  

</style>

### 1.2.3 customPic.vue

<template>

<span class="headerAvatar">

<template v-if="picType === 'avatar'">

<el-avatar

v-if="userStore.userInfo.headerImg"

:size="30"

:src="avatar"

/>

<el-avatar

v-else

:size="30"

:src="noAvatar"

/>

</template>

<template v-if="picType === 'img'">

<img

v-if="userStore.userInfo.headerImg"

:src="avatar"

class="avatar"

>

<img

v-else

:src="noAvatar"

class="avatar"

>

</template>

<template v-if="picType === 'file'">

<el-image

:src="file"

class="file"

:preview-src-list="previewSrcList"

:preview-teleported="true"

/>

</template>

</span>

</template>

  

<script setup>

import noAvatarPng from '@/assets/noBody.png'

import { useUserStore } from '@/pinia/modules/user'

import { computed, ref } from 'vue'

  

defineOptions({

name: 'CustomPic'

})

  

const props = defineProps({

picType: {

type: String,

required: false,

default: 'avatar'

},

picSrc: {

type: String,

required: false,

default: ''

},

preview: {

type: Boolean,

default: false

}

})

  

const path = ref(import.meta.env.VITE_BASE_API + '/')

const noAvatar = ref(noAvatarPng)

  

const userStore = useUserStore()

  

const avatar = computed(() => {

if (props.picSrc === '') {

if (userStore.userInfo.headerImg !== '' && userStore.userInfo.headerImg.slice(0, 4) === 'http') {

return userStore.userInfo.headerImg

}

return path.value + userStore.userInfo.headerImg

} else {

if (props.picSrc !== '' && props.picSrc.slice(0, 4) === 'http') {

return props.picSrc

}

return path.value + props.picSrc

}

})

const file = computed(() => {

if (props.picSrc && props.picSrc.slice(0, 4) !== 'http') {

return path.value + props.picSrc

}

return props.picSrc

})

const previewSrcList = computed(() => props.preview ? [file.value] : [])

  

</script>

  

<style scoped>

.headerAvatar{

display: flex;

justify-content: center;

align-items: center;

margin-right: 8px;

}

.file{

width: 80px;

height: 80px;

position: relative;

}

</style>

### 1.2.4 selectFile.vue

<template>

<div>

<el-upload

multiple

:action="`${path}/fileUploadAndDownload/upload?noSave=1`"

:headers="{ 'x-token': userStore.token }"

:on-error="uploadError"

:on-success="uploadSuccess"

:show-file-list="true"

:file-list="fileList"

:limit="limit"

:accept="accept"

class="upload-btn"

>

<el-button type="primary">上传文件</el-button>

</el-upload>

</div>

</template>

  

<script setup>

  

import { ref, watch } from 'vue'

import { ElMessage } from 'element-plus'

import { useUserStore } from '@/pinia/modules/user'

  

defineOptions({

name: 'UploadCommon',

})

  

const props = defineProps({

modelValue: {

type: Array,

default: () => []

},

limit: {

type: Number,

default: 3

},

accept: {

type: String,

default: ''

},

})

  

const path = ref(import.meta.env.VITE_BASE_API)

  

const userStore = useUserStore()

const fullscreenLoading = ref(false)

  

const fileList = ref(props.modelValue)

  

const emits = defineEmits(['update:modelValue'])

  

watch(fileList.value, (val) => {

console.log(val)

emits('update:modelValue', val)

})

  

watch(

() => props.modelValue,

value => {

fileList.value = value

},

{ immediate: true }

)

const uploadSuccess = (res) => {

const { data } = res

if (data.file) {

fileList.value.push({

name: data.file.name,

url: data.file.url

})

fullscreenLoading.value = false

}

}

  

const uploadError = () => {

ElMessage({

type: 'error',

message: '上传失败'

})

fullscreenLoading.value = false

}

  

</script>

### 1.2.5 warningBar.vue

<template>

<div

class="px-1.5 py-2 flex items-center bg-amber-50 rounded gap-2 mb-3 text-amber-500"

:class="href&&'cursor-pointer'"

@click="open"

>   

<el-icon class="text-xl">

<warning-filled />

</el-icon>

<span>

{{ title }}

</span>

</div>

</template>

<script setup>

import { WarningFilled } from '@element-plus/icons-vue'

const prop = defineProps({

title: {

type: String,

default: ''

},

href: {

type: String,

default: ''

}

})

  

const open = () => {

if (prop.href) {

window.open(prop.href)

}

}

</script>

## 1.3 core

### 1.3.1 config.js

/**

- 网站配置文件
    

*/

  

const config = {

}

  

export const viteLogo = (env) => {

if (config.showViteLogo) {

console.log('启动成功\n')

}

}

  

export default config

### 1.3.2 global.js

import config from './config'

  

// 统一导入el-icon图标

import * as ElIconModules from '@element-plus/icons-vue'

// 导入转换图标名称的函数

  

export const register = (app) => {

// 统一注册el-icon图标

for (const iconName in ElIconModules) {

app.component(iconName, ElIconModules[iconName])

}

app.config.globalProperties.$GIN_VUE_ADMIN = config

}

## 1.4 directive/auth.js

// 权限按钮展示指令

import { useUserStore } from '@/pinia/modules/user'

export default {

install: (app) => {

const userStore = useUserStore()

app.directive('auth', {

// 当被绑定的元素插入到 DOM 中时……

mounted: function(el, binding) {

const userInfo = userStore.userInfo

let type = ''

switch (Object.prototype.toString.call(binding.value)) {

case '[object Array]':

type = 'Array'

break

case '[object String]':

type = 'String'

break

case '[object Number]':

type = 'Number'

break

default:

type = ''

break

}

if (type === '') {

el.parentNode.removeChild(el)

return

}

const waitUse = binding.value.toString().split(',')

let flag = waitUse.some(item => Number(item) === userInfo.authorityId)

if (binding.modifiers.not) {

flag = !flag

}

if (!flag) {

el.parentNode.removeChild(el)

}

}

})

}

}

## 1.5 pinia

### 1.5.1 dictionary.js

import { findSysDictionary } from '@/api/sysDictionary'

  

import { defineStore } from 'pinia'

import { ref } from 'vue'

  

export const useDictionaryStore = defineStore('dictionary', () => {

const dictionaryMap = ref({})

  

const setDictionaryMap = (dictionaryRes) => {

dictionaryMap.value = { ...dictionaryMap.value, ...dictionaryRes }

}

  

const getDictionary = async(type) => {

if (dictionaryMap.value[type] && dictionaryMap.value[type].length) {

return dictionaryMap.value[type]

} else {

const res = await findSysDictionary({ type })

if (res.code === 0) {

const dictionaryRes = {}

const dict = []

res.data.resysDictionary.sysDictionaryDetails && res.data.resysDictionary.sysDictionaryDetails.forEach(item => {

dict.push({

label: item.label,

value: item.value

})

})

dictionaryRes[res.data.resysDictionary.type] = dict

setDictionaryMap(dictionaryRes)

return dictionaryMap.value[type]

}

}

}

  

return {

dictionaryMap,

setDictionaryMap,

getDictionary

}

})

### 1.5.2 router.js

import { asyncRouterHandle } from '@/utils/asyncRouter'

import { emitter } from '@/utils/bus.js'

import { asyncMenu } from '@/api/menu'

import { defineStore } from 'pinia'

import { ref } from 'vue'

  

const notLayoutRouterArr = []

const keepAliveRoutersArr = []

const nameMap = {}

  

const formatRouter = (routes, routeMap, parent) => {

routes && routes.forEach(item => {

item.parent = parent

item.meta.btns = item.btns

item.meta.hidden = item.hidden

if (item.meta.defaultMenu === true) {

if (!parent) {

item = { ...item, path: `/${item.path}` }

notLayoutRouterArr.push(item)

}

}

routeMap[item.name] = item

if (item.children && item.children.length > 0) {

formatRouter(item.children, routeMap, item)

}

})

}

  

const KeepAliveFilter = (routes) => {

routes && routes.forEach(item => {

// 子菜单中有 keep-alive 的，父菜单也必须 keep-alive，否则无效。这里将子菜单中有 keep-alive 的父菜单也加入。

if ((item.children && item.children.some(ch => ch.meta.keepAlive) || item.meta.keepAlive)) {

item.component && item.component().then(val => {

keepAliveRoutersArr.push(val.default.name)

nameMap[item.name] = val.default.name

})

}

if (item.children && item.children.length > 0) {

KeepAliveFilter(item.children)

}

})

}

  

export const useRouterStore = defineStore('router', () => {

const keepAliveRouters = ref([])

const asyncRouterFlag = ref(0)

const setKeepAliveRouters = (history) => {

const keepArrTemp = []

history.forEach(item => {

if (nameMap[item.name]) {

keepArrTemp.push(nameMap[item.name])

}

})

keepAliveRouters.value = Array.from(new Set(keepArrTemp))

}

emitter.on('setKeepAlive', setKeepAliveRouters)

  

const asyncRouters = ref([])

const routeMap = ({})

// 从后台获取动态路由

const SetAsyncRouter = async() => {

asyncRouterFlag.value++

const baseRouter = [{

path: '/layout',

name: 'layout',

component: 'view/layout/index.vue',

meta: {

title: '底层layout'

},

children: []

}]

const asyncRouterRes = await asyncMenu()

const asyncRouter = asyncRouterRes.data.menus

asyncRouter && asyncRouter.push({

path: 'reload',

name: 'Reload',

hidden: true,

meta: {

title: '',

closeTab: true,

},

component: 'view/error/reload.vue'

})

formatRouter(asyncRouter, routeMap)

baseRouter[0].children = asyncRouter

if (notLayoutRouterArr.length !== 0) {

baseRouter.push(...notLayoutRouterArr)

}

asyncRouterHandle(baseRouter)

KeepAliveFilter(asyncRouter)

asyncRouters.value = baseRouter

return true

}

  

return {

asyncRouters,

keepAliveRouters,

asyncRouterFlag,

SetAsyncRouter,

routeMap

}

})

### 1.5.3 user.js

import { login, getUserInfo, setSelfInfo } from '@/api/user'

import { jsonInBlacklist } from '@/api/jwt'

import router from '@/router/index'

import { ElLoading, ElMessage } from 'element-plus'

import { defineStore } from 'pinia'

import { ref, computed, watch } from 'vue'

import { useRouterStore } from './router'

  

export const useUserStore = defineStore('user', () => {

const loadingInstance = ref(null)

  

const userInfo = ref({

uuid: '',

nickName: '',

headerImg: '',

authority: {},

sideMode: 'dark',

activeColor: 'var(--el-color-primary)',

baseColor: '#fff'

})

const token = ref(window.localStorage.getItem('token') || '')

const setUserInfo = (val) => {

userInfo.value = val

}

  

const setToken = (val) => {

token.value = val

}

  

const NeedInit = () => {

token.value = ''

window.localStorage.removeItem('token')

localStorage.clear()

router.push({ name: 'Init', replace: true })

}

  

const ResetUserInfo = (value = {}) => {

userInfo.value = {

...userInfo.value,

...value

}

}

/* 获取用户信息*/

const GetUserInfo = async() => {

const res = await getUserInfo()

if (res.code === 0) {

setUserInfo(res.data.userInfo)

}

return res

}

/* 登录*/

const LoginIn = async(loginInfo) => {

loadingInstance.value = ElLoading.service({

fullscreen: true,

text: '登录中，请稍候...',

})

try {

const res = await login(loginInfo)

if (res.code === 0) {

setUserInfo(res.data.user)

setToken(res.data.token)

const routerStore = useRouterStore()

await routerStore.SetAsyncRouter()

const asyncRouters = routerStore.asyncRouters

asyncRouters.forEach(asyncRouter => {

router.addRoute(asyncRouter)

})

  

if (!router.hasRoute(userInfo.value.authority.defaultRouter)) {

ElMessage.error('请联系管理员进行授权')

} else {

await router.replace({ name: userInfo.value.authority.defaultRouter })

}

  

loadingInstance.value.close()

  

const isWin = ref(/windows/i.test(navigator.userAgent))

if (isWin.value) {

window.localStorage.setItem('osType', 'WIN')

} else {

window.localStorage.setItem('osType', 'MAC')

}

return true

}

} catch (e) {

loadingInstance.value.close()

}

loadingInstance.value.close()

}

/* 登出*/

const LoginOut = async() => {

const res = await jsonInBlacklist()

if (res.code === 0) {

token.value = ''

sessionStorage.clear()

localStorage.clear()

router.push({ name: 'Login', replace: true })

window.location.reload()

}

}

/* 清理数据 _/_

_const ClearStorage = async() => {_

_token.value = ''_

_sessionStorage.clear()_

_localStorage.clear()_

_}_

* /* 设置侧边栏模式*/

const changeSideMode = async(data) => {

const res = await setSelfInfo({ sideMode: data })

if (res.code === 0) {

userInfo.value.sideMode = data

ElMessage({

type: 'success',

message: '设置成功'

})

}

}

  

const mode = computed(() => userInfo.value.sideMode)

const sideMode = computed(() => {

if (userInfo.value.sideMode === 'dark') {

return '#191a23'

} else if (userInfo.value.sideMode === 'light') {

return '#fff'

} else {

return userInfo.value.sideMode

}

})

const baseColor = computed(() => {

if (userInfo.value.sideMode === 'dark') {

return '#fff'

} else if (userInfo.value.sideMode === 'light') {

return '#191a23'

} else {

return userInfo.value.baseColor

}

})

const activeColor = computed(() => {

return 'var(--el-color-primary)'

})

  

watch(() => token.value, () => {

window.localStorage.setItem('token', token.value)

})

  

return {

userInfo,

token,

NeedInit,

ResetUserInfo,

GetUserInfo,

LoginIn,

LoginOut,

changeSideMode,

mode,

sideMode,

setToken,

baseColor,

activeColor,

loadingInstance,

ClearStorage

}

})

### 1.5.4 index.js

import { createPinia } from 'pinia'

  

const store = createPinia()

  

export {

store

}

## 1.6 plugin/dashboard2/index.vue

<template>

<div id="root" class="dashboard-container">

<el-row :gutter="22">

<el-col :span="24">

<el-card class="box-card">

<el-descriptions title="审计日志数据" :extra="currentDatetime" />

<el-row>

<el-col :span="8">

<el-statistic group-separator="," :value="attackData.total" title="总审计日志条数" />

</el-col>

<el-col :span="8">

<el-statistic group-separator="," :value="attackData.high" title="告警日志" />

</el-col>

<el-col :span="8">

<el-statistic group-separator="," :value="attackData.block" title="正常日志" />

</el-col>

</el-row>

</el-card>

</el-col>

</el-row>

<el-row :gutter="20">

<el-col :span="12">

<el-card class="box-card">

<div slot="header" class="clearfix">

<span>近7天告警趋势</span>

</div>

<div id="attack_trends" style="width: auto;height:400px;" />

</el-card>

</el-col>

<el-col :span="12">

<el-card class="box-card">

<div slot="header" class="clearfix">

<span>告警类型</span>

</div>

<div id="attack_type" style="width: auto;height:400px;" />

</el-card>

</el-col>

</el-row>

</div>

</template>

  

<script>

import { getAttackData, getAttackTypeData, getTrendsData } from '@/api/dashboard2'

import * as echarts from 'echarts'

  

export default {

data() {

return {

currentDatetime: '',

attackData: {

total: 0,

high: 0,

block: 0

}

}

},

mounted() {

this.refreshDate()

this.getDashboardInfo()

this.getEChartsInfo()

window.addEventListener('resize', this.handleResize)

},

beforeDestroy() {

// 组件销毁前移除窗口大小变化的监听器

window.removeEventListener('resize', this.handleResize)

},

methods: {

refreshDate() {

setInterval(() => {

// 获取当前时间

const date = new Date()

// 格式化为本地时间格式

this.currentDatetime = date.toLocaleString()

}, 1000)

},

async getDashboardInfo() {

const res = await getAttackData()

this.attackData = res.data

},

  

async getEChartsInfo() {

const trendsDom = document.getElementById('attack_trends')

const trendsChart = echarts.init(trendsDom)

const trendsOption = await getTrendsData()

trendsOption && trendsChart.setOption(trendsOption)

  

const typeDom = document.getElementById('attack_type')

const typeChart = echarts.init(typeDom)

const typeOption = await getAttackTypeData()

typeOption && typeChart.setOption(typeOption)

},

handleResize() {

// 重新渲染图表

this.resizeChart('attack_trends')

this.resizeChart('attack_type')

},

resizeChart(chartId) {

const chartDom = document.getElementById(chartId)

const chartInstance = echarts.getInstanceByDom(chartDom)

if (chartInstance) {

chartInstance.resize()

}

}

}

}

</script>

  

<style scoped>

.el-row {

margin: 0px;

}

.el-col {

padding: 20px;

}

</style>

## 1.7 router

index.js

import { createRouter, createWebHashHistory } from 'vue-router'

  

const routes = [{

path: '/',

redirect: '/login'

},

{

path: '/init',

name: 'Init',

component: () => import('@/view/init/index.vue')

},

{

path: '/login',

name: 'Login',

component: () => import('@/view/login/index.vue')

},

{

path: '/:catchAll(.*)',

meta: {

closeTab: true,

},

component: () => import('@/view/error/index.vue')

}

]

  

const router = createRouter({

history: createWebHashHistory(),

routes,

})

  

export default router

## 1.8 style

### 1.8.1 element/index.scss

@forward 'element-plus/theme-chalk/src/common/var.scss' with (

$colors: (

'white': #ffffff,

'black': #000000,

'primary': (

'base': #4d70ff,

),

'success': (

'base': #67c23a,

),

'warning': (

'base': #e6a23c,

),

'danger': (

'base': #f56c6c,

),

'error': (

'base': #f56c6c,

),

'info': (

'base': #909399,

),

)

);

### 1.8.2 element_visiable.scss

@import '@/style/main.scss';

  

#app {

.el-button {

font-weight: 400;

border-radius: 2px;

}

}

  

::-webkit-scrollbar {

@apply hidden;

}

  

  

.gva-search-box {

@apply p-6 pb-0.5 bg-white rounded mb-3;

}

  

.gva-form-box {

@apply p-6 bg-white rounded;

}

  

.gva-pagination {

@apply flex justify-end;

.el-pagination__editor {

.el-input__inner {

@apply h-8;

}

}

  

.is-active {

@apply rounded text-white;

background: var(--el-color-primary);

color: #ffffff !important;

}

}

  

### 1.8.3 iconfont.css

@font-face {

font-family: 'gvaIcon';

src: url('data:font/ttf;charset=utf-8;base64,AAEAAAANAIAAAwBQRkZUTZJUyU8AAA14AAAAHEdERUYAKQARAAANWAAAAB5PUy8yPJpJTAAAAVgAAABgY21hcM0T0L4AAAHYAAABWmdhc3D//wADAAANUAAAAAhnbHlmRk3UvwAAA0wAAAbYaGVhZB/a5jgAAADcAAAANmhoZWEHngOFAAABFAAAACRobXR4DaoBrAAAAbgAAAAebG9jYQbMCGgAAAM0AAAAGG1heHABGgB+AAABOAAAACBuYW1lXoIBAgAACiQAAAKCcG9zdN15OnUAAAyoAAAAqAABAAAAAQAA+a916l8PPPUACwQAAAAAAN5YUSMAAAAA3lhRIwBL/8ADwAM1AAAACAACAAAAAAAAAAEAAAOA/4AAXAQAAAAAAAPAAAEAAAAAAAAAAAAAAAAAAAAEAAEAAAALAHIABQAAAAAAAgAAAAoACgAAAP8AAAAAAAAABAQAAZAABQAAAokCzAAAAI8CiQLMAAAB6wAyAQgAAAIABQMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUGZFZADA5mXmfQOA/4AAAAPcAIAAAAABAAAAAAAAAAAAAAAgAAEEAAAAAAAAAAQAAAAEAACLAIoAYAB1AHYASwBLAGAAAAAAAAMAAAADAAAAHAABAAAAAABUAAMAAQAAABwABAA4AAAACgAIAAIAAuZm5mrmduZ9//8AAOZl5mrmdeZ7//8ZnhmbGZEZjQABAAAAAAAAAAAAAAAAAQYAAAEAAAAAAAAAAQIAAAACAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEYAigEcAbgCUAK6AxoDbAACAIsAIANsAswAEQAjAAAlIicBJjQ3ATYeAQYHCQEeAQYhIicBJjQ3ATYeAQYHCQEeAQYDSw0J/qsLCwFVChsSAgr+xAE8CgIV/qkNCP6qCgoBVgkbEgIK/sUBOwoCFCAJATULGQsBNQoCExwI/uL+4ggbFAkBNQsZCwE1CgITHAj+4v7iCRoUAAAAAAIAigAgA2sCzAARACIAAAE0JwEmDgEWFwkBDgEWMjcBNiUBJg4BFhcJAQ4BFjI3ATY0AiAL/qsJHBECCQE8/sQJAhQZCQFVCwFA/qsKGxICCgE8/sQKAhUZCQFVCwF1DQsBNQoCExwI/uL+4gkaFAkBNQskATUKAhMcCP7i/uIJGhQJATULGQADAGD/wAOgAzUATABcAGwAAAE1NCcmJyYiBwYHBh0BDgEdARQWOwEyNj0BNCYrATU0NzY3NjIXFhcWHQEjIgYdARQWOwEGBwYHLgEjIgYUFjMyNjc2NzY3PgE9ATQmBRUUBisBIiY9ATQ2OwEyFgUUBisBIiY9ATQ2OwEyFhUDYDAvT1O+U08vMBslLB9VHi0tHiAoJkFDnENBJiggHi0tHhUPJC5SChwRHCQkHBEeCHJAMxAfKiX9kAYFVQUGBgVVBQYCVQYFVQUGBgVVBQYByQxgUlAuMDAuUFJgDAQqG6seLCweqx4tCk5DQScnJydBQ04KLR6rHiwrGiAGDxElNiUSEAc1KkUBKx6rGyhFqwQGBgSrBQYGsAQGBgSrBQYGBQAABAB1//UDjQMLABsANwBSAHEAABMyNj0BFxYyNjQvATMyNjQmKwEiBwYHBh0BFBYFIgYdAScmIgYUHwEjIgYUFjsBMjc2NzY9ATYmJQc1NCYiBh0BFBcWFxY7ATI2NCYrATc2NCYGATQ1FSYnJisBIgYUFjsBBwYUFjI/ARUUFjI2PQEnJpUNE7wJHRMKvIcMFBQM1ggCDAgCFALiDRPJCRoTCcmJDBQUDNYIAg8CAwES/gbJExkUAggKBAbWDBQUDInJCRMXAgEHCwQG2AwUFAyJvAkSHgi8ExoTAgEB9RQMibwIEhkKvBMZFAIGDAQI1gwU6hQMickJExoJyRMZFAIICgQG2AwUIsmHDBQUDNYIAg8CAxQZE8kKGRMBAcABAQIOAwMUGRO8ChkTCbyHDBQUDNYFBAAABAB2//cDjgMMABoANQBRAG0AAAEjIgYUFjsBMjc2NzY9ATQmIgYdAScmIgYUFwEzMjY0JisBIgcGBwYdARQWMjY9ARcWMjY0JyUmJyYrASIGFBY7AQcGFBYyPwEVFBYyNj0BLgE3FhcWOwEyNjQmKwE3NjQmIg8BNTQmIgYdAR4BATqJDRMTDdUJAg8CAhMaE7cKGRQKAjeJDRMTDdUJAg8CAhMaE8gJHhIK/i8HCgQH1w0TEw2JyQoTHQnIFBkTAQKoBwoEBtYNExMNibwKFBkKvBMZFAICAhoUGRMCBwoEBtYNExMNib4KExoK/iAUGRMCBwoEB9UNExMNickIEhkK8w8CAhMZFMgKGRMJyYkNExMN1QIJzQ8CAhMZFLsKGhMKvIkNExMN1QMIAAAAAAUAS//LA7UDNQAUACkAKgA3AEQAAAEiBwYHBhQXFhcWMjc2NzY0JyYnJgMiJyYnJjQ3Njc2MhcWFxYUBwYHBgMjFB4BMj4BNC4BIg4BFyIGHQEUFjI2PQE0JgIAd2ZiOzs7O2Jm7mZiOzs7O2Jmd2VXVDIzMzJUV8pXVDIzMzJUV2UrDBQWFAwMFBYUDCsNExMaExMDNTs7YmbuZmI7Ozs7YmbuZmI7O/zWMzJUV8pXVDIzMzJUV8pXVDIzAjULFAwMFBYUDAwUgBQM6w0TEw3rDBQAAQBL/+ADwAMgAD0AAAEmBg8BLgEjIgcGBwYUFxYXFjMyPgE3Ni4BBgcOAiMiJyYnJjQ3Njc2MzIeARcnJg4BFh8BMj8BNj8BNCYDpgwXAxc5yXZyY184Ojo4X2NyWaB4HgULGhcFGWaJS2FUUTAwMTBRU2FIhGQbgA0WBw4NwgUIBAwDMQ0CsQMODFhmeDk3XmHiYV43OUV9UQ0XCQsMRWo6MC9PUr9TTy8wNmNBJQMOGhYDMwMBCAu6DRYAAAAAAgBg/8YDugMiAB4AMwAABSc+ATU0JyYnJiIHBgcGFBcWFxYzMjc2NxcWMjc2JiUiJyYnJjQ3Njc2MhcWFxYUBwYHBgOxviouNDFVV8lXVTIzMzJVV2RDPzwzvgkeCAcB/hxUSEYpKiopRkioSEYpKyspRkgCvjB9RGRYVDIzNDJVWMlXVTE0GBYqvgkJChuBKylGSKhIRikqKilGSKhIRikrAAAAABIA3gABAAAAAAAAABMAKAABAAAAAAABAAgATgABAAAAAAACAAcAZwABAAAAAAADAAgAgQABAAAAAAAEAAgAnAABAAAAAAAFAAsAvQABAAAAAAAGAAgA2wABAAAAAAAKACsBPAABAAAAAAALABMBkAADAAEECQAAACYAAAADAAEECQABABAAPAADAAEECQACAA4AVwADAAEECQADABAAbwADAAEECQAEABAAigADAAEECQAFABYApQADAAEECQAGABAAyQADAAEECQAKAFYA5AADAAEECQALACYBaABDAHIAZQBhAHQAZQBkACAAYgB5ACAAaQBjAG8AbgBmAG8AbgB0AABDcmVhdGVkIGJ5IGljb25mb250AABpAGMAbwBuAGYAbwBuAHQAAGljb25mb250AABSAGUAZwB1AGwAYQByAABSZWd1bGFyAABpAGMAbwBuAGYAbwBuAHQAAGljb25mb250AABpAGMAbwBuAGYAbwBuAHQAAGljb25mb250AABWAGUAcgBzAGkAbwBuACAAMQAuADAAAFZlcnNpb24gMS4wAABpAGMAbwBuAGYAbwBuAHQAAGljb25mb250AABHAGUAbgBlAHIAYQB0AGUAZAAgAGIAeQAgAHMAdgBnADIAdAB0AGYAIABmAHIAbwBtACAARgBvAG4AdABlAGwAbABvACAAcAByAG8AagBlAGMAdAAuAABHZW5lcmF0ZWQgYnkgc3ZnMnR0ZiBmcm9tIEZvbnRlbGxvIHByb2plY3QuAABoAHQAdABwADoALwAvAGYAbwBuAHQAZQBsAGwAbwAuAGMAbwBtAABodHRwOi8vZm9udGVsbG8uY29tAAAAAAIAAAAAAAAACgAAAAAAAQAAAAAAAAAAAAAAAAAAAAAACwAAAAEAAgECAQMBBAEFAQYBBwEIAQkRYXJyb3ctZG91YmxlLWxlZnQSYXJyb3ctZG91YmxlLXJpZ2h0EGN1c3RvbWVyLXNlcnZpY2URZnVsbHNjcmVlbi1leHBhbmQRZnVsbHNjcmVlbi1zaHJpbmsGcHJvbXB0B3JlZnJlc2gGc2VhcmNoAAAAAf//AAIAAQAAAAwAAAAWAAAAAgABAAMACgABAAQAAAACAAAAAAAAAAEAAAAA1aQnCAAAAADeWFEjAAAAAN5YUSM=') format('truetype');

font-weight: 600;

font-style: normal;

font-display: swap;

}

.gvaIcon {

font-family: "gvaIcon" !important;

font-size: 16px;

font-style: normal;

font-weight: 800;

-webkit-font-smoothing: antialiased;

-moz-osx-font-smoothing: grayscale;

}

  

.gvaIcon-arrow-double-left:before {

content: "\e665";

}

  

.gvaIcon-arrow-double-right:before {

content: "\e666";

}

  

.gvaIcon-fullscreen-shrink:before {

content: "\e676";

}

.gvaIcon-customer-service:before {

content: "\e66a";

}

  

.gvaIcon-fullscreen-expand:before {

content: "\e675";

}

  

.gvaIcon-prompt:before {

content: "\e67b";

}

  

.gvaIcon-refresh:before {

content: "\e67c";

}

  

.gvaIcon-search:before {

content: "\e67d";

}

# 1.9 utils

### 1.9.1 asyncRouter.js

const viewModules = import.meta.glob('../view/**/*.vue')**

**const pluginModules = import.meta.glob('../plugin/**/*.vue')

  

export const asyncRouterHandle = (asyncRouter) => {

asyncRouter.forEach(item => {

if (item.component && typeof item.component === 'string') {

if (item.component.split('/')[0] === 'view') {

item.component = dynamicImport(viewModules, item.component)

} else if (item.component.split('/')[0] === 'plugin') {

item.component = dynamicImport(pluginModules, item.component)

}

}

if (item.children) {

asyncRouterHandle(item.children)

}

})

}

  

function dynamicImport(

dynamicViewsModules,

component

) {

const keys = Object.keys(dynamicViewsModules)

const matchKeys = keys.filter((key) => {

const k = key.replace('../', '')

return k === component

})

const matchKey = matchKeys[0]

  

return dynamicViewsModules[matchKey]

}

### 1.9.2 btnAuth.js

import { useRoute } from 'vue-router'

import { reactive } from 'vue'

export const useBtnAuth = () => {

const route = useRoute()

return route.meta.btns || reactive({})

}

### 1.9.3 bus.js

  

// using ES6 modules

import mitt from 'mitt'

  

export const emitter = mitt()

  

### 1.9.4 closeThisPage.js

import { emitter } from '@/utils/bus.js'

  

export const closeThisPage = () => {

emitter.emit('closeThisPage')

}

### 1.9.5 date.js

// 对Date的扩展，将 Date 转化为指定格式的String

// 月(M)、日(d)、小时(h)、分(m)、秒(s)、季度(q) 可以用 1-2 个占位符，

// 年(y)可以用 1-4 个占位符，毫秒(S)只能用 1 个占位符(是 1-3 位的数字)

// (new Date()).Format("yyyy-MM-dd hh:mm:ss.S") ==> 2006-07-02 08:09:04.423

// (new Date()).Format("yyyy-M-d h:m:s.S") ==> 2006-7-2 8:9:4.18

// eslint-disable-next-line no-extend-native

Date.prototype.Format = function(fmt) {

var o = {

'M+': this.getMonth() + 1, // 月份

'd+': this.getDate(), // 日

'h+': this.getHours(), // 小时

'm+': this.getMinutes(), // 分

's+': this.getSeconds(), // 秒

'q+': Math.floor((this.getMonth() + 3) / 3), // 季度

'S': this.getMilliseconds() // 毫秒

}

if (/(y+)/.test(fmt)) { fmt = fmt.replace(RegExp.$1, (this.getFullYear() + '').substr(4 - RegExp.$1.length)) }

for (var k in o) {

if (new RegExp('(' + k + ')').test(fmt)) { fmt = fmt.replace(RegExp.$1, (RegExp.$1.length === 1) ? (o[k]) : (('00' + o[k]).substr(('' + o[k]).length))) }

}

return fmt

}

  

export function formatTimeToStr(times, pattern) {

var d = new Date(times).Format('yyyy-MM-dd hh:mm:ss')

if (pattern) {

d = new Date(times).Format(pattern)

}

return d.toLocaleString()

}

### 1.9.6 dictionary.js

import { useDictionaryStore } from '@/pinia/modules/dictionary'

// 获取字典方法 使用示例 getDict('sex').then(res) 或者 async函数下 const res = await getDict('sex')

export const getDict = async(type) => {

const dictionaryStore = useDictionaryStore()

await dictionaryStore.getDictionary(type)

return dictionaryStore.dictionaryMap[type]

}

  

// 字典文字展示方法

export const showDictLabel = (dict, code) => {

if (!dict) {

return ''

}

const dictMap = {}

dict.forEach(item => {

dictMap[item.value] = item.label

})

return dictMap[code]

}

### 1.9.7 doc.js

export const toDoc = (url) => {

window.open(url, '_blank')

}

### 1.9.8 downloadImg.js

export const downloadImage = (imgsrc, name) => { // 下载图片地址和图片名

var image = new Image()

image.setAttribute('crossOrigin', 'anonymous')

image.onload = function() {

var canvas = document.createElement('canvas')

canvas.width = image.width

canvas.height = image.height

var context = canvas.getContext('2d')

context.drawImage(image, 0, 0, image.width, image.height)

var url = canvas.toDataURL('image/png') // 得到图片的base64编码数据

  

var a = document.createElement('a') // 生成一个a元素

var event = new MouseEvent('click') // 创建一个单击事件

a.download = name || 'photo' // 设置图片名称

a.href = url // 将生成的URL设置为a.href属性

a.dispatchEvent(event) // 触发a的单击事件

}

image.src = imgsrc

}

### 1.9.10 fmtRouterTitle.js

export const fmtTitle = (title, now) => {

const reg = /**\$\{**(.+?)**\}**/

const reg_g = /**\$\{**(.+?)**\}**/g

const result = title.match(reg_g)

if (result) {

result.forEach((item) => {

const key = item.match(reg)[1]

const value = now.params[key] || now.query[key]

title = title.replace(item, value)

})

}

return title

}

### 1.9.11 format.js

import { formatTimeToStr } from '@/utils/date'

import { getDict } from '@/utils/dictionary'

  

export const formatBoolean = (bool) => {

if (bool !== null) {

return bool ? '是' : '否'

} else {

return ''

}

}

export const formatDate = (time) => {

if (time !== null && time !== '') {

var date = new Date(time)

return formatTimeToStr(date, 'yyyy-MM-dd hh:mm:ss')

} else {

return ''

}

}

  

export const filterDict = (value, options) => {

const rowLabel = options && options.filter(item => item.value === value)

return rowLabel && rowLabel[0] && rowLabel[0].label

}

  

export const getDictFunc = async(type) => {

const dicts = await getDict(type)

return dicts

}

  

const path = import.meta.env.VITE_BASE_PATH + ':' + import.meta.env.VITE_SERVER_PORT + '/'

export const ReturnArrImg = (arr) => {

const imgArr = []

if (arr instanceof Array) { // 如果是数组类型

for (const arrKey in arr) {

if (arr[arrKey].slice(0, 4) !== 'http') {

imgArr.push(path + arr[arrKey])

} else {

imgArr.push(arr[arrKey])

}

}

} else { // 如果不是数组类型

if (arr.slice(0, 4) !== 'http') {

imgArr.push(path + arr)

} else {

imgArr.push(arr)

}

}

return imgArr

}

  

export const onDownloadFile = (url) => {

window.open(path + url)

}

### 1.9.12 image.js

export default class ImageCompress {

constructor(file, fileSize, maxWH = 1920) {

this.file = file

this.fileSize = fileSize

this.maxWH = maxWH // 最大长宽

}

  

compress() {

// 压缩

const fileType = this.file.type

const fileSize = this.file.size / 1024

return new Promise(resolve => {

const reader = new FileReader()

reader.readAsDataURL(this.file)

reader.onload = () => {

const canvas = document.createElement('canvas')

const img = document.createElement('img')

img.src = reader.result

img.onload = () => {

const ctx = canvas.getContext('2d')

const _dWH = this.dWH(img.width, img.height, this.maxWH)

canvas.width = _dWH.width

canvas.height = _dWH.height

  

// 清空后, 重写画布

ctx.clearRect(0, 0, canvas.width, canvas.height)

ctx.drawImage(img, 0, 0, canvas.width, canvas.height)

  

const newImgData = canvas.toDataURL(fileType, 0.90)

  

// 压缩宽高后的图像大小

const newImgSize = this.fileSizeKB(newImgData)

  

if (newImgSize > this.fileSize) {

console.log('图片尺寸太大!' + fileSize + ' >> ' + newImgSize)

}

  

const blob = this.dataURLtoBlob(newImgData, fileType)

const nfile = new File([blob], this.file.name)

resolve(nfile)

}

}

})

}

  

/**

- 长宽等比缩小
    
- 图像的一边(长或宽)为最大目标值
    

*/

dWH(srcW, srcH, dMax) {

const defaults = {

width: srcW,

height: srcH

}

if (Math.max(srcW, srcH) > dMax) {

if (srcW > srcH) {

defaults.width = dMax

defaults.height = Math.round(srcH * (dMax / srcW))

return defaults

} else {

defaults.height = dMax

defaults.width = Math.round(srcW * (dMax / srcH))

return defaults

}

} else {

return defaults

}

}

  

fileSizeKB(dataURL) {

let sizeKB = 0

sizeKB = Math.round((dataURL.split(',')[1].length * 3 / 4) / 1024)

return sizeKB

}

  

/**

- 转为Blob
    

*/

dataURLtoBlob(dataURL, fileType) {

const byteString = atob(dataURL.split(',')[1])

let mimeString = dataURL.split(',')[0].split(':')[1].split(';')[0]

const ab = new ArrayBuffer(byteString.length)

const ia = new Uint8Array(ab)

for (let i = 0; i < byteString.length; i++) {

ia[i] = byteString.charCodeAt(i)

}

if (fileType) {

mimeString = fileType

}

return new Blob([ab], { type: mimeString, lastModifiedDate: new Date() })

}

}

  

const path = import.meta.env.VITE_FILE_API + '/'

export const getUrl = (url) => url && url.slice(0, 4) !== 'http' ? path + url : url

  

export const isVideoExt = (url) => url.endsWith('.mp4') || url.endsWith('.mov') || url.endsWith('.webm') || url.endsWith('.ogg');

  

export const isVideoMime = (type) => type == 'video/mp4' || type == 'video/webm' || type == 'video/ogg';

  

export const isImageMime = (type) => type == 'image/jpeg' || type == 'image/png' || type == 'image/webp' || type == 'image/svg+xml';

### 1.9.13 page.js

import { fmtTitle } from '@/utils/fmtRouterTitle'

import config from '@/core/config'

export default function getPageTitle(pageTitle, route) {

if (pageTitle) {

const title = fmtTitle(pageTitle, route)

return `${title} - ${config.appName}`

}

return `${config.appName}`

}

### 1.9.14 positionToCode.js

export const initDom = () => {

if (import.meta.env.MODE === 'development') {

document.onmousedown = function(e) {

if (e.shiftKey && e.button === 0) {

e.preventDefault()

sendRequestToOpenFileInEditor(getFilePath(e))

}

}

}

}

  

const getFilePath = (e) => {

let element = e

if (e.target) {

element = e.target

}

if (!element || !element.getAttribute) return null

if (element.getAttribute('code-location')) {

return element.getAttribute('code-location')

}

return getFilePath(element.parentNode)

}

  

const sendRequestToOpenFileInEditor = (filePath) => {

const protocol = window.location.protocol

? window.location.protocol

: 'http:'

const hostname = window.location.hostname

? window.location.hostname

: 'localhost'

const port = window.location.port ? window.location.port : '80'

fetch(`${protocol}//${hostname}:${port}/gvaPositionCode?filePath=${filePath}`)

.catch((error) => {

console.log(error)

})

}

### 1.9.15 request.js

import axios from 'axios' // 引入axios

import { ElMessage, ElMessageBox } from 'element-plus'

import { useUserStore } from '@/pinia/modules/user'

import { emitter } from '@/utils/bus.js'

import router from '@/router/index'

  

const service = axios.create({

baseURL: import.meta.env.VITE_BASE_API,

timeout: 99999

})

let acitveAxios = 0

let timer

const showLoading = () => {

acitveAxios++

if (timer) {

clearTimeout(timer)

}

timer = setTimeout(() => {

if (acitveAxios > 0) {

emitter.emit('showLoading')

}

}, 400)

}

  

const closeLoading = () => {

acitveAxios--

if (acitveAxios <= 0) {

clearTimeout(timer)

emitter.emit('closeLoading')

}

}

// http request 拦截器

service.interceptors.request.use(

config => {

if (!config.donNotShowLoading) {

showLoading()

}

const userStore = useUserStore()

config.headers = {

'Content-Type': 'application/json',

'x-token': userStore.token,

'x-user-id': userStore.userInfo.ID,

...config.headers

}

return config

},

error => {

if (!error.config.donNotShowLoading) {

closeLoading()

}

ElMessage({

showClose: true,

message: error,

type: 'error'

})

return error

}

)

  

// http response 拦截器

service.interceptors.response.use(

response => {

const userStore = useUserStore()

if (!response.config.donNotShowLoading) {

closeLoading()

}

if (response.headers['new-token']) {

userStore.setToken(response.headers['new-token'])

}

if (response.data.code === 0 || response.headers.success === 'true') {

if (response.headers.msg) {

response.data.msg = decodeURI(response.headers.msg)

}

return response.data

} else {

ElMessage({

showClose: true,

message: response.data.msg || decodeURI(response.headers.msg),

type: 'error'

})

if (response.data.data && response.data.data.reload) {

userStore.token = ''

localStorage.clear()

router.push({ name: 'Login', replace: true })

}

return response.data.msg ? response.data : response

}

},

error => {

if (!error.config.donNotShowLoading) {

closeLoading()

}

  

if (!error.response) {

ElMessageBox.confirm( `<p>检测到请求错误</p> <p>${error}</p>` , '请求报错', {

dangerouslyUseHTMLString: true,

distinguishCancelAndClose: true,

confirmButtonText: '稍后重试',

cancelButtonText: '取消'

})

return

}

  

switch (error.response.status) {

case 500:

ElMessageBox.confirm( `<p>检测到接口错误${error}</p> <p>错误码<span style="color:red"> 500 </span>：此类错误内容常见于后台panic，请先查看后台日志，如果影响您正常使用可强制登出清理缓存</p>` , '接口报错', {

dangerouslyUseHTMLString: true,

distinguishCancelAndClose: true,

confirmButtonText: '清理缓存',

cancelButtonText: '取消'

})

.then(() => {

const userStore = useUserStore()

userStore.token = ''

localStorage.clear()

router.push({ name: 'Login', replace: true })

})

break

case 404:

ElMessageBox.confirm( `<p>检测到接口错误${error}</p> <p>错误码<span style="color:red"> 404 </span>：此类错误多为接口未注册（或未重启）或者请求路径（方法）与api路径（方法）不符--如果为自动化代码请检查是否存在空格</p>` , '接口报错', {

dangerouslyUseHTMLString: true,

distinguishCancelAndClose: true,

confirmButtonText: '我知道了',

cancelButtonText: '取消'

})

break

}

  

return error

}

)

export default service

### 1.9.16 stringFun.js

/* eslint-disable */

export const toUpperCase = (str) => {

if (str[0]) {

return str.replace(str[0], str[0].toUpperCase())

} else {

return ''

}

}

  

export const toLowerCase = (str) => {

if (str[0]) {

return str.replace(str[0], str[0].toLowerCase())

} else {

return ''

}

}

  

// 驼峰转换下划线

export const toSQLLine = (str) => {

if (str === 'ID') return 'ID'

return str.replace(/([A-Z])/g, "_$1").toLowerCase();

}

  

// 下划线转换驼峰

export const toHump = (name) => {

return name.replace(/**\_**(\w)/g, function(all, letter) {

return letter.toUpperCase();

});

}

## 1.10 view

### 1.10.1 about/index.vue

<template>

<div>

<el-row :gutter="10">

<el-col :span="12">

<el-card>

<template #header>

<el-divider>gin-vue-admin</el-divider>

</template>

<div>

<el-row>

<el-col

:span="8"

:offset="8"

>

<a href="https://github.com/flipped-aurora/gin-vue-admin">

<img

class="org-img dom-center"

src="@/assets/logo.png"

alt="gin-vue-admin"

>

</a>

</el-col>

</el-row>

<el-row :gutter="10">

<el-col :span="8">

<a href="https://github.com/flipped-aurora/gin-vue-admin">

<img

class="dom-center"

src="https://img.shields.io/github/watchers/flipped-aurora/gin-vue-admin.svg?label=Watch"

alt=""

>

</a>

</el-col>

<el-col :span="8">

<a href="https://github.com/flipped-aurora/gin-vue-admin">

<img

class="dom-center"

src="https://img.shields.io/github/stars/flipped-aurora/gin-vue-admin.svg?style=social"

alt=""

>

</a>

</el-col>

<el-col :span="8">

<a href="https://github.com/flipped-aurora/gin-vue-admin">

<img

class="dom-center"

src="https://img.shields.io/github/forks/flipped-aurora/gin-vue-admin.svg?label=Fork"

alt=""

>

</a>

</el-col>

</el-row>

</div>

</el-card>

<el-card style="margin-top: 20px">

<template #header>

<div>flipped-aurora团队</div>

</template>

<div>

<el-row>

<el-col

:span="8"

:offset="8"

>

<a href="https://github.com/flipped-aurora">

<img

class="org-img dom-center"

src="@/assets/flipped-aurora.png"

alt="flipped-aurora"

>

</a>

</el-col>

</el-row>

<el-row

style="margin-left: 40px"

:gutter="20"

>

<el-col

v-for="(item, index) in members"

:key="index"

:span="8"

>

<a :href="item.html_url">

<img

class="avatar-img"

:src="item.avatar_url"

>

<a

class="author-name"

style=""

>{{ item.login }}</a>

</a>

</el-col>

</el-row>

</div>

</el-card>

</el-col>

<el-col :span="12">

<el-card>

<template #header>

<div>提交记录</div>

</template>

<div>

<el-timeline>

<el-timeline-item

v-for="(item,index) in dataTimeline"

:key="index"

:timestamp="item.from"

placement="top"

>

<el-card>

<h4>{{ item.title }}</h4>

<p>{{ item.message }}</p>

</el-card>

</el-timeline-item>

</el-timeline>

</div>

<el-button

class="load-more"

type="primary"

link

@click="loadMore"

>Load more</el-button>

</el-card>

</el-col>

</el-row>

</div>

</template>

  

<script setup>

import { ref } from 'vue'

import { Commits, Members } from '@/api/github'

import { formatTimeToStr } from '@/utils/date'

const page = ref(0)

  

defineOptions({

name: 'About'

})

  

const loadMore = () => {

page.value++

loadCommits()

}

  

const dataTimeline = ref([])

const loadCommits = () => {

Commits(page.value).then(({ data }) => {

data.forEach((element) => {

if (element.commit.message) {

dataTimeline.value.push({

from: formatTimeToStr(element.commit.author.date, 'yyyy-MM-dd'),

title: element.commit.author.name,

showDayAndMonth: true,

message: element.commit.message,

})

}

})

})

}

  

const members = ref([])

const loadMembers = () => {

Members().then(({ data }) => {

members.value = data

members.value.sort()

})

}

  

loadCommits()

loadMembers()

  

</script>

  

<style scoped>

.load-more {

margin-left: 120px;

}

  

.avatar-img {

float: left;

height: 40px;

width: 40px;

border-radius: 50%;

-webkit-border-radius: 50%;

-moz-border-radius: 50%;

margin-top: 15px;

}

  

.org-img {

height: 150px;

width: 150px;

}

  

.author-name {

float: left;

line-height: 65px !important;

margin-left: 10px;

color: darkblue;

line-height: 100px;

font-family: "Lucida Sans", "Lucida Sans Regular", "Lucida Grande",

"Lucida Sans Unicode", Geneva, Verdana, sans-serif;

}

  

.dom-center {

margin-left: 50%;

transform: translateX(-50%);

}

</style>

### 1.10.2 alarmse

alarmse├─ alarmse.vue└─ alarmseForm.vue

alarmse.vue

<template>

<div>

<div class="gva-search-box">

<el-form ref="elSearchFormRef" :inline="true" :model="searchInfo" class="demo-form-inline" :rules="searchRule" @keyup.enter="onSubmit">

<el-form-item label="创建日期" prop="createdAt">

<template #label>

<span>

创建日期

<el-tooltip content="搜索范围是开始日期（包含）至结束日期（不包含）">

<el-icon><QuestionFilled /></el-icon>

</el-tooltip>

</span>

</template>

<el-date-picker v-model="searchInfo.startCreatedAt" type="datetime" placeholder="开始日期" :disabled-date="time=> searchInfo.endCreatedAt ? time.getTime() > searchInfo.endCreatedAt.getTime() : false"></el-date-picker>

—

<el-date-picker v-model="searchInfo.endCreatedAt" type="datetime" placeholder="结束日期" :disabled-date="time=> searchInfo.startCreatedAt ? time.getTime() < searchInfo.startCreatedAt.getTime() : false"></el-date-picker>

</el-form-item>

<el-form-item>

<el-button type="primary" icon="search" @click="onSubmit">查询</el-button>

<el-button icon="refresh" @click="onReset">重置</el-button>

</el-form-item>

</el-form>

</div>

<div class="gva-table-box">

<div class="gva-btn-list">

<el-button type="primary" icon="plus" @click="openDialog">新增</el-button>

<el-popover v-model:visible="deleteVisible" :disabled="!multipleSelection.length" placement="top" width="160">

<p>确定要删除吗？</p>

<div style="text-align: right; margin-top: 8px;">

<el-button type="primary" link @click="deleteVisible = false">取消</el-button>

<el-button type="primary" @click="onDelete">确定</el-button>

</div>

<template #reference>

<el-button icon="delete" style="margin-left: 10px;" :disabled="!multipleSelection.length" @click="deleteVisible = true">删除</el-button>

</template>

</el-popover>

</div>

<el-table

ref="multipleTable"

style="width: 100%"

tooltip-effect="dark"

:data="tableData"

row-key="ID"

@selection-change="handleSelectionChange"

>

<el-table-column type="selection" width="55" />

<el-table-column align="left" label="日期" width="180">

<template #default="scope">{{ formatDate(scope.row.CreatedAt) }}</template>

</el-table-column>

<el-table-column align="left" label="auditType字段" prop="auditType" width="120" />

<el-table-column align="left" label="sessionId字段" prop="sessionId" width="120" />

<el-table-column align="left" label="statementId字段" prop="statementId" width="120" />

<el-table-column align="left" label="entryId字段" prop="entryId" width="120" />

<el-table-column align="left" label="extendedTimestamp字段" prop="extendedTimestamp" width="120" />

<el-table-column align="left" label="dbUser字段" prop="dbUser" width="120" />

<el-table-column align="left" label="osUser字段" prop="osUser" width="120" />

<el-table-column align="left" label="userHost字段" prop="userHost" width="120" />

<el-table-column align="left" label="osProcess字段" prop="osProcess" width="120" />

<el-table-column align="left" label="terminal字段" prop="terminal" width="120" />

<el-table-column align="left" label="instanceNumber字段" prop="instanceNumber" width="120" />

<el-table-column align="left" label="objectSchema字段" prop="objectSchema" width="120" />

<el-table-column align="left" label="objectName字段" prop="objectName" width="120" />

<el-table-column align="left" label="action字段" prop="action" width="120" />

<el-table-column align="left" label="returnCode字段" prop="returnCode" width="120" />

<el-table-column align="left" label="scn字段" prop="scn" width="120" />

<el-table-column align="left" label="dbId字段" prop="dbId" width="120" />

<el-table-column align="left" label="sqlBind字段" prop="sqlBind" width="120" />

<el-table-column align="left" label="sqlText字段" prop="sqlText" width="120" />

<el-table-column align="left" label="阈值" prop="rThreshold" width="120" />

<el-table-column align="left" label="模式" prop="rPattern" width="120" />

<el-table-column align="left" label="动作" prop="rAction" width="120" />

<el-table-column align="left" label="描述" prop="rDescription" width="120" />

<el-table-column align="left" label="查询次数" prop="querycount" width="120" />

<el-table-column align="left" label="操作" min-width="120">

<template #default="scope">

<el-button type="primary" link class="table-button" @click="getDetails(scope.row)">

<el-icon style="margin-right: 5px"><InfoFilled /></el-icon>

查看详情

</el-button>

<el-button type="primary" link icon="edit" class="table-button" @click="updateAlarmseFunc(scope.row)">变更</el-button>

<el-button type="primary" link icon="delete" @click="deleteRow(scope.row)">删除</el-button>

</template>

</el-table-column>

</el-table>

<div class="gva-pagination">

<el-pagination

layout="total, sizes, prev, pager, next, jumper"

:current-page="page"

:page-size="pageSize"

:page-sizes="[10, 30, 50, 100]"

:total="total"

@current-change="handleCurrentChange"

@size-change="handleSizeChange"

/>

</div>

</div>

<el-dialog v-model="dialogFormVisible" :before-close="closeDialog" :title="type==='create'?'添加':'修改'" destroy-on-close>

<el-scrollbar height="500px">

<el-form :model="formData" label-position="right" ref="elFormRef" :rules="rule" label-width="80px">

<el-form-item label="auditType字段:" prop="auditType" >

<el-input v-model.number="formData.auditType" :clearable="true" placeholder="请输入auditType字段" />

</el-form-item>

<el-form-item label="sessionId字段:" prop="sessionId" >

<el-input v-model.number="formData.sessionId" :clearable="true" placeholder="请输入sessionId字段" />

</el-form-item>

<el-form-item label="statementId字段:" prop="statementId" >

<el-input v-model.number="formData.statementId" :clearable="true" placeholder="请输入statementId字段" />

</el-form-item>

<el-form-item label="entryId字段:" prop="entryId" >

<el-input v-model.number="formData.entryId" :clearable="true" placeholder="请输入entryId字段" />

</el-form-item>

<el-form-item label="extendedTimestamp字段:" prop="extendedTimestamp" >

<el-input v-model="formData.extendedTimestamp" :clearable="true" placeholder="请输入extendedTimestamp字段" />

</el-form-item>

<el-form-item label="dbUser字段:" prop="dbUser" >

<el-input v-model="formData.dbUser" :clearable="true" placeholder="请输入dbUser字段" />

</el-form-item>

<el-form-item label="osUser字段:" prop="osUser" >

<el-input v-model="formData.osUser" :clearable="true" placeholder="请输入osUser字段" />

</el-form-item>

<el-form-item label="userHost字段:" prop="userHost" >

<el-input v-model="formData.userHost" :clearable="true" placeholder="请输入userHost字段" />

</el-form-item>

<el-form-item label="osProcess字段:" prop="osProcess" >

<el-input v-model.number="formData.osProcess" :clearable="true" placeholder="请输入osProcess字段" />

</el-form-item>

<el-form-item label="terminal字段:" prop="terminal" >

<el-input v-model="formData.terminal" :clearable="true" placeholder="请输入terminal字段" />

</el-form-item>

<el-form-item label="instanceNumber字段:" prop="instanceNumber" >

<el-input v-model.number="formData.instanceNumber" :clearable="true" placeholder="请输入instanceNumber字段" />

</el-form-item>

<el-form-item label="objectSchema字段:" prop="objectSchema" >

<el-input v-model="formData.objectSchema" :clearable="true" placeholder="请输入objectSchema字段" />

</el-form-item>

<el-form-item label="objectName字段:" prop="objectName" >

<el-input v-model="formData.objectName" :clearable="true" placeholder="请输入objectName字段" />

</el-form-item>

<el-form-item label="action字段:" prop="action" >

<el-input v-model.number="formData.action" :clearable="true" placeholder="请输入action字段" />

</el-form-item>

<el-form-item label="returnCode字段:" prop="returnCode" >

<el-input v-model.number="formData.returnCode" :clearable="true" placeholder="请输入returnCode字段" />

</el-form-item>

<el-form-item label="scn字段:" prop="scn" >

<el-input v-model.number="formData.scn" :clearable="true" placeholder="请输入scn字段" />

</el-form-item>

<el-form-item label="dbId字段:" prop="dbId" >

<el-input v-model.number="formData.dbId" :clearable="true" placeholder="请输入dbId字段" />

</el-form-item>

<el-form-item label="sqlBind字段:" prop="sqlBind" >

<el-input v-model="formData.sqlBind" :clearable="true" placeholder="请输入sqlBind字段" />

</el-form-item>

<el-form-item label="sqlText字段:" prop="sqlText" >

<el-input v-model="formData.sqlText" :clearable="true" placeholder="请输入sqlText字段" />

</el-form-item>

<el-form-item label="阈值:" prop="rThreshold" >

<el-input v-model.number="formData.rThreshold" :clearable="true" placeholder="请输入阈值" />

</el-form-item>

<el-form-item label="模式:" prop="rPattern" >

<el-input v-model="formData.rPattern" :clearable="true" placeholder="请输入模式" />

</el-form-item>

<el-form-item label="动作:" prop="rAction" >

<el-input v-model="formData.rAction" :clearable="true" placeholder="请输入动作" />

</el-form-item>

<el-form-item label="描述:" prop="rDescription" >

<el-input v-model="formData.rDescription" :clearable="true" placeholder="请输入描述" />

</el-form-item>

<el-form-item label="查询次数:" prop="querycount" >

<el-input v-model.number="formData.querycount" :clearable="true" placeholder="请输入查询次数" />

</el-form-item>

</el-form>

</el-scrollbar>

<template #footer>

<div class="dialog-footer">

<el-button @click="closeDialog">取 消</el-button>

<el-button type="primary" @click="enterDialog">确 定</el-button>

</div>

</template>

</el-dialog>

  

<el-dialog v-model="detailShow" style="width: 800px" lock-scroll :before-close="closeDetailShow" title="查看详情" destroy-on-close>

<el-scrollbar height="550px">

<el-descriptions column="1" border>

<el-descriptions-item label="auditType字段">

{{ formData.auditType }}

</el-descriptions-item>

<el-descriptions-item label="sessionId字段">

{{ formData.sessionId }}

</el-descriptions-item>

<el-descriptions-item label="statementId字段">

{{ formData.statementId }}

</el-descriptions-item>

<el-descriptions-item label="entryId字段">

{{ formData.entryId }}

</el-descriptions-item>

<el-descriptions-item label="extendedTimestamp字段">

{{ formData.extendedTimestamp }}

</el-descriptions-item>

<el-descriptions-item label="dbUser字段">

{{ formData.dbUser }}

</el-descriptions-item>

<el-descriptions-item label="osUser字段">

{{ formData.osUser }}

</el-descriptions-item>

<el-descriptions-item label="userHost字段">

{{ formData.userHost }}

</el-descriptions-item>

<el-descriptions-item label="osProcess字段">

{{ formData.osProcess }}

</el-descriptions-item>

<el-descriptions-item label="terminal字段">

{{ formData.terminal }}

</el-descriptions-item>

<el-descriptions-item label="instanceNumber字段">

{{ formData.instanceNumber }}

</el-descriptions-item>

<el-descriptions-item label="objectSchema字段">

{{ formData.objectSchema }}

</el-descriptions-item>

<el-descriptions-item label="objectName字段">

{{ formData.objectName }}

</el-descriptions-item>

<el-descriptions-item label="action字段">

{{ formData.action }}

</el-descriptions-item>

<el-descriptions-item label="returnCode字段">

{{ formData.returnCode }}

</el-descriptions-item>

<el-descriptions-item label="scn字段">

{{ formData.scn }}

</el-descriptions-item>

<el-descriptions-item label="dbId字段">

{{ formData.dbId }}

</el-descriptions-item>

<el-descriptions-item label="sqlBind字段">

{{ formData.sqlBind }}

</el-descriptions-item>

<el-descriptions-item label="sqlText字段">

{{ formData.sqlText }}

</el-descriptions-item>

<el-descriptions-item label="阈值">

{{ formData.rThreshold }}

</el-descriptions-item>

<el-descriptions-item label="模式">

{{ formData.rPattern }}

</el-descriptions-item>

<el-descriptions-item label="动作">

{{ formData.rAction }}

</el-descriptions-item>

<el-descriptions-item label="描述">

{{ formData.rDescription }}

</el-descriptions-item>

<el-descriptions-item label="查询次数">

{{ formData.querycount }}

</el-descriptions-item>

</el-descriptions>

</el-scrollbar>

</el-dialog>

</div>

</template>

  

<script setup>

import {

createAlarmse,

deleteAlarmse,

deleteAlarmseByIds,

updateAlarmse,

findAlarmse,

getAlarmseList

} from '@/api/alarmse'

  

// 全量引入格式化工具 请按需保留

import { getDictFunc, formatDate, formatBoolean, filterDict, ReturnArrImg, onDownloadFile } from '@/utils/format'

import { ElMessage, ElMessageBox } from 'element-plus'

import { ref, reactive } from 'vue'

  

defineOptions({

name: 'Alarmse'

})

  

// 自动化生成的字典（可能为空）以及字段

const formData = ref({

auditType: 0,

sessionId: 0,

statementId: 0,

entryId: 0,

extendedTimestamp: '',

dbUser: '',

osUser: '',

userHost: '',

osProcess: 0,

terminal: '',

instanceNumber: 0,

objectSchema: '',

objectName: '',

action: 0,

returnCode: 0,

scn: 0,

dbId: 0,

sqlBind: '',

sqlText: '',

rThreshold: 0,

rPattern: '',

rAction: '',

rDescription: '',

querycount: 0,

})

  

  

// 验证规则

const rule = reactive({

})

  

const searchRule = reactive({

createdAt: [

{ validator: (rule, value, callback) => {

if (searchInfo.value.startCreatedAt && !searchInfo.value.endCreatedAt) {

callback(new Error('请填写结束日期'))

} else if (!searchInfo.value.startCreatedAt && searchInfo.value.endCreatedAt) {

callback(new Error('请填写开始日期'))

} else if (searchInfo.value.startCreatedAt && searchInfo.value.endCreatedAt && (searchInfo.value.startCreatedAt.getTime() === searchInfo.value.endCreatedAt.getTime() || searchInfo.value.startCreatedAt.getTime() > searchInfo.value.endCreatedAt.getTime())) {

callback(new Error('开始日期应当早于结束日期'))

} else {

callback()

}

}, trigger: 'change' }

],

})

  

const elFormRef = ref()

const elSearchFormRef = ref()

  

// =========== 表格控制部分 ===========

const page = ref(1)

const total = ref(0)

const pageSize = ref(10)

const tableData = ref([])

const searchInfo = ref({})

  

// 重置

const onReset = () => {

searchInfo.value = {}

getTableData()

}

  

// 搜索

const onSubmit = () => {

elSearchFormRef.value?.validate(async(valid) => {

if (!valid) return

page.value = 1

pageSize.value = 10

getTableData()

})

}

  

// 分页

const handleSizeChange = (val) => {

pageSize.value = val

getTableData()

}

  

// 修改页面容量

const handleCurrentChange = (val) => {

page.value = val

getTableData()

}

  

// 查询

const getTableData = async() => {

const table = await getAlarmseList({ page: page.value, pageSize: pageSize.value, ...searchInfo.value })

if (table.code === 0) {

tableData.value = table.data.list

total.value = table.data.total

page.value = table.data.page

pageSize.value = table.data.pageSize

}

}

  

getTableData()

  

// ============== 表格控制部分结束 ===============

  

// 获取需要的字典 可能为空 按需保留

const setOptions = async () =>{

}

  

// 获取需要的字典 可能为空 按需保留

setOptions()

  

  

// 多选数据

const multipleSelection = ref([])

// 多选

const handleSelectionChange = (val) => {

multipleSelection.value = val

}

  

// 删除行

const deleteRow = (row) => {

ElMessageBox.confirm('确定要删除吗?', '提示', {

confirmButtonText: '确定',

cancelButtonText: '取消',

type: 'warning'

}).then(() => {

deleteAlarmseFunc(row)

})

}

  

  

// 批量删除控制标记

const deleteVisible = ref(false)

  

// 多选删除

const onDelete = async() => {

const ids = []

if (multipleSelection.value.length === 0) {

ElMessage({

type: 'warning',

message: '请选择要删除的数据'

})

return

}

multipleSelection.value &&

multipleSelection.value.map(item => {

ids.push(item.ID)

})

const res = await deleteAlarmseByIds({ ids })

if (res.code === 0) {

ElMessage({

type: 'success',

message: '删除成功'

})

if (tableData.value.length === ids.length && page.value > 1) {

page.value--

}

deleteVisible.value = false

getTableData()

}

}

  

// 行为控制标记（弹窗内部需要增还是改）

const type = ref('')

  

// 更新行

const updateAlarmseFunc = async(row) => {

const res = await findAlarmse({ ID: row.ID })

type.value = 'update'

if (res.code === 0) {

formData.value = res.data.realarmse

dialogFormVisible.value = true

}

}

  

  

// 删除行

const deleteAlarmseFunc = async (row) => {

const res = await deleteAlarmse({ ID: row.ID })

if (res.code === 0) {

ElMessage({

type: 'success',

message: '删除成功'

})

if (tableData.value.length === 1 && page.value > 1) {

page.value--

}

getTableData()

}

}

  

// 弹窗控制标记

const dialogFormVisible = ref(false)

  

  

// 查看详情控制标记

const detailShow = ref(false)

  

  

// 打开详情弹窗

const openDetailShow = () => {

detailShow.value = true

}

  

  

// 打开详情

const getDetails = async (row) => {

// 打开弹窗

const res = await findAlarmse({ ID: row.ID })

if (res.code === 0) {

formData.value = res.data.realarmse

openDetailShow()

}

}

  

  

// 关闭详情弹窗

const closeDetailShow = () => {

detailShow.value = false

formData.value = {

auditType: 0,

sessionId: 0,

statementId: 0,

entryId: 0,

extendedTimestamp: '',

dbUser: '',

osUser: '',

userHost: '',

osProcess: 0,

terminal: '',

instanceNumber: 0,

objectSchema: '',

objectName: '',

action: 0,

returnCode: 0,

scn: 0,

dbId: 0,

sqlBind: '',

sqlText: '',

rThreshold: 0,

rPattern: '',

rAction: '',

rDescription: '',

querycount: 0,

}

}

  

  

// 打开弹窗

const openDialog = () => {

type.value = 'create'

dialogFormVisible.value = true

}

  

// 关闭弹窗

const closeDialog = () => {

dialogFormVisible.value = false

formData.value = {

auditType: 0,

sessionId: 0,

statementId: 0,

entryId: 0,

extendedTimestamp: '',

dbUser: '',

osUser: '',

userHost: '',

osProcess: 0,

terminal: '',

instanceNumber: 0,

objectSchema: '',

objectName: '',

action: 0,

returnCode: 0,

scn: 0,

dbId: 0,

sqlBind: '',

sqlText: '',

rThreshold: 0,

rPattern: '',

rAction: '',

rDescription: '',

querycount: 0,

}

}

// 弹窗确定

const enterDialog = async () => {

elFormRef.value?.validate( async (valid) => {

if (!valid) return

let res

switch (type.value) {

case 'create':

res = await createAlarmse(formData.value)

break

case 'update':

res = await updateAlarmse(formData.value)

break

default:

res = await createAlarmse(formData.value)

break

}

if (res.code === 0) {

ElMessage({

type: 'success',

message: '创建/更改成功'

})

closeDialog()

getTableData()

}

})

}

  

</script>

  

<style>

  

</style>

  

alarmseForm.vue

<template>

<div>

<div class="gva-form-box">

<el-form :model="formData" ref="elFormRef" label-position="right" :rules="rule" label-width="80px">

<el-form-item label="auditType字段:" prop="auditType">

<el-input v-model.number="formData.auditType" :clearable="true" placeholder="请输入" />

</el-form-item>

<el-form-item label="sessionId字段:" prop="sessionId">

<el-input v-model.number="formData.sessionId" :clearable="true" placeholder="请输入" />

</el-form-item>

<el-form-item label="statementId字段:" prop="statementId">

<el-input v-model.number="formData.statementId" :clearable="true" placeholder="请输入" />

</el-form-item>

<el-form-item label="entryId字段:" prop="entryId">

<el-input v-model.number="formData.entryId" :clearable="true" placeholder="请输入" />

</el-form-item>

<el-form-item label="extendedTimestamp字段:" prop="extendedTimestamp">

<el-input v-model="formData.extendedTimestamp" :clearable="true" placeholder="请输入" />

</el-form-item>

<el-form-item label="dbUser字段:" prop="dbUser">

<el-input v-model="formData.dbUser" :clearable="true" placeholder="请输入" />

</el-form-item>

<el-form-item label="osUser字段:" prop="osUser">

<el-input v-model="formData.osUser" :clearable="true" placeholder="请输入" />

</el-form-item>

<el-form-item label="userHost字段:" prop="userHost">

<el-input v-model="formData.userHost" :clearable="true" placeholder="请输入" />

</el-form-item>

<el-form-item label="osProcess字段:" prop="osProcess">

<el-input v-model.number="formData.osProcess" :clearable="true" placeholder="请输入" />

</el-form-item>

<el-form-item label="terminal字段:" prop="terminal">

<el-input v-model="formData.terminal" :clearable="true" placeholder="请输入" />

</el-form-item>

<el-form-item label="instanceNumber字段:" prop="instanceNumber">

<el-input v-model.number="formData.instanceNumber" :clearable="true" placeholder="请输入" />

</el-form-item>

<el-form-item label="objectSchema字段:" prop="objectSchema">

<el-input v-model="formData.objectSchema" :clearable="true" placeholder="请输入" />

</el-form-item>

<el-form-item label="objectName字段:" prop="objectName">

<el-input v-model="formData.objectName" :clearable="true" placeholder="请输入" />

</el-form-item>

<el-form-item label="action字段:" prop="action">

<el-input v-model.number="formData.action" :clearable="true" placeholder="请输入" />

</el-form-item>

<el-form-item label="returnCode字段:" prop="returnCode">

<el-input v-model.number="formData.returnCode" :clearable="true" placeholder="请输入" />

</el-form-item>

<el-form-item label="scn字段:" prop="scn">

<el-input v-model.number="formData.scn" :clearable="true" placeholder="请输入" />

</el-form-item>

<el-form-item label="dbId字段:" prop="dbId">

<el-input v-model.number="formData.dbId" :clearable="true" placeholder="请输入" />

</el-form-item>

<el-form-item label="sqlBind字段:" prop="sqlBind">

<el-input v-model="formData.sqlBind" :clearable="true" placeholder="请输入" />

</el-form-item>

<el-form-item label="sqlText字段:" prop="sqlText">

<el-input v-model="formData.sqlText" :clearable="true" placeholder="请输入" />

</el-form-item>

<el-form-item label="阈值:" prop="rThreshold">

<el-input v-model.number="formData.rThreshold" :clearable="true" placeholder="请输入" />

</el-form-item>

<el-form-item label="模式:" prop="rPattern">

<el-input v-model="formData.rPattern" :clearable="true" placeholder="请输入" />

</el-form-item>

<el-form-item label="动作:" prop="rAction">

<el-input v-model="formData.rAction" :clearable="true" placeholder="请输入" />

</el-form-item>

<el-form-item label="描述:" prop="rDescription">

<el-input v-model="formData.rDescription" :clearable="true" placeholder="请输入" />

</el-form-item>

<el-form-item label="查询次数:" prop="querycount">

<el-input v-model.number="formData.querycount" :clearable="true" placeholder="请输入" />

</el-form-item>

<el-form-item>

<el-button type="primary" @click="save">保存</el-button>

<el-button type="primary" @click="back">返回</el-button>

</el-form-item>

</el-form>

</div>

</div>

</template>

  

<script setup>

import {

createAlarmse,

updateAlarmse,

findAlarmse

} from '@/api/alarmse'

  

defineOptions({

name: 'AlarmseForm'

})

  

// 自动获取字典

import { getDictFunc } from '@/utils/format'

import { useRoute, useRouter } from "vue-router"

import { ElMessage } from 'element-plus'

import { ref, reactive } from 'vue'

  

const route = useRoute()

const router = useRouter()

  

const type = ref('')

const formData = ref({

auditType: 0,

sessionId: 0,

statementId: 0,

entryId: 0,

extendedTimestamp: '',

dbUser: '',

osUser: '',

userHost: '',

osProcess: 0,

terminal: '',

instanceNumber: 0,

objectSchema: '',

objectName: '',

action: 0,

returnCode: 0,

scn: 0,

dbId: 0,

sqlBind: '',

sqlText: '',

rThreshold: 0,

rPattern: '',

rAction: '',

rDescription: '',

querycount: 0,

})

// 验证规则

const rule = reactive({

})

  

const elFormRef = ref()

  

// 初始化方法

const init = async () => {

// 建议通过url传参获取目标数据ID 调用 find方法进行查询数据操作 从而决定本页面是create还是update 以下为id作为url参数示例

if (route.query.id) {

const res = await findAlarmse({ ID: route.query.id })

if (res.code === 0) {

formData.value = res.data.realarmse

type.value = 'update'

}

} else {

type.value = 'create'

}

}

  

init()

// 保存按钮

const save = async() => {

elFormRef.value?.validate( async (valid) => {

if (!valid) return

let res

switch (type.value) {

case 'create':

res = await createAlarmse(formData.value)

break

case 'update':

res = await updateAlarmse(formData.value)

break

default:

res = await createAlarmse(formData.value)

break

}

if (res.code === 0) {

ElMessage({

type: 'success',

message: '创建/更改成功'

})

}

})

}

  

// 返回按钮

const back = () => {

router.go(-1)

}

  

</script>

  

<style>

</style>

### 1.10.3 error

index.vue

<template>

<div>

<div class="w-full h-screen bg-gray-50 flex items-center justify-center">

<div class="flex flex-col items-center text-2xl gap-4">

<img src="../../assets/notFound.png">

<p>页面被神秘力量吸走了（如果您是开源版请联系我们修复）</p>

<p style="font-size:18px;line-height:40px;">常见问题为当前此角色无当前路由，如果确定要使用本路由，请到角色管理进行分配</p>

<p>↓</p>

<el-button @click="toDashboard">返回首页</el-button>

</div>

</div>

</div>

</template>

  

<script setup>

import { useUserStore } from '@/pinia/modules/user'

import { useRouter } from 'vue-router'

  

defineOptions({

name: 'Error'

})

  

const userStore = useUserStore()

const router = useRouter()

const toDashboard = () => {

router.push({ name: userStore.userInfo.authority.defaultRouter })

}

</script>

  

reload.vue

<template>

<div />

</template>

  

<script setup>

import { useRouter } from 'vue-router'

  

defineOptions({

name: 'Reload'

})

  

const router = useRouter()

router.go(-1)

</script>

  

### 1.10.4 init/index.vue

<template>

<div class="rounded-lg flex items-center justify-evenly w-full h-full relative bg-white md:w-screen md:h-screen md:bg-[#194bfb] overflow-hidden">

<div class="rounded-md w-full h-full flex items-center justify-center overflow-hidden">

<div class="oblique h-[130%] w-3/5 bg-white transform -rotate-12 absolute -ml-80" />

<div

v-if="!page.showForm"

:class="[page.showReadme ?'slide-out-right' :'slide-in-fwd-top' ]"

>

<div class=" text-lg">

<div class="z-[999] pt-12 pb-10 md:w-96 w-full rounded-lg flex flex-col justify-between box-border">

<div class="font-sans text-2xl font-bold text-center mb-4">数字政府复杂信息化系统攻防研究平台数据库端防御系统</div>

</div>

<p class="text-gray-600 mb-2">初始化须知</p>

<p class="text-gray-600 mb-2">1.您需有用一定的VUE和GOLANG基础</p>

<p class="text-gray-600 mb-2">2.请您确认是否了解后续的配置流程</p>

<p class="text-gray-600 mb-2">3.如果您使用mysql数据库，请确认数据库引擎为<span class="text-red-600 font-bold text-3xl ml-2 ">innoDB</span></p>

<p class="flex items-center justify-between mt-8">

<el-button

type="primary"

size="large"

@click="showNext"

>

我已确认

</el-button> </p>

</div>

</div>

<div

v-if="page.showForm "

:class="[ page.showForm ? 'slide-in-left' : 'slide-out-right' ]"

class="w-96"

>

<el-form

ref="formRef"

:model="form"

label-width="100px"

size="large"

>

<el-form-item label="数据库类型">

<el-select

v-model="form.dbType"

placeholder="请选择"

class="w-full"

@change="changeDB"

>

<el-option

key="mysql"

label="mysql"

value="mysql"

/>

<el-option

key="pgsql"

label="pgsql"

value="pgsql"

/>

<el-option

key="oracle"

label="oracle"

value="oracle"

/>

<el-option

key="mssql"

label="mssql"

value="mssql"

/>

<el-option

key="sqlite"

label="sqlite"

value="sqlite"

/>

</el-select>

</el-form-item>

<el-form-item

v-if="form.dbType !== 'sqlite'"

label="host"

>

<el-input

v-model="form.host"

placeholder="请输入数据库链接"

/>

</el-form-item>

<el-form-item

v-if="form.dbType !== 'sqlite'"

label="port"

>

<el-input

v-model="form.port"

placeholder="请输入数据库端口"

/>

</el-form-item>

<el-form-item

v-if="form.dbType !== 'sqlite'"

label="userName"

>

<el-input

v-model="form.userName"

placeholder="请输入数据库用户名"

/>

</el-form-item>

<el-form-item

v-if="form.dbType !== 'sqlite'"

label="password"

>

<el-input

v-model="form.password"

placeholder="请输入数据库密码（没有则为空）"

/>

</el-form-item>

<el-form-item label="dbName">

<el-input

v-model="form.dbName"

placeholder="请输入数据库名称"

/>

</el-form-item>

<el-form-item

v-if="form.dbType === 'sqlite'"

label="dbPath"

>

<el-input

v-model="form.dbPath"

placeholder="请输入sqlite数据库文件存放路径"

/>

</el-form-item>

<el-form-item>

<div style="text-align: right">

<el-button

type="primary"

@click="onSubmit"

>立即初始化</el-button>

</div>

</el-form-item>

</el-form>

</div>

</div>

  

  

</div>

</template>

  

<script setup>

// @ts-ignore

import { initDB } from '@/api/initdb'

import { reactive, ref } from 'vue'

import { ElLoading, ElMessage } from 'element-plus'

import { useRouter } from 'vue-router'

  

defineOptions({

name: 'Init',

})

  

const router = useRouter()

  

const page = reactive({

showReadme: false,

showForm: false

})

  

const showNext = () => {

page.showReadme = false

setTimeout(() => {

page.showForm = true

}, 20)

}

  

const out = ref(false)

  

const form = reactive({

dbType: 'mysql',

host: '127.0.0.1',

port: '3306',

userName: 'root',

password: '',

dbName: 'gva',

dbPath: ''

})

  

const changeDB = (val) => {

switch (val) {

case 'mysql':

Object.assign(form, {

dbType: 'mysql',

host: '127.0.0.1',

port: '3306',

userName: 'root',

password: '',

dbName: 'gva',

dbPath: ''

})

break

case 'pgsql':

Object.assign(form, {

dbType: 'pgsql',

host: '127.0.0.1',

port: '5432',

userName: 'postgres',

password: '',

dbName: 'gva',

dbPath: ''

})

break

case 'oracle':

Object.assign(form, {

dbType: 'oracle',

host: '127.0.0.1',

port: '1521',

userName: 'oracle',

password: '',

dbName: 'gva',

dbPath: ''

})

break

case 'mssql':

Object.assign(form, {

dbType: 'mssql',

host: '127.0.0.1',

port: '1433',

userName: 'mssql',

password: '',

dbName: 'gva',

dbPath: ''

})

break

case 'sqlite':

Object.assign(form, {

dbType: 'sqlite',

host: '',

port: '',

userName: '',

password: '',

dbName: 'gva',

dbPath: ''

})

break

default:

Object.assign(form, {

dbType: 'mysql',

host: '127.0.0.1',

port: '3306',

userName: 'root',

password: '',

dbName: 'gva',

dbPath: ''

})

}

}

const onSubmit = async() => {

const loading = ElLoading.service({

lock: true,

text: '正在初始化数据库，请稍候',

spinner: 'loading',

background: 'rgba(0, 0, 0, 0.7)',

})

try {

const res = await initDB(form)

if (res.code === 0) {

out.value = true

ElMessage({

type: 'success',

message: res.msg,

})

router.push({ name: 'Login' })

}

loading.close()

} catch (err) {

loading.close()

}

}

</script>

  

<style lang="scss" scoped>

  

.slide-in-fwd-top {

-webkit-animation: slide-in-fwd-top 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94)

both;

animation: slide-in-fwd-top 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94) both;

}

.slide-out-right {

-webkit-animation: slide-out-right 0.5s cubic-bezier(0.55, 0.085, 0.68, 0.53)

both;

animation: slide-out-right 0.5s cubic-bezier(0.55, 0.085, 0.68, 0.53) both;

}

.slide-in-left {

-webkit-animation: slide-in-left 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94)

both;

animation: slide-in-left 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) both;

}

@-webkit-keyframes slide-in-fwd-top {

0% {

transform: translateZ(-1400px) translateY(-800px);

opacity: 0;

}

100% {

transform: translateZ(0) translateY(0);

opacity: 1;

}

}

@keyframes slide-in-fwd-top {

0% {

transform: translateZ(-1400px) translateY(-800px);

opacity: 0;

}

100% {

transform: translateZ(0) translateY(0);

opacity: 1;

}

}

@-webkit-keyframes slide-out-right {

0% {

transform: translateX(0);

opacity: 1;

}

100% {

transform: translateX(1000px);

opacity: 0;

}

}

@keyframes slide-out-right {

0% {

transform: translateX(0);

opacity: 1;

}

100% {

transform: translateX(1000px);

opacity: 0;

}

}

@-webkit-keyframes slide-in-left {

0% {

transform: translateX(-1000px);

opacity: 0;

}

100% {

transform: translateX(0);

opacity: 1;

}

}

@keyframes slide-in-left {

0% {

transform: translateX(-1000px);

opacity: 0;

}

100% {

transform: translateX(0);

opacity: 1;

}

}

@media (max-width: 750px) {

.form {

width: 94vw !important;

padding: 0;

}

}

</style>

### 1.10.5 layout

layout├─ aside│ ├─ asideComponent│ │ ├─ asyncSubmenu.vue│ │ ├─ index.vue│ │ └─ menuItem.vue│ ├─ historyComponent│ │ └─ history.vue│ └─ index.vue├─ bottomInfo│ └─ bottomInfo.vue├─ screenfull│ └─ index.vue├─ search│ └─ search.vue├─ setting│ └─ index.vue└─ index.vue

aside├─ asideComponent│ ├─ asyncSubmenu.vue│ ├─ index.vue│ └─ menuItem.vue├─ historyComponent│ └─ history.vue└─ index.vue

asideComponent├─ asyncSubmenu.vue├─ index.vue└─ menuItem.vue

asyncSubmenu.vue

<template>

<el-sub-menu

ref="subMenu"

:index="routerInfo.name"

>   

  

<template #title>

<div

v-if="!isCollapse"

class="gva-subMenu"

>

<el-icon v-if="routerInfo.meta.icon">

<component :is="routerInfo.meta.icon" />

</el-icon>

<span>{{ routerInfo.meta.title }}</span>

</div>

<template v-else>

<el-icon v-if="routerInfo.meta.icon">

<component :is="routerInfo.meta.icon" />

</el-icon>

<span>{{ routerInfo.meta.title }}</span>

</template>

</template>

<slot />

</el-sub-menu>

</template>

  

<script setup>

import { ref, watch } from 'vue'

  

defineOptions({

name: 'AsyncSubmenu',

})

  

const props = defineProps({

routerInfo: {

default: function() {

return null

},

type: Object

},

isCollapse: {

default: function() {

return false

},

type: Boolean

},

theme: {

default: function() {

return {}

},

type: Object

}

})

  

const activeBackground = ref(props.theme.activeBackground)

const activeText = ref(props.theme.activeText)

const normalText = ref(props.theme.normalText)

// const hoverBackground = ref(props.theme.hoverBackground)

// const hoverText = ref(props.theme.hoverText)

  

watch(() => props.theme, () => {

activeBackground.value = props.theme.activeBackground

activeText.value = props.theme.activeText

normalText.value = props.theme.normalText

// hoverBackground.value = props.theme.hoverBackground

// hoverText.value = props.theme.hoverText

})

  

</script>

  

<style lang="scss" scoped>

.el-sub-menu{

::v-deep(.el-sub-menu__title){

padding: 6px;

color: v-bind(normalText);

}

}

  

.is-active:not(.is-opened){

::v-deep(.el-sub-menu__title) .gva-subMenu{

flex:1;

height: 100%;

line-height: 44px;

background: v-bind(activeBackground) !important;

border-radius: 4px;

box-shadow: 0 0 2px 1px v-bind(activeBackground) !important;

i{

color: v-bind(activeText);

}

span{

color: v-bind(activeText);

}

}

}

  

.gva-subMenu {

padding-left: 4px;

}

</style>

  

index.vue

<template>

<component

:is="menuComponent"

v-if="!routerInfo.hidden"

:is-collapse="isCollapse"

:theme="theme"

:router-info="routerInfo"

>   

<template v-if="routerInfo.children&&routerInfo.children.length">

<AsideComponent

v-for="item in routerInfo.children"

:key="item.name"

:is-collapse="false"

:router-info="item"

:theme="theme"

/>

</template>

</component>

</template>

  

  

<script setup>

import MenuItem from './menuItem.vue'

import AsyncSubmenu from './asyncSubmenu.vue'

import { computed } from 'vue'

  

defineOptions({

name: 'AsideComponent',

})

  

const props = defineProps({

routerInfo: {

type: Object,

default: () => null,

},

isCollapse: {

default: function() {

return false

},

type: Boolean

},

theme: {

default: function() {

return {}

},

type: Object

}

})

  

const menuComponent = computed(() => {

if (props.routerInfo.children && props.routerInfo.children.filter(item => !item.hidden).length) {

return AsyncSubmenu

} else {

return MenuItem

}

})

  

</script>

  

  

menuItem.vue

<template>

<el-menu-item :index="routerInfo.name">

<template v-if="isCollapse">

<el-tooltip

class="box-item"

effect="light"

:content="routerInfo.meta.title"

placement="right"

>

<el-icon v-if="routerInfo.meta.icon">

<component :is="routerInfo.meta.icon" />

</el-icon>

</el-tooltip>

</template>

<template v-else>

<div class="gva-menu-item">

<el-icon v-if="routerInfo.meta.icon">

<component :is="routerInfo.meta.icon" />

</el-icon>

<span class="gva-menu-item-title">{{ routerInfo.meta.title }}</span>

</div>

</template>

</el-menu-item>

</template>

  

  

<script setup>

import { ref, watch } from 'vue'

  

defineOptions({

name: 'MenuItem',

})

  

const props = defineProps({

routerInfo: {

default: function() {

return null

},

type: Object

},

isCollapse: {

default: function() {

return false

},

type: Boolean

},

theme: {

default: function() {

return {}

},

type: Object

}

})

  

const activeBackground = ref(props.theme.activeBackground)

const activeText = ref(props.theme.activeText)

const normalText = ref(props.theme.normalText)

const hoverBackground = ref(props.theme.hoverBackground)

const hoverText = ref(props.theme.hoverText)

  

watch(() => props.theme, () => {

activeBackground.value = props.theme.activeBackground

activeText.value = props.theme.activeText

normalText.value = props.theme.normalText

hoverBackground.value = props.theme.hoverBackground

hoverText.value = props.theme.hoverText

})

  

</script>

  

<style lang="scss" scoped>

  

.gva-menu-item{

width: 100%;

flex:1;

height: 44px;

display: flex;

justify-content: flex-start;

align-items: center;

padding-left: 4px;

  

.gva-menu-item-title {

flex:1;

}

}

  

.el-menu--collapse{

.el-menu-item.is-active{

color: v-bind(activeBackground);

}

}

  

.el-menu-item{

color: v-bind(normalText);

}

  

.el-menu-item.is-active{

.gva-menu-item{

background: v-bind(activeBackground) !important;

border-radius: 4px;

box-shadow: 0 0 2px 1px v-bind(activeBackground) !important;

i{

color: v-bind(activeText);

}

span{

color: v-bind(activeText);

}

}

}

  

.el-menu-item:hover{

.gva-menu-item{

background: v-bind(hoverBackground);

border-radius: 4px;

box-shadow: 0 0 2px 1px v-bind(hoverBackground);

color: v-bind(hoverText);

}

}

  

</style>

  

historyComponent└─ history.vue

<template>

<div class="router-history">

<el-tabs

v-model="activeValue"

:closable="!(historys.length === 1 && $route.name === defaultRouter)" type="card" @contextmenu.prevent="openContextMenu($event)"

@tab-click="changeTab"

@tab-remove="removeTab"

>

<el-tab-pane

v-for="item in historys"

:key="name(item)"

:label="item.meta.title"

:name="name(item)"

:tab="item"

class="gva-tab"

>

<template #label>

<span

:tab="item"

:style="{

color: activeValue === name(item) ? userStore.activeColor : '#333',

}"

><i

class="dot"

:style="{

backgroundColor:

activeValue === name(item) ? userStore.activeColor : '#ddd',

}"

/>

{{ fmtTitle(item.meta.title,item) }}</span>

</template>

</el-tab-pane>

</el-tabs>

  

<!--自定义右键菜单html代码-->

<ul

v-show="contextMenuVisible"

:style="{ left: left + 'px', top: top + 'px' }"

class="contextmenu"

>

<li @click="closeAll">关闭所有</li>

<li @click="closeLeft">关闭左侧</li>

<li @click="closeRight">关闭右侧</li>

<li @click="closeOther">关闭其他</li>

</ul>

</div>

</template>

  

  

<script setup>

import { emitter } from '@/utils/bus.js'

import { computed, onUnmounted, ref, watch } from 'vue'

import { useRoute, useRouter } from 'vue-router'

import { useUserStore } from '@/pinia/modules/user'

import { fmtTitle } from '@/utils/fmtRouterTitle'

  

defineOptions({

name: 'HistoryComponent',

})

  

const route = useRoute()

const router = useRouter()

  

const getFmtString = (item) => {

return item.name + JSON.stringify(item.query) + JSON.stringify(item.params)

}

  

const historys = ref([])

const activeValue = ref('')

const contextMenuVisible = ref(false)

  

const userStore = useUserStore()

  

const name = (item) => {

return (

item.name + JSON.stringify(item.query) + JSON.stringify(item.params)

)

}

  

const left = ref(0)

const top = ref(0)

const isCollapse = ref(false)

const isMobile = ref(false)

const rightActive = ref('')

const defaultRouter = computed(() => userStore.userInfo.authority.defaultRouter)

const openContextMenu = (e) => {

if (

historys.value.length === 1 &&

route.name === defaultRouter.value

) {

return false

}

let id = ''

if (e.srcElement.nodeName === 'SPAN') {

id = e.srcElement.offsetParent.id

} else {

id = e.srcElement.id

}

if (id) {

contextMenuVisible.value = true

let width

if (isCollapse.value) {

width = 54

} else {

width = 220

}

if (isMobile.value) {

width = 0

}

left.value = e.clientX - width

top.value = e.clientY + 10

rightActive.value = id.substring(4)

}

}

const closeAll = () => {

historys.value = [

{

name: defaultRouter.value,

meta: {

title: '首页',

},

query: {},

params: {},

},

]

router.push({ name: defaultRouter.value })

contextMenuVisible.value = false

sessionStorage.setItem('historys', JSON.stringify(historys.value))

}

const closeLeft = () => {

let right

const rightIndex = historys.value.findIndex((item) => {

if (getFmtString(item) === rightActive.value) {

right = item

}

return getFmtString(item) === rightActive.value

})

const activeIndex = historys.value.findIndex(

(item) => getFmtString(item) === activeValue.value

)

historys.value.splice(0, rightIndex)

if (rightIndex > activeIndex) {

router.push(right)

}

sessionStorage.setItem('historys', JSON.stringify(historys.value))

}

const closeRight = () => {

let right

const leftIndex = historys.value.findIndex((item) => {

if (getFmtString(item) === rightActive.value) {

right = item

}

return getFmtString(item) === rightActive.value

})

const activeIndex = historys.value.findIndex(

(item) => getFmtString(item) === activeValue.value

)

historys.value.splice(leftIndex + 1, historys.value.length)

if (leftIndex < activeIndex) {

router.push(right)

}

sessionStorage.setItem('historys', JSON.stringify(historys.value))

}

const closeOther = () => {

let right

historys.value = historys.value.filter((item) => {

if (getFmtString(item) === rightActive.value) {

right = item

}

return getFmtString(item) === rightActive.value

})

router.push(right)

sessionStorage.setItem('historys', JSON.stringify(historys.value))

}

const isSame = (route1, route2) => {

if (route1.name !== route2.name) {

return false

}

if (Object.keys(route1.query).length !== Object.keys(route2.query).length || Object.keys(route1.params).length !== Object.keys(route2.params).length) {

return false

}

for (const key in route1.query) {

if (route1.query[key] !== route2.query[key]) {

return false

}

}

for (const key in route1.params) {

if (route1.params[key] !== route2.params[key]) {

return false

}

}

return true

}

const setTab = (route) => {

if (!historys.value.some((item) => isSame(item, route))) {

const obj = {}

obj.name = route.name

obj.meta = { ...route.meta }

delete obj.meta.matched

obj.query = route.query

obj.params = route.params

historys.value.push(obj)

}

window.sessionStorage.setItem('activeValue', getFmtString(route))

}

  

const historyMap = ref({})

  

const changeTab = (TabsPaneContext) => {

const name = TabsPaneContext?.props?.name

if (!name) return

const tab = historyMap.value[name]

router.push({

name: tab.name,

query: tab.query,

params: tab.params,

})

}

const removeTab = (tab) => {

const index = historys.value.findIndex(

(item) => getFmtString(item) === tab

)

if (getFmtString(route) === tab) {

if (historys.value.length === 1) {

router.push({ name: defaultRouter.value })

} else {

if (index < historys.value.length - 1) {

router.push({

name: historys.value[index + 1].name,

query: historys.value[index + 1].query,

params: historys.value[index + 1].params,

})

} else {

router.push({

name: historys.value[index - 1].name,

query: historys.value[index - 1].query,

params: historys.value[index - 1].params,

})

}

}

}

historys.value.splice(index, 1)

}

  

watch(() => contextMenuVisible.value, () => {

if (contextMenuVisible.value) {

document.body.addEventListener('click', () => {

contextMenuVisible.value = false

})

} else {

document.body.removeEventListener('click', () => {

contextMenuVisible.value = false

})

}

})

  

watch(() => route, (to, now) => {

if (to.name === 'Login' || to.name === 'Reload') {

return

}

historys.value = historys.value.filter((item) => !item.meta.closeTab)

setTab(to)

sessionStorage.setItem('historys', JSON.stringify(historys.value))

activeValue.value = window.sessionStorage.getItem('activeValue')

}, { deep: true })

  

watch(() => historys.value, () => {

sessionStorage.setItem('historys', JSON.stringify(historys.value))

historyMap.value = {}

historys.value.forEach((item) => {

historyMap.value[getFmtString(item)] = item

})

emitter.emit('setKeepAlive', historys.value)

}, {

deep: true

})

  

const initPage = () => {

// 全局监听 关闭当前页面函数

emitter.on('closeThisPage', () => {

removeTab(name(route))

})

// 全局监听 关闭所有页面函数

emitter.on('closeAllPage', () => {

closeAll()

})

emitter.on('mobile', (data) => {

isMobile.value = data

})

emitter.on('collapse', (data) => {

isCollapse.value = data

})

const initHistorys = [

{

name: defaultRouter.value,

meta: {

title: '首页',

},

query: {},

params: {},

},

]

historys.value =

JSON.parse(sessionStorage.getItem('historys')) || initHistorys

if (!window.sessionStorage.getItem('activeValue')) {

activeValue.value = getFmtString(route)

} else {

activeValue.value = window.sessionStorage.getItem('activeValue')

}

setTab(route)

if (window.sessionStorage.getItem('needCloseAll') === 'true') {

closeAll()

window.sessionStorage.removeItem('needCloseAll')

}

}

initPage()

  

onUnmounted(() => {

emitter.off('collapse')

emitter.off('mobile')

})

</script>

  

<style lang="scss">

.contextmenu {

width: 100px;

margin: 0;

border: 1px solid #ccc;

background: #fff;

z-index: 3000;

position: absolute;

list-style-type: none;

padding: 5px 0;

border-radius: 4px;

font-size: 14px;

color: #333;

box-shadow: 2px 2px 3px 0 rgba(0, 0, 0, 0.2);

}

.el-tabs__item .el-icon-close {

color: initial !important;

}

.el-tabs__item .dot {

content: "";

width: 9px;

height: 9px;

margin-right: 8px;

display: inline-block;

border-radius: 50%;

transition: background-color 0.2s;

}

  

.contextmenu li {

margin: 0;

padding: 7px 16px;

}

.contextmenu li:hover {

background: #f2f2f2;

cursor: pointer;

}

</style>

  

index.vue

<template>

<div :style="{ background: userStore.sideMode }">

<el-scrollbar style="height: calc(100vh - 60px)">

<transition

:duration="{ enter: 800, leave: 100 }"

mode="out-in"

name="el-fade-in-linear"

>

<el-menu

:collapse="isCollapse"

:collapse-transition="false"

:default-active="active"

:background-color="theme.background"

:active-text-color="theme.active"

class="el-menu-vertical"

unique-opened

@select="selectMenuItem"

>

<template v-for="item in routerStore.asyncRouters[0].children">

<aside-component

v-if="!item.hidden"

:key="item.name"

:is-collapse="isCollapse"

:router-info="item"

:theme="theme"

/>

</template>

</el-menu>

</transition>

</el-scrollbar>

</div>

</template>

  

<script setup>

import AsideComponent from '@/view/layout/aside/asideComponent/index.vue'

import { emitter } from '@/utils/bus.js'

import { ref, watch, onUnmounted } from 'vue'

import { useRoute, useRouter } from 'vue-router'

import { useUserStore } from '@/pinia/modules/user'

import { useRouterStore } from '@/pinia/modules/router'

  

defineOptions({

name: 'Aside',

})

  

const route = useRoute()

const router = useRouter()

  

const userStore = useUserStore()

const routerStore = useRouterStore()

  

const theme = ref({})

  

const getTheme = () => {

switch (userStore.sideMode) {

case '#fff':

theme.value = {

background: '#fff',

activeBackground: 'var(--el-color-primary)',

activeText: '#fff',

normalText: '#333',

hoverBackground: 'rgba(64, 158, 255, 0.08)',

hoverText: '#333',

}

break

case '#191a23':

theme.value = {

background: '#191a23',

activeBackground: 'var(--el-color-primary)',

activeText: '#fff',

normalText: '#fff',

hoverBackground: 'rgba(64, 158, 255, 0.08)',

hoverText: '#fff',

}

break

}

}

  

getTheme()

  

const active = ref('')

watch(() => route, () => {

active.value = route.meta.activeName || route.name

}, { deep: true })

  

watch(() => userStore.sideMode, () => {

getTheme()

})

  

const isCollapse = ref(false)

const initPage = () => {

active.value = route.meta.activeName || route.name

const screenWidth = document.body.clientWidth

if (screenWidth < 1000) {

isCollapse.value = !isCollapse.value

}

  

emitter.on('collapse', (item) => {

isCollapse.value = item

})

}

  

initPage()

  

onUnmounted(() => {

emitter.off('collapse')

})

  

const selectMenuItem = (index, _, ele, aaa) => {

const query = {}

const params = {}

routerStore.routeMap[index]?.parameters &&

routerStore.routeMap[index]?.parameters.forEach((item) => {

if (item.type === 'query') {

query[item.key] = item.value

} else {

params[item.key] = item.value

}

})

if (index === route.name) return

if (index.indexOf('http://') > -1 || index.indexOf('https://') > -1) {

window.open(index)

} else {

router.push({ name: index, query, params })

}

}

</script>

  

<style lang="scss">

  

.el-sub-menu__title:hover,

.el-menu-item:hover {

background: transparent;

}

  

.el-scrollbar {

.el-scrollbar__view {

height: 100%;

}

}

.menu-info {

.menu-contorl {

line-height: 52px;

font-size: 20px;

display: table-cell;

vertical-align: middle;

}

}

</style>

  

bottomInfo/bottomInfo.vue

<template>

<div class="flex gap-4 items-center text-sm text-gray-500 justify-center mb-4">

<span>Powered by</span>

<span>

<a

class="text-gray-800 font-bold"

>SECURITY PRIDE - HUST</a>

</span>

<slot />

</div>

</template>

  

<script setup>

defineOptions({

name: 'BottomInfo'

})

  

console.log(

`%c powered by %c flipped-aurorae %c`,

'background:#0081ff; padding: 1px; border-radius: 3px 0 0 3px; color: #fff',

'background:#354855; padding: 1px 5px; border-radius: 0 3px 3px 0; color: #fff; font-weight: bold;',

'background:transparent'

)

</script>

  

screenfull/index.vue

<template>

<div @click="clickFull">

<div

v-if="isShow"

class="gvaIcon gvaIcon-fullscreen-expand"

/>

<div

v-else

class="gvaIcon gvaIcon-fullscreen-shrink"

/>

</div>

</template>

  

<script setup>

import screenfull from 'screenfull' // 引入screenfull

import { onMounted, onUnmounted, ref } from 'vue'

  

defineOptions({

name: 'Screenfull',

})

  

defineProps({

width: {

type: Number,

default: 22

},

height: {

type: Number,

default: 22

},

fill: {

type: String,

default: '#48576a'

}

})

  

onMounted(() => {

if (screenfull.isEnabled) {

screenfull.on('change', changeFullShow)

}

})

  

onUnmounted(() => {

screenfull.off('change')

})

  

const clickFull = () => {

if (screenfull.isEnabled) {

screenfull.toggle()

}

}

  

const isShow = ref(true)

const changeFullShow = () => {

isShow.value = !screenfull.isFullscreen

}

  

</script>

  

<style scoped lang="scss">

.screenfull-svg {

width: 16px;

height: 16px;

cursor: pointer;

vertical-align: middle;

margin-right: 32px;

fill: rgba(0, 0, 0, 0.45);

}

</style>

  

search/search.vue

<template>

<div class="search-component">

<div

class="gvaIcon gvaIcon-refresh"

:class="[reload ? 'reloading' : '']"

@click="handleReload"

/>

<Screenfull class="search-icon" />

<!-- <div

class="gvaIcon gvaIcon-customer-service"

@click="toService"

/> -->

</div>

</template>

  

<script setup>

import Screenfull from '@/view/layout/screenfull/index.vue'

import { emitter } from '@/utils/bus.js'

import { ref } from 'vue'

  

defineOptions({

name: 'BtnBox',

})

  

const reload = ref(false)

const handleReload = () => {

reload.value = true

emitter.emit('reload')

setTimeout(() => {

reload.value = false

}, 500)

}

const toService = () => {

window.open('')

}

  

</script>

<style scoped lang="scss">

  

.search-component {

@apply inline-flex overflow-hidden text-center gap-5 mr-5;

div{

@apply cursor-pointer;

}

.el-input__inner {

@apply border-b border-solid border-gray-300;

}

.el-dropdown-link {

@apply cursor-pointer;

}

}

  

.reload {

font-size: 18px;

}

  

.reloading{

animation:turn 0.5s linear infinite;

}

  

@keyframes turn {

0% {

transform: rotate(0deg);

}

  

25% {

transform: rotate(90deg);

}

  

50% {

transform: rotate(180deg);

}

  

75% {

transform: rotate(270deg);

}

  

100% {

transform: rotate(360deg);

}

}

  

</style>

  

setting/index.uve

<template>

<div>

<el-button

type="primary"

class="drawer-container"

icon="setting"

@click="showSettingDrawer"

/>

<el-drawer

v-model="drawer"

title="系统配置"

:direction="direction"

:before-close="handleClose"

>

<div class="setting_body">

<div class="setting_card">

<div class="setting_content">

<div class="theme-box">

<div

class="item"

@click="changeMode('light')"

>

<div class="item-top">

<el-icon

v-if="userStore.mode === 'light'"

class="check"

>

<check />

</el-icon>

<img src="https://gw.alipayobjects.com/zos/antfincdn/NQ%24zoisaD2/jpRkZQMyYRryryPNtyIC.svg">

</div>

<p>

简约白

</p>

</div>

<div

class="item"

@click="changeMode('dark')"

>

<div class="item-top">

<el-icon

v-if="userStore.mode === 'dark'"

class="check"

>

<check />

</el-icon>

<img src="https://gw.alipayobjects.com/zos/antfincdn/XwFOFbLkSM/LCkqqYNmvBEbokSDscrm.svg">

</div>

<p>

商务黑

</p>

</div>

</div>

</div>

</div>

</div>

</el-drawer>

  

</div>

</template>

  

<script setup>

import { ref } from 'vue'

import { useUserStore } from '@/pinia/modules/user'

  

defineOptions({

name: 'Setting',

})

  

const drawer = ref(false)

const direction = ref('rtl')

  

const userStore = useUserStore()

  

const handleClose = () => {

drawer.value = false

}

const showSettingDrawer = () => {

drawer.value = true

}

const changeMode = (e) => {

if (e === null) {

userStore.changeSideMode('dark')

return

}

userStore.changeSideMode(e)

}

  

</script>

  

<style lang="scss" scoped>

.drawer-container {

transition: all 0.2s;

&:hover{

right: 0

}

position: fixed;

right: -20px;

bottom: 15%;

height: 40px;

width: 40px;

display: flex;

align-items: center;

justify-content: center;

z-index: 999;

color: #fff;

border-radius: 4px 0 0 4px;

cursor: pointer;

-webkit-box-shadow: inset 0 0 6px rgba(0 ,0 ,0, 10%);

}

.setting_body{

padding: 20px;

.setting_card{

margin-bottom: 20px;

}

.setting_content{

margin-top: 20px;

display: flex;

flex-direction: column;

>.theme-box{

display: flex;

}

>.color-box{

div{

display: flex;

flex-direction: column;

}

}

.item{

display: flex;

align-items: center;

justify-content: center;

flex-direction: column;

margin-right: 20px;

.item-top{

position: relative;

}

.check{

position: absolute;

font-size: 20px;

color: #00afff;

right:10px;

bottom: 10px;

}

p{

text-align: center;

font-size: 12px;

}

}

}

}

  

</style>

  

index.vue

<template>

<el-container class="layout-cont">

<el-container :class="[isSider?'openside':'hideside',isMobile ? 'mobile': '']">

<el-row

:class="[isShadowBg && isMobile?'bg-black opacity-30 w-full h-full absolute top-0 left-0 z-[1001]':'']"

@click="changeShadow()"

/>

<el-aside

class="main-cont gva-aside"

:style="{width:asideWidth()}"

>

<div

class="min-h-[60px] text-center transition-all duration-300 flex items-center justify-center gap-2"

:style="{background: backgroundColor}"

>

<!-- <img

alt

class="w-9 h-9 p-1 bg-white rounded-full"

:src="$GIN_VUE_ADMIN.appLogo" > <div v-if="isSider" class="inline-flex font-bold text-2xl" :style="{color:textColor}" >{{ $GIN_VUE_ADMIN.appName }}</div> -->

</div>

<Aside class="aside" />

</el-aside>

<!-- 分块滑动功能 -->

<el-main class="main-cont main-right">

<transition

:duration="{ enter: 800, leave: 100 }"

mode="out-in"

name="el-fade-in-linear"

>

<div

:style="{width: `calc(100% - ${getAsideWidth()})`}"

class="fixed top-0 box-border z-50"

>

<el-row>

<el-col>

<el-header class="header-cont">

<el-row class="p-0 h-full">

<el-col

:xs="2"

:lg="1"

:md="1"

:sm="1"

:xl="1"

class="z-50 flex items-center pl-3"

>

<div

class="text-black cursor-pointer text-lg leading-5"

@click="totalCollapse"

>

<div

v-if="isCollapse"

class="gvaIcon gvaIcon-arrow-double-right"

/>

<div

v-else

class="gvaIcon gvaIcon-arrow-double-left"

/>

</div>

</el-col>

<el-col

:xs="10"

:lg="14"

:md="14"

:sm="9"

:xl="14"

:pull="1"

class="flex items-center"

>

<!-- 修改为手机端不显示顶部标签 -->

<el-breadcrumb

v-show="!isMobile"

class="breadcrumb"

>

<el-breadcrumb-item

v-for="item in matched.slice(1,matched.length)"

:key="item.path"

>{{ fmtTitle(item.meta.title,route) }}</el-breadcrumb-item>

</el-breadcrumb>

</el-col>

<el-col

:xs="12"

:lg="9"

:md="9"

:sm="14"

:xl="9"

class="flex items-center justify-end"

>

<div class="mr-1.5 flex items-center">

<Search />

<el-dropdown>

<div class="flex justify-center items-center h-full w-full">

<span class="cursor-pointer flex justify-center items-center">

<CustomPic />

<span

v-show="!isMobile"

style="margin-left: 5px"

>{{ userStore.userInfo.nickName }}</span>

<el-icon>

<arrow-down />

</el-icon>

</span>

</div>

<template #dropdown>

<el-dropdown-menu>

<el-dropdown-item>

<span class="font-bold">

当前角色：{{ userStore.userInfo.authority.authorityName }}

</span>

</el-dropdown-item>

<template v-if="userStore.userInfo.authorities">

<!--el-dropdown-item

v-for="item in userStore.userInfo.authorities.filter(i=>i.authorityId!==userStore.userInfo.authorityId)"

:key="item.authorityId"

@click="changeUserAuth(item.authorityId)"

>

<span>

切换为：{{ item.authorityName }}

</span>

</el-dropdown-item> -->

</template>

<!-- <el-dropdown-item icon="avatar">

<div

class="command-box"

style="display: flex"

@click="handleCommand"

>

<div>指令菜单</div>

<div style="margin-left: 8px">

<span class="button">{{ first }}</span>

+

<span class="button">K</span>

</div>

</div>

</el-dropdown-item> -->

<el-dropdown-item

icon="avatar"

@click="toPerson"

>个人信息</el-dropdown-item>

<el-dropdown-item

icon="reading-lamp"

@click="userStore.LoginOut"

>登 出</el-dropdown-item>

</el-dropdown-menu>

</template>

</el-dropdown>

</div>

</el-col>

</el-row>

</el-header>

</el-col>

</el-row>

<!-- 当前面包屑用路由自动生成可根据需求修改 -->

<!--

:to="{ path: item.path }" 暂时注释不用-->

<HistoryComponent ref="layoutHistoryComponent" />

</div>

</transition>

<router-view

v-if="reloadFlag"

v-slot="{ Component }"

class="admin-box"

>

<div

v-loading="loadingFlag"

element-loading-text="正在加载中"

>

<transition

mode="out-in"

name="el-fade-in-linear"

>

<keep-alive :include="routerStore.keepAliveRouters">

<component :is="Component" />

</keep-alive>

</transition>

</div>

</router-view>

<BottomInfo />

<setting />

<CommandMenu ref="command" />

</el-main>

</el-container>

  

</el-container>

</template>

  

<script setup>

import Aside from '@/view/layout/aside/index.vue'

import HistoryComponent from '@/view/layout/aside/historyComponent/history.vue'

import Search from '@/view/layout/search/search.vue'

import BottomInfo from '@/view/layout/bottomInfo/bottomInfo.vue'

import CustomPic from '@/components/customPic/index.vue'

import CommandMenu from '@/components/commandMenu/index.vue'

import Setting from './setting/index.vue'

import { setUserAuthority } from '@/api/user'

import { emitter } from '@/utils/bus.js'

import { computed, ref, onMounted, nextTick } from 'vue'

import { useRouter, useRoute } from 'vue-router'

import { useRouterStore } from '@/pinia/modules/router'

import { fmtTitle } from '@/utils/fmtRouterTitle'

import { useUserStore } from '@/pinia/modules/user'

  

defineOptions({

name: 'Layout',

})

  

const router = useRouter()

const route = useRoute()

const routerStore = useRouterStore()

// 三种窗口适配

const isCollapse = ref(false)

const isSider = ref(true)

const isMobile = ref(false)

  

const first = ref('')

const dialogVisible = ref(false)

const initPage = () => {

// 判断当前用户的操作系统

if (window.localStorage.getItem('osType') === 'WIN') {

first.value = 'Ctrl'

} else {

first.value = '⌘'

}

// 当用户同时按下ctrl和k键的时候

const handleKeyDown = (e) => {

if (e.ctrlKey && e.key === 'k') {

// 阻止浏览器默认事件

e.preventDefault()

handleCommand()

}

}

window.addEventListener('keydown', handleKeyDown)

  

const screenWidth = document.body.clientWidth

if (screenWidth < 1000) {

isMobile.value = true

isSider.value = false

isCollapse.value = true

} else if (screenWidth >= 1000 && screenWidth < 1200) {

isMobile.value = false

isSider.value = false

isCollapse.value = true

} else {

isMobile.value = false

isSider.value = true

isCollapse.value = false

}

}

  

initPage()

  

const command = ref()

const handleCommand = () => {

command.value.open()

}

  

const loadingFlag = ref(false)

onMounted(() => {

// 挂载一些通用的事件

emitter.emit('collapse', isCollapse.value)

emitter.emit('mobile', isMobile.value)

emitter.on('reload', reload)

emitter.on('showLoading', () => {

loadingFlag.value = true

})

emitter.on('closeLoading', () => {

loadingFlag.value = false

})

window.onresize = () => {

return (() => {

initPage()

emitter.emit('collapse', isCollapse.value)

emitter.emit('mobile', isMobile.value)

})()

}

if (userStore.loadingInstance) {

userStore.loadingInstance.close()

}

})

  

const userStore = useUserStore()

  

const asideWidth = () => {

if (isMobile.value) {

return isCollapse.value ? '0px' : '220px'

}

return isCollapse.value ? '54px' : '220px'

}

  

const getAsideWidth = () => {

if (isMobile.value) return '0px'

return isCollapse.value ? '54px' : '220px'

}

  

const textColor = computed(() => {

if (userStore.sideMode === 'dark') {

return '#fff'

} else if (userStore.sideMode === 'light') {

return '#191a23'

} else {

return userStore.baseColor

}

})

  

const backgroundColor = computed(() => {

if (userStore.sideMode === 'dark') {

return '#191a23'

} else if (userStore.sideMode === 'light') {

return '#fff'

} else {

return userStore.sideMode

}

})

  

const matched = computed(() => route.meta.matched)

  

const changeUserAuth = async(id) => {

const res = await setUserAuthority({

authorityId: id

})

if (res.code === 0) {

window.sessionStorage.setItem('needCloseAll', 'true')

window.location.reload()

}

}

  

const reloadFlag = ref(true)

let reloadTimer = null

const reload = async() => {

if (reloadTimer) {

window.clearTimeout(reloadTimer)

}

reloadTimer = window.setTimeout(async() => {

if (route.meta.keepAlive) {

reloadFlag.value = false

await nextTick()

reloadFlag.value = true

} else {

const title = route.meta.title

router.push({ name: 'Reload', params: { title }})

}

}, 400)

}

  

const isShadowBg = ref(false)

const totalCollapse = () => {

isCollapse.value = !isCollapse.value

isSider.value = !isCollapse.value

isShadowBg.value = !isCollapse.value

emitter.emit('collapse', isCollapse.value)

}

  

const toPerson = () => {

router.push({ name: 'person' })

}

const changeShadow = () => {

isShadowBg.value = !isShadowBg.value

isSider.value = !!isCollapse.value

totalCollapse()

}

</script>

  

<style lang="scss">

.button {

font-size: 12px;

color: #666;

background: rgb(250,250,250);

width: 25px!important;

padding: 4px 8px !important;

border: 1px solid #eaeaea;

margin-right: 4px;

border-radius: 4px;

}

:deep .el-overlay {

background-color: hsla(0,0%,100%,.9) !important;

}

  

</style>

### 1.10.6 login

index.vue

<template>

<div

id="userLayout"

class="w-full h-full relative"

>   

<div

class="rounded-lg flex items-center justify-evenly w-full h-full bg-white md:w-screen md:h-screen md:bg-[#194bfb]"

>

<div class="md:w-3/5 w-10/12 h-full flex items-center justify-evenly">

<div class="oblique h-[130%] w-3/5 bg-white transform -rotate-12 absolute -ml-52" />

<!-- 分割斜块 -->

<div class="z-[999] pt-12 pb-10 md:w-96 w-full rounded-lg flex flex-col justify-between box-border">

<div>

<div class="flex items-center justify-center">

<img

class="w-24"

:src="$GIN_VUE_ADMIN.appLogo" alt > </div> <div class="font-sans text-2xl font-bold text-center mb-4">数字政府复杂信息化系统攻防研究平台数据库端防御系统 </div> <!--div class="mb-9"> <p class="text-center text-4xl font-bold">{{ $GIN_VUE_ADMIN.appName }}</p>

<p class="text-center text-2xl font-normal text-gray-500 mt-2.5">数字政府复杂信息化系统攻防研究平台数据库端防御系统

</p>

</div> -->

<el-form

ref="loginForm"

:model="loginFormData"

:rules="rules"

:validate-on-rule-change="false"

@keyup.enter="submitForm"

>

<el-form-item

prop="username"

class="mb-6"

>

<el-input

v-model="loginFormData.username"

size="large"

placeholder="请输入用户名"

suffix-icon="user"

/>

</el-form-item>

<el-form-item

prop="password"

class="mb-6"

>

<el-input

v-model="loginFormData.password"

show-password

size="large"

type="password"

placeholder="请输入密码"

/>

</el-form-item>

<el-form-item

v-if="loginFormData.openCaptcha"

prop="captcha"

class="mb-6"

>

<div class="flex w-full justify-between">

<el-input

v-model="loginFormData.captcha"

placeholder="请输入验证码"

size="large"

class="flex-1 mr-5"

/>

<div class="w-1/3 h-11 bg-[#c3d4f2] rounded">

<img

v-if="picPath"

class="w-full h-full"

:src="picPath"

alt="请输入验证码"

@click="loginVerify()"

>

</div>

</div>

</el-form-item>

<el-form-item class="mb-6">

<el-button

class="shadow shadow-blue-600 h-11 w-full"

type="primary"

size="large"

@click="submitForm"

>登 录</el-button>

</el-form-item>

<el-form-item class="mb-6">

<el-button

class="shadow shadow-blue-600 h-11 w-full"

type="primary"

size="large"

@click="checkInit"

>前往初始化</el-button>

  

</el-form-item>

</el-form>

</div>

</div>

</div>

<!-- <div class="hidden md:block w-1/2 h-full float-right bg-[#194bfb]"><img

class="h-full"

src="@/assets/login_right_banner.jpg"

alt="banner"

></div> -->

</div>

  

<!-- <BottomInfo class="left-0 right-0 absolute bottom-3 mx-auto w-full z-20">

<div class="links items-center justify-center gap-2 hidden md:flex">

<a

href="http://doc.henrongyi.top/"

target="_blank"

>

<img

src="@/assets/docs.png"

class="w-8 h-8"

alt="文档"

>

</a>

<a

href="https://support.qq.com/product/371961"

target="_blank"

>

<img

src="@/assets/kefu.png"

class="w-8 h-8"

alt="客服"

>

</a>

<a

href="https://github.com/flipped-aurora/gin-vue-admin"

target="_blank"

>

<img

src="@/assets/github.png"

class="w-8 h-8"

alt="github"

>

</a>

<a

href="https://space.bilibili.com/322210472"

target="_blank"

>

<img

src="@/assets/video.png"

class="w-8 h-8"

alt="视频站"

>

</a>

</div>

</BottomInfo> -->

</div>

</template>

  

<script setup>

import { captcha } from '@/api/user'

import { checkDB } from '@/api/initdb'

import BottomInfo from '@/view/layout/bottomInfo/bottomInfo.vue'

import { reactive, ref } from 'vue'

import { ElMessage } from 'element-plus'

import { useRouter } from 'vue-router'

import { useUserStore } from '@/pinia/modules/user'

  

defineOptions({

name: 'Login',

})

  

const router = useRouter()

// 验证函数

const checkUsername = (rule, value, callback) => {

if (value.length < 5) {

return callback(new Error('请输入正确的用户名'))

} else {

callback()

}

}

const checkPassword = (rule, value, callback) => {

if (value.length < 6) {

return callback(new Error('请输入正确的密码'))

} else {

callback()

}

}

  

// 获取验证码

const loginVerify = () => {

captcha({}).then(async(ele) => {

rules.captcha.push({

max: ele.data.captchaLength,

min: ele.data.captchaLength,

message: `请输入${ele.data.captchaLength}位验证码`,

trigger: 'blur',

})

picPath.value = ele.data.picPath

loginFormData.captchaId = ele.data.captchaId

loginFormData.openCaptcha = ele.data.openCaptcha

})

}

loginVerify()

  

// 登录相关操作

const loginForm = ref(null)

const picPath = ref('')

const loginFormData = reactive({

username: 'admin',

password: '123456',

captcha: '',

captchaId: '',

openCaptcha: false,

})

const rules = reactive({

username: [{ validator: checkUsername, trigger: 'blur' }],

password: [{ validator: checkPassword, trigger: 'blur' }],

captcha: [

{

message: '验证码格式不正确',

trigger: 'blur',

},

],

})

  

const userStore = useUserStore()

const login = async() => {

return await userStore.LoginIn(loginFormData)

}

const submitForm = () => {

loginForm.value.validate(async(v) => {

if (v) {

const flag = await login()

if (!flag) {

loginVerify()

}

} else {

ElMessage({

type: 'error',

message: '请正确填写登录信息',

showClose: true,

})

loginVerify()

return false

}

})

}

  

// 跳转初始化

const checkInit = async() => {

const res = await checkDB()

if (res.code === 0) {

if (res.data?.needInit) {

userStore.NeedInit()

router.push({ name: 'Init' })

} else {

ElMessage({

type: 'info',

message: '已配置数据库信息，无法初始化',

})

}

}

}

  

</script>

### 1.10.7 person

person.vue

<template>

<div>

<div class="grid grid-cols-12 w-full gap-2">

<div class="col-span-3 h-full">

<div class="w-full h-full bg-white px-4 py-8 rounded-lg shadow-lg box-border">

<div class="user-card px-6 text-center bg-white shrink-0">

<div class="flex justify-center">

<SelectImage

v-model="userStore.userInfo.headerImg"

file-type="image"

/>

</div>

<div class="py-6 text-center">

<p

v-if="!editFlag"

class="text-3xl flex justify-center items-center gap-4"

>

{{ userStore.userInfo.nickName }}

<el-icon

class="cursor-pointer text-sm"

color="#66b1ff"

@click="openEdit"

>

<edit />

</el-icon>

</p>

<p

v-if="editFlag"

class="flex justify-center items-center gap-4"

>

<el-input v-model="nickName" />

<el-icon

class="cursor-pointer"

color="#67c23a"

@click="enterEdit"

>

<check />

</el-icon>

<el-icon

class="cursor-pointer"

color="#f23c3c"

@click="closeEdit"

>

<close />

</el-icon>

</p>

<p class="text-gray-500 mt-2 text-md">这个家伙很懒，什么都没有留下</p>

</div>

<!-- <div class="w-full h-full text-left">

<ul class="inline-block h-full w-full">

<li class="info-list">

<el-icon>

<user />

</el-icon>

{{ userStore.userInfo.nickName }}

</li>

<el-tooltip

class="item"

effect="light"

content="北京反转极光科技有限公司-技术部-前端事业群"

placement="top"

>

<li class="info-list">

<el-icon>

<data-analysis />

</el-icon>

北京反转极光科技有限公司-技术部-前端事业群

</li>

</el-tooltip>

<li class="info-list">

<el-icon>

<video-camera />

</el-icon>

中国·北京市·朝阳区

</li>

<el-tooltip

class="item"

effect="light"

content="GoLang/JavaScript/Vue/Gorm"

placement="top"

>

<li class="info-list">

<el-icon>

<medal />

</el-icon>

GoLang/JavaScript/Vue/Gorm

</li>

</el-tooltip>

</ul>

</div> -->

</div>

</div>

</div>

<div class="col-span-9 ">

<div class="bg-white h-full px-4 py-8 rounded-lg shadow-lg box-border">

<el-tabs

v-model="activeName"

@tab-click="handleClick"

>

<el-tab-pane

label="账号绑定"

name="second"

>

<ul>

<li class="borderd">

<p class="pb-2.5 text-xl text-gray-600">密保手机</p>

<p class="pb-2.5 text-lg text-gray-400">

已绑定手机:{{ userStore.userInfo.phone }}

<a

href="javascript:void(0)"

class="float-right text-blue-400"

@click="changePhoneFlag = true"

>立即修改</a>

</p>

</li>

<li class="borderd pt-2.5">

<p class="pb-2.5 text-xl text-gray-600">密保邮箱</p>

<p class="pb-2.5 text-lg text-gray-400">

已绑定邮箱：{{ userStore.userInfo.email }}

<a

href="javascript:void(0)"

class="float-right text-blue-400"

@click="changeEmailFlag = true"

>立即修改</a>

</p>

</li>

<!-- <li class="borderd pt-2.5">

<p class="pb-2.5 text-xl text-gray-600">密保问题</p>

<p class="pb-2.5 text-lg text-gray-400">

未设置密保问题

<a

href="javascript:void(0)"

class="float-right text-blue-400"

>去设置</a>

</p>

</li> -->

<li class="borderd pt-2.5">

<p class="pb-2.5 text-xl text-gray-600">修改密码</p>

<p class="pb-2.5 text-lg text-gray-400">

修改个人密码

<a

href="javascript:void(0)"

class="float-right text-blue-400"

@click="showPassword = true"

>修改密码</a>

</p>

</li>

</ul>

</el-tab-pane>

</el-tabs>

</div>

</div>

</div>

  

<el-dialog

v-model="showPassword"

title="修改密码"

width="360px"

@close="clearPassword"

>

<el-form

ref="modifyPwdForm"

:model="pwdModify"

:rules="rules"

label-width="80px"

>

<el-form-item

:minlength="6"

label="原密码"

prop="password"

>

<el-input

v-model="pwdModify.password"

show-password

/>

</el-form-item>

<el-form-item

:minlength="6"

label="新密码"

prop="newPassword"

>

<el-input

v-model="pwdModify.newPassword"

show-password

/>

</el-form-item>

<el-form-item

:minlength="6"

label="确认密码"

prop="confirmPassword"

>

<el-input

v-model="pwdModify.confirmPassword"

show-password

/>

</el-form-item>

</el-form>

<template #footer>

<div class="dialog-footer">

<el-button

  

@click="showPassword = false"

>取 消</el-button>

<el-button

  

type="primary"

@click="savePassword"

>确 定</el-button>

</div>

</template>