# 背景
AIGC + 自动化渗透
目的：实现渗透测试，提高渗透测试的速度、效率、准确率，推动了网络安全大模型的任务调度和策略编排能力的提升，最终目标是增强网络安全的防护能力和洞察力。

渗透测试本质上是基于网络安全人员的经验和知识，利用各种工具和技术对目标系统进行安全评估。
而LLM以及langchain这类ai agent的出现，是我们可以利用大模型的能力，来具体实施一些事情。

经过验证，LLM在渗透测试中的应用是可行的，以下四点对最终效果有决定性影响：

1. 大模型的选择 只要参数大即可，无需过于关注模型是否针对特定领域进行过微调，特定领域的知识，用rag可以解决。
2. RAG 相当于脱离LLM的外挂知识库，只要私有知识库足够完善，其“经验”就会足够丰富。
3. 提示词 通过提示词模拟出各种角色，如黑客、安全研究员、安全工程师等，这样可以让LLM更好的理解我们的需求。
4. 外部工具 武器库越丰富肯定越好

**自动渗透测试是一种网络安全实践，它使用软件工具和脚本对组织的 IT 基础设施和应用程序进行模拟攻击。 这些工具模拟恶意行为者的行为，试图利用目标系统内的漏洞、错误配置和弱点。 自动渗透测试可以评估网络、Web 应用程序、移动应用程序和各种其他数字资产的安全性。**

# 研究意义
在此背景下，许多能够提高渗透测试效率和集成化的工具应运而生。红队成员常用的一些工具包括Cobalt Strike、Metasploit，以及指纹扫描工具Kscan等。此外，某些红队甚至拥有专门的渗透辅助平台。然而，目前大部分工具仍处于半自动化阶段，功能相对单一。

因此，人工渗透测试仍然具有较高的难度，对人员的技术水平和经验积累有着较高要求。渗透过程中涉及到的诸多选择，比如指纹识别、漏洞利用条件的判断、攻击载荷的选择等，都是经验积累的结果。然而，人工操作往往存在覆盖不完整、攻击效率低等问题，不同红队成员之间的经验也难以有效传递。许多时候，渗透测试还需要进行大量重复性检测工作，进一步增加了难度和挑战。通过引入更高水平的自动化与智能化工具，未来渗透测试的效率和覆盖率将进一步提升，减少对人工经验的依赖。

伴随人工智能等新技术的应用，网络武器进化的延续效应正在逐渐转变网络攻击的逻辑和手段， “攻防不对等”形势更为严峻。攻击技术越发先进智能，网络武器研发和利用提速，基于未知漏洞的攻击利用危害不断加深， 敏感数据泄露事件频频发生。网络武器智能化的现实让如今的防御手段显得无力招架，因此我们需要将新一代的智能攻击技术运用到漏洞检测工作当中， 使应用系统在面对真正的网络攻击前，就接受到高强度、高频次、智能化渗透测试，以提前发现并弥补应用脆弱点。

通过上述给出的资料和目前互联网关于渗透测试的现状，说明利用人工智能辅助渗透测试的研究意义，分为三点。
## 版本1
- **提高渗透测试的效率和覆盖率**：传统的渗透测试过程需要大量的人工操作，存在覆盖不完整和效率低下的问题。人工智能可以自动化识别系统中的潜在漏洞，快速进行指纹识别、漏洞利用条件判断和攻击载荷选择等操作。通过引入人工智能技术，渗透测试的效率和覆盖范围将大幅提升，减少重复性检测工作的负担。
    
- **降低对人工经验的依赖**：渗透测试对人员的技术水平和经验积累有着较高要求，不同红队成员之间的经验难以有效传递。人工智能可以学习并积累大量的攻击策略和经验，形成知识库，辅助渗透测试人员进行决策。这不仅降低了对个人经验的依赖，还提高了测试过程的标准化和一致性。
    
- **应对智能化的网络攻击，增强防御能力**：随着网络武器智能化的发展，攻击技术越发先进智能，防御手段面临严峻挑战。利用人工智能辅助渗透测试，可以模拟高级持续性威胁（APT）等复杂攻击场景，提前发现并修复系统脆弱点。这有助于提高网络防御机制的智能化水平，增强系统对未知漏洞和高级攻击的抵御能力，满足主动安全（Offensive Security）的需求。
## 版本2
- **提升渗透测试的效率和覆盖率，减少对人工经验的依赖**：传统的渗透测试对人员的技术水平和经验积累有着较高要求，且人工操作存在覆盖不完整和效率低下的问题。引入人工智能可以自动化处理指纹识别、漏洞利用条件判断、攻击载荷选择等复杂任务，减少重复性工作，提高测试效率和覆盖范围，从而降低对人工经验的依赖。
    
- **应对高级智能化攻击，增强网络防御能力**：随着攻击技术的智能化发展，网络武器的研发和利用速度加快，基于未知漏洞的攻击带来的危害不断加深。利用人工智能辅助渗透测试，可以模拟真实且高级的攻击情景，对应用系统进行高强度、高频次、智能化的测试，提前发现并修补安全漏洞，提升网络的整体防御能力。
    
- **推动渗透测试工具的智能化和集成化发展**：目前的大部分渗透测试工具仍处于半自动化阶段，功能相对单一。人工智能的应用可以促进工具的智能化升级，实现功能的集成化和自动化。智能化的渗透测试工具可以学习和积累经验，实现知识共享，弥补不同红队成员之间经验传递的不足，进一步提高渗透测试的效率和效果。

总结
提高渗透测试效率
降低人工经验依赖
增强网络防御能力
# 参考文献

# 主要内容
## 整体框架
攻防任务规划模块：该模块通过AI技术提升了网络攻防系统的推理和情境学习能力，实现了更智能化的任务调度。

攻防策略推理模块：基于静态知识、动态环境信息和人类专家经验，结合大语言模型推理增强技术，建立了一个策略推理框架。该框架通过上下文感知、异构知识语料和策略推理技术提供支撑与反馈。

攻防工具利用模块：通过构建AI驱动的攻防工具链，实现不同层次和功能的工具整合与调度，完成特定任务。该模块依赖于工具的原子化管理、自适应学习技术和工具进化机制，确保系统具备弹性和自我优化能力。这些模块共同作用，推动了网络安全大模型的任务调度和策略编排能力的提升，最终目标是增强网络安全的防护能力和洞察力。

Al+攻防任务规划
Al+攻防策略推理
Al+攻防工具利用
基于人工智能技术,提升网络攻防系统的多步骤推理能力、目标导向任务规划能力以及基于感知的情境学习能力,实现智能渗透作战任务调度。
基于异构动态知识图谱,融合静态领域知识、动态环境信息和专家经验等结合大语言模型推理增强技术,实现面向网络攻防任务的策略化推理框架。
构建AI模型驱动的攻防工具链,整合和运用不同层次、不同功能的工具完成特定任务,实现智能化多层次工具链调度。

智能渗透测试：利用知识图谱和强化学习，使得智能自动化渗透系统具备较高的灵活性和可扩展性，能够根据任务的复杂度和需求动态调整智能体的数量和分工，从而显著提升渗透测试的效率、准确性和覆盖率。

智能渗透问答：利用不同的渗透智能体，实现渗透测试过程的自动化，建立在ChatGPT的基础上，以互动模式运行，指导渗透测试人员的整体进展和具体操作。降低对个人经验的依赖，提高测试过程的标准化和一致性。
## 智能渗透测试
随着AI技术的引入，渗透测试正逐步迈向智能化。基于强化学习和知识图谱的渗透测试工具已经开始应用，并展现出显著优势。

**· 知识图谱的应用：**通过将网络拓扑结构、漏洞类型等信息进行结构化，知识图谱有效缩小了渗透测试的选择空间，帮助测试人员快速定位潜在漏洞。

**· 强化学习的作用：**强化学习能够动态调整渗透测试策略，借助多步决策选择最佳攻击路径，并根据测试反馈不断优化下一步的行动。

周昌令先生指出，智能化渗透测试中的一个重要突破是**意图驱动技术**。意图驱动的多智能体自动化渗透系统具备较高的灵活性和可扩展性，能够根据任务的复杂度和需求动态调整智能体的数量和分工，从而显著提升渗透测试的效率和准确性。

当多个智能体协同工作时，系统通过知识推理自动规划攻击路径并实施攻击。一旦某个漏洞满足利用条件，系统便会自动执行攻击，并更新知识库。如果条件未满足，漏洞会被赋予较低优先级，系统在空闲时执行该任务，并将学习结果反馈至知识图谱以更新利用条件。

在实际工作中，多智能体协同渗透测试一般包含如下五个阶段：

 任务分解：将渗透测试任务分解为多个子任务，如信息收集、漏洞利用、提权、横向移动等。  
 智能体设计：针对每个子任务，设计对应智能体的触发条件和影响。  
 意图传递：智能体通过高层次的任务表示传递目标和结果，实现协作。  
协同执行：多个智能体协同完成子任务，最终实现整个渗透测试流程。  
信息汇集：收集各智能体的执行结果，进行分析和汇总，指导下一步行动。

周昌令先生提到，在仿真靶场中，基于AI的自动化渗透测试工具能够成功利用多个漏洞，展示了其在真实场景中的适应能力。这些工具还在多个高水平网络安全比赛中表现出色，证明了其在网络攻防中的潜力。
## 智能渗透测试过程
### 阶段概述

1. **预攻击阶段**：这是渗透测试的准备和侦察阶段，主要目的是通过资产的侦察、扫描和识别，收集目标系统的相关信息，识别潜在的攻击面，为后续的攻击阶段打好基础。
    
2. **攻击阶段**：这一阶段是利用预攻击阶段所收集的信息制定攻击策略，实施针对目标的渗透测试操作，以便找到系统中的弱点并进行有效利用。
    

### 阶段详细解释

#### **预攻击阶段**

1. **资产侦察**：
    
    - 这一过程的目的是收集目标系统的所有可用信息，例如域名、IP地址、公开的网络服务等。资产侦察是一个反复循环的过程，通过不断进行侦察来发现新的目标资产。
    - 如果发现**有新资产**，则继续进行资产侦察；如果**没有新资产**，则进入下一步。
2. **资产测绘**：
    
    - 在资产侦察完成后，开始对收集到的资产进行测绘，包括标注每个资产的重要性、潜在的服务和应用等，帮助渗透测试人员全面了解目标系统的整体结构。
    - 如果仍然**发现新资产**，则返回到资产侦察阶段；如果**没有新资产**，继续进行端口扫描。
3. **端口扫描**：
    
    - 这一过程是通过对目标资产上的所有端口进行扫描，识别出开放的端口及其所对应的服务。这些端口可能会成为潜在的攻击入口。
4. **漏洞扫描**：
    
    - 在端口扫描的基础上，进一步对开放的服务进行漏洞扫描，以发现可能存在的已知漏洞。这些漏洞可能会被利用来进一步渗透目标系统。
5. **目录枚举**：
    
    - 最后，通过目录枚举来进一步了解目标系统中公开可访问的目录结构和文件信息，以便为后续的攻击阶段提供更多的可利用信息。

#### **攻击阶段**

1. **情报分析**：
    
    - 进入攻击阶段后，首先对预攻击阶段收集到的所有信息进行分析，形成全面的攻击情报，以确定最有可能成功的攻击路径。
2. **攻击面分析**：
    
    - 在情报分析的基础上，对目标系统的攻击面进行全面分析，识别出可以进行利用的点。这一步骤是确定哪些部分最容易成为攻击目标，评估其攻击难度和潜在收益。
3. **打点研究**：
    
    - 在攻击面分析完成后，进行“打点”研究，深入研究特定的漏洞或目标点，找出最佳的攻击方式。
4. **审核攻击计划**：
    
    - 在完成打点研究后，渗透测试团队需要审查攻击计划，确保计划的可行性和有效性。如果计划**未通过审查**，则需要重新进行打点研究并调整策略；如果计划**通过审查**，则可以进行下一步。
5. **部署并实施攻击**：
    
    - 最后，基于审查通过的攻击计划，部署并实施攻击。在这一过程中，渗透测试人员执行攻击操作，尝试利用之前分析出的漏洞和攻击点，获取对目标系统的控制权或者证明存在的安全缺陷。

### 总结

- **预攻击阶段**主要集中于资产的发现和信息的收集，目的是了解目标的整体情况，为攻击做好充分的准备。该阶段涉及资产侦察、资产测绘、端口扫描、漏洞扫描和目录枚举等步骤。
    
- **攻击阶段**则是基于预攻击阶段收集的信息，制定详细的攻击计划并付诸实践，以发现并利用目标系统中的安全弱点。
## 智能渗透问答
  
Plugins：Enhanced Search  Subdomain Finder
CVE Map   WAF Detector   Whois Lookup

![[attachments/whiteboard_exported_image (4).png]]
核心交互层：CHATS模块是用户与智能渗透问答系统之间的主要交互层。用户通过CHATS模块提出问题，系统将通过网络安全大模型进行分析处理，并选择相应插件进行更深层次的辅助操作。
Agent Plugins：CHATS模块配备了多个Agent Plugins，这些插件能够辅助用户完成特定渗透测试任务。通过集成多个功能，使渗透测试过程更加高效和系统化。除此之外，还可以根据具体需求添加新的插件，体现了模块的灵活性和可扩展性。

根据您提供的智能渗透问答模块的架构图，我可以为您撰写其主要功能和意义。以下是对该架构图的详细分析：

### 主要功能分析

1. **网络安全大模型**
    
    - **支持和驱动整体功能**：网络安全大模型是整个智能渗透问答模块的核心支撑。它通过其强大的自然语言处理（NLP）能力和深度学习算法，为用户提供有关网络安全的智能问答支持。这些大模型整合了广泛的安全知识库，能够回答复杂的安全问题，辅助渗透测试任务。
2. **CHATS模块**
    
    - **核心交互层**：该模块是用户与智能渗透问答系统之间的主要交互层。用户通过CHATS模块提出问题，系统将通过网络安全大模型进行分析处理，并通过插件进行更深层次的辅助操作。
3. **Agent Plugins（代理插件）**
    
    - **增强渗透测试功能**：CHATS模块配备了多个Agent Plugins，这些插件能够辅助用户完成特定渗透测试任务。图中列出了几个典型的插件，包括：
        - **Enhanced Search（增强搜索）**：为用户提供增强的情报搜索功能，帮助查找目标的更多信息，增加情报收集的深度和广度。
        - **Subdomain Finder（子域名查找）**：用来识别目标域名下的所有子域名，从而帮助测试人员了解目标的攻击面。
        - **CVE Map**：自动匹配和标记已知的漏洞（CVE），帮助用户迅速定位和评估漏洞的影响范围。
        - **Whois Lookup（Whois查询）**：查询域名的注册信息，获取有关目标组织或个人的信息，以便制定更有效的渗透测试策略。
    - **工具的扩展性**：这些Agent Plugins显著扩展了系统的渗透测试能力，通过集成多个功能，使渗透测试过程更加高效和系统化。除此之外，还可以根据具体需求添加新的插件，体现了模块的灵活性和可扩展性。
4. **智能渗透问答**
    
    - **基于用户反馈持续优化**：智能渗透问答模块通过不断接收用户反馈，来优化大模型的问答效果和功能完善度。用户的反馈是系统优化的关键，能够不断提升模型的智能化水平和响应能力。

### 主要意义

1. **智能化与自动化的结合**：该架构图展示了智能渗透问答模块如何结合网络安全大模型与多个Agent Plugins，通过智能化技术与自动化工具的结合，显著提高了渗透测试的效率和精准性，降低了人工操作的复杂性，尤其是对于需要大量信息收集和数据关联的任务。
    
2. **降低对经验的依赖，提升渗透测试质量**：通过集成CVE Map、Whois Lookup等插件，系统可以在渗透测试过程中自动进行大量的信息采集和分析。这种集成化的智能问答系统显著降低了对个人经验的依赖，使得新手也能够在智能系统的辅助下进行高质量的渗透测试。
    
3. **提升网络防御的主动性**：该系统不仅有助于渗透测试人员更好地模拟攻击场景，也能够在防御过程中为安全团队提供有力支持。在“攻防不对等”日益严重的情况下，通过智能问答模块，安全团队能够更快地获取与应对威胁相关的知识，并通过增强的自动化工具，快速采取防御行动。
    
4. **适应未来的网络安全需求**：随着网络威胁的日益复杂化和智能化，传统的渗透测试方法已无法满足高频次、快速响应的需求。智能渗透问答模块引入了AI和自动化工具，为渗透测试和防御提供了更智能、更高效的解决方案，适应未来不断发展的网络安全需求。
    

总结来说，该智能渗透问答模块通过网络安全大模型的智能问答能力与Agent Plugins的工具支持，实现了渗透测试过程的智能化与自动化，显著提升了渗透测试的效率、覆盖面和质量，推动了网络安全领域向更高效、更智能的方向发展。
# 任务规划
### 现在 – 2025.1

- **系统原型开发**：完成智能渗透测试系统和智能渗透问答模块的原型开发。实现初步的知识图谱和强化学习算法的整合，验证基本功能是否能有效支持智能化渗透测试过程。
- **数据收集与准备**：收集大量的网络渗透测试相关的数据，包括历史攻击记录、CVE漏洞信息等，为大模型的训练和知识图谱的构建提供数据支持。

### 2025.1 – 2025.3

- **知识图谱优化**：优化知识图谱的构建，整合更多不同领域的网络安全知识，提高智能渗透测试系统的覆盖率和知识完备度。
- **强化学习策略改进**：提升强化学习在渗透任务中的策略推理能力，使得系统在复杂攻击场景中的策略制定更加灵活和高效。

### 2025.3 – 2025.4

- **集成测试与系统调试**：对集成后的智能渗透测试系统进行全面的测试和调试，验证其与自动化渗透模块和问答模块的交互性能，确保系统能够根据任务复杂度进行自适应调整。
- **智能问答模块改进**：进一步优化基于ChatGPT的智能问答模块，使其能够更精准地辅助渗透测试人员，并逐步引入基于用户反馈的学习机制。

### 2025.4 – 2025.6

- **AI 渗透任务规划**：完善AI在渗透测试中的任务规划功能，包括多步骤推理、目标导向任务分解等，提升系统的任务调度和协调能力。
- **工具链集成与优化**：将AI驱动的渗透工具链与整个系统进一步整合，确保工具链的不同功能层次能够协同工作，完成特定的渗透任务。

### 2025.6 – 2025.10

- **系统性能评估与优化**：针对实际渗透测试任务进行全面的性能评估，识别系统在灵活性、响应速度、攻击策略生成等方面的不足，进行优化调整。
- **安全防护测试**：模拟不同的攻击场景，测试系统的智能渗透能力及其对目标系统的影响，并评估其在防御系统方面的潜在应用能力。

### 2025.10 – 2026.2

- **用户体验改进**：通过与测试用户的交互反馈，优化系统的人机界面和用户体验，使其更便于渗透测试人员的实际操作。
- **正式发布与推广**：在完成所有功能模块的开发与测试后，进行系统的正式发布，向渗透测试团队和相关网络安全团队推广。并为系统的部署和使用提供必要的培训和支持。

以上是各个时间段的任务规划，旨在逐步完善智能渗透测试解决方案，最终实现高效、自动化、智能化的渗透测试工具。