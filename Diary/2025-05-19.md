# Daily Study
## Daily Plan
#todo
- [x] 写博客
- [ ] 总结内存异常排查步骤
- [ ] 
## Eino
### 流式处理的优势
架构设计的支持：
- 在graph中，节点和边都内置了流式处理的逻辑，自动处理数据流的类型转换和状态传递，通过全局状态存储中间结果，支持流式处理的上下文延续
- 在类型安全上，定义了统一的流式处理方法，同时会在编译阶段就验证流式接口的正确性（例如文本流输入到图像处理）
核心机制：
- 自动流式转换：包括非流式输入的流式封装
## 创新资助申请
课题：基于openGuass的数据库网络安全威胁及漏洞研究

### 研究背景

随着云原生和大数据应用的快速发展，关系型数据库在企业级系统中承担着核心的存储与事务处理职能。openGauss 作为一款开源的高可用关系型数据库管理系统，全面兼容 SQL2003 标准语法，提供主备部署、多副本同步等高可用能力，在政务、金融、运营商等关键行业中，越来越多的业务系统开始基于( openGauss 构建，数据库的可靠性与安全性需求被进一步提升。
然而，随着基于 openGauss 的应用场景不断扩大，数据库系统面临的网络安全威胁也日益复杂。openGauss 系统的 server、datakit、数据迁移工具集（如 gs_portal、datachecker）等关键组件中，一旦存在网络层或应用层的安全漏洞，可能会被攻击者利用进行 SQL 注入、权限提升、数据泄露等攻击，严重时会导致用户敏感数据被篡改或窃取，给客户带来重大安全风险。因此，针对 openGauss 全栈组件的网络安全威胁与漏洞开展系统性研究，对于保障数据库的安全运行、提升产品质量，并推动社区生态健康发展具有重要意义。

### 拟解决的关键问题

问题一：如何牢固构建 openGauss 系统的安全边界，确保网络通信和数据传输安全？
问题二：如何在应用层全面防护输入风险，杜绝 SQL 注入与命令注入？
问题三：如何在权限模型与运行时监控层面实现最小权限控制与动态威胁响应，为 openGauss 全生命周期保驾护航？

问题一：关键模块通信链路安全薄弱，openGauss Server、DataKit 与数据迁移工具集（gs_rep_portal、datachecker）之间的网络通信缺乏统一加固策略，默认配置下可能出现明文传输、TLS 配置错误或证书管理不当，容易被中间人（MITM）、重放或协议降级攻击所利用。
问题二：模块边界风险感知与输入校验不足，在 Server 与各工具组件的 RPC/REST 接口、脚本拼装逻辑中，缺少系统化的动态风险检测和统一输入校验机制，导致 SQL 注入、命令注入、参数篡改等攻击面未被及时发现或阻断。
问题三：安全防护与响应闭环缺失，即便后续在单点部署了加固或检测措施，也缺乏端到端的验证与持续监控机制——缺少自动化渗透测试、实时审计告警与对抗反馈流程，无法形成发现→防护→验证→优化的安全闭环。

### 研究内容与技术路线
#### 问题一安全链路加固
基于问题一，我认为首先要基于 STRIDE 方法对openGauss server与datakit、数据迁移工具集(gs_portal、datachecker）等关键模块交互流量的进出路径进行全面建模，识别出欺骗、篡改、信息泄露等场景，形成相应威胁用例库。然后针对组件中的默认TLS配置和证书管理，进行提升并设计相应的自动化证书签发与轮换机制，提高安全性。最后基于透明加密与完整性校验理念，对比部署 IPsec 与 WireGuard 的吞吐与延迟，选取最优方案为server、datakit和数据迁移工具集等关键模块实现隧道封装方案来保证链路通信安全。



#### 问题二动态风险感知与输入防护
基于问题二，我认为首先要针对openGauss的SQL、Shell、REST等多种攻击面，基于OWASP ESAPI，统一相关的输入校验库。然后汇总覆盖openGauss Server、DataKit、gs_portal、datachecker的高危攻击手法的测试用例集，结合自动化测试框架实现CI/CD相关验证。最后在 Server 核心与 DataKit 插件加载点植入轻量级 Hook 模块，实时拦截可疑参数，记录上下文并支持隔离或回滚操作。

#### 问题三安全防护与响应闭环
基于问题三，我认为要构建一个自动化渗透与实时审计告警的平台。首先要集成 SCA、动态扫描与自定义渗透脚本，实现对关键模块的持续漏洞检测，同时对社区发布的安全补丁执行二次验证，生成回归测试报告，确保补丁覆盖所有威胁用例且不引入性能或功能回归。然后启用 openGauss 原生审计功能，将关键 DDL/DML 操作写入平台进行联动，实现多维度异常检测与可视化告警。最后建立“发现 → 防护 → 验证 → 优化”闭环流程，与 openGauss 安全团队深度协作，定期汇报评估结果并推动最佳实践落地。




## 问题一的解决思路

针对关键模块间通信链路易受中间人、重放及协议降级攻击的现状，本方案首先采用 STRIDE 方法对 openGauss Server、DataKit 及数据迁移工具集（gs_portal、datachecker）之间的进出流量进行建模，系统化识别欺骗（Spoofing）、篡改（Tampering）、信息泄露（Information Disclosure）等典型威胁场景，并由此形成覆盖面广泛的威胁用例库。接着，基于现有 TLS 默认配置的薄弱性，设计并实现自动化的证书签发与轮换机制，将所有组件默认升级至 TLS1.3，并在证书即将到期或校验失败时自动发起更新，以消除人为配置失误带来的风险。最后，围绕“透明加密＋完整性校验”理念，对比评估 IPsec 与 WireGuard 在百毫秒级延迟与千级 TPS 吞吐下的表现，并选取最优方案为上述关键模块构建轻量级隧道封装，确保流量全程机密性与不可篡改性。

研究内容集中在：

- 构建基于 STRIDE 的网络威胁用例库，覆盖 Server↔DataKit、Server↔gs_portal、Server↔datachecker 等交互路径；
    
- 设计可插拔的自动化证书生命周期管理组件，实现全链路 TLS 强制升级；
    
- 基于 WireGuard（或 IPsec）实现透明隧道封装，并开展性能与安全评估对比。
    

技术路线分为三个主要步骤：

1. **威胁建模与用例库构建**：
    
    - 利用 STRIDE 方法梳理组件间所有网络入口与出口，绘制通信拓扑与数据流图；
        
    - 针对每条数据流定义欺骗、篡改、泄露等威胁场景，编写可复用的渗透测试脚本，形成威胁用例库。
        
2. **自动化证书管理设计**：
    
    - 在配置中心集成证书签发接口，支持批量生成、分发与安装；
        
    - 实现轮换策略：到期前 7 天自动预警并更新，异常状态自动回滚与重试。
        
3. **隧道封装方案实施**：
    
    - 部署 WireGuard（或 IPsec）隧道，配置密钥与策略，实现透明加密与完整性校验；
        
    - 通过压力测试与安全测试评估延迟、吞吐与抗攻击能力，选择最优方案并形成部署手册。
        

---

## 问题二的解决思路

针对 openGauss Server 及 DataKit、gs_portal、datachecker 等组件在 RPC/REST 接口及脚本拼装处缺乏统一输入校验与动态风险感知的问题，方案先基于 OWASP ESAPI 标准，打造一套兼容 SQL、Shell、REST 的输入验证库，提供正则白名单、输出编码、参数化接口等防护手段。随后，汇总覆盖上述组件的高危注入与参数篡改手法，构建完整的测试用例集，并将其整合进 CI/CD 自动化测试管道，实现持续回归检测。最后，在 Server 核心及 DataKit 插件加载点植入轻量级 Hook 模块，实时拦截并记录可疑输入参数，上报风险中心，并支持请求隔离或回滚，以便在攻击初期即刻阻断威胁。

研究内容集中在：

- 设计兼顾多种攻击面的统一 ESAPI 校验库，标准化输入清洗与编码流程；
    
- 构建涵盖 SQL 注入、命令注入、RPC 参数篡改等高危手法的自动化测试用例集；
    
- 开发运行时 Hook 模块，实现可疑参数的实时拦截、上下文记录与风险隔离。
    

技术路线分为三个主要步骤：

1. **输入校验库开发**：
    
    - 基于 OWASP ESAPI，定义正则白名单、输出编码策略及参数化接口；
        
    - 封装 SQL、Shell、REST 三大面向调用方式的统一调用包。
        
2. **测试用例集与 CI/CD 集成**：
    
    - 收集并实现典型注入、篡改攻击脚本，覆盖 Server、DataKit、gs_portal、datachecker；
        
    - 在 Jenkins/GitLab CI 中配置定时与 Pull Request 流水线，自动化执行并报告风险回归。
        
3. **运行时 Hook 模块植入**：
    
    - 在 Server 核心与 DataKit 插件入口处接入轻量拦截器，监测并标记可疑输入；
        
    - 将上下文信息上报安全中心，可选隔离或回滚，并生成可视化告警。
        

---

## 问题三的解决思路

为解决单点部署防护后无法持续验证和优化的问题，方案构建“自动化渗透 → 实时审计 → 告警响应 → 持续优化”四步闭环平台。首先在 CI/CD 流程中集成 SCA、动态扫描及自定义渗透脚本，实现关键模块的持续漏洞探测，并对社区安全补丁进行二次回归验证，保证补丁既能覆盖所有威胁用例又无功能或性能回归。其次，启用 openGauss 原生审计，将关键 DDL/DML 操作及 Hook 告警写入 ELK/SIEM 平台，开展多维度关联分析与可视化监控。再次，基于审计流和渗透结果，设定多级告警策略（如连续异常操作触发实例隔离或短信通知），并在安全事件发生后自动生成修复建议。最后，围绕“发现→防护→验证→优化”闭环，定期召开评估会并与 openGauss 社区安全团队协作，将改进意见反馈至项目源码和实践指南，实现安全治理的持续迭代。

研究内容集中在：

- 集成开源与自研工具，打造自动化渗透与补丁验证流水线；
    
- 利用审计日志与安全中心，构建多维度实时告警与可视化平台；
    
- 建立安全事件闭环流程，实现防护措施的持续验证与优化反馈。
    

技术路线分为三个主要步骤：

1. **自动化渗透与补丁回归**：
    
    - 在 CI/CD 中接入 SCA、DAST、渗透脚本，定期评估 Server、DataKit、gs_portal、datachecker；
        
    - 对社区安全补丁做二次测试，输出覆盖率与性能回归报告。
        
2. **实时审计与告警平台**：
    
    - 配置 openGauss 审计功能，将日志导入 ELK/SIEM，构建多维度告警模型；
        
    - 设定告警级别与响应动作（隔离、通知、自动修复建议）。
        
3. **安全闭环与持续优化**：
    
    - 定期汇总渗透与审计数据，召开评估会，形成改进方案；
        
    - 与 openGauss 社区同步最佳实践，并发布工具、文档与用例，实现持续迭代。

## 问题二的解决思路

针对 openGauss Server、DataKit、gs_portal、datachecker 等关键模块可能存在的注入攻击、权限提升、数据泄露等网络安全风险，本方案首先通过社区 CVE 与安全公告梳理已知漏洞，结合代码审计与动态扫描，构建风险分类目录 [opengauss.org](https://opengauss.org/en/security-advisories/?utm_source=chatgpt.com)[NVD](https://nvd.nist.gov/vuln/detail/CVE-2024-40575?utm_source=chatgpt.com)；其次，深入研究 SQL 注入（Injection）、命令注入、RPC 参数篡改等典型攻击手法，并基于OWASP ESAPI标准，制定正则白名单、输出编码与参数化接口的统一输入校验库 [Wikipedia](https://en.wikipedia.org/wiki/SQL_injection?utm_source=chatgpt.com)[Legit Security](https://www.legitsecurity.com/aspm-knowledge-base/what-is-privilege-escalation?utm_source=chatgpt.com)；随后，采用模糊测试（Fuzzing）技术，利用 AFL++、libFuzzer、Honggfuzz 等开源工具，对关键组件接口进行变异输入测试，挖掘未知漏洞 [devhunt.org](https://devhunt.org/blog/open-source-fuzzing-tools-for-beginners?utm_source=chatgpt.com)[arXiv](https://arxiv.org/abs/2311.06728?utm_source=chatgpt.com)；最后，将所有注入、提权与泄露场景整理成安全测试与攻击用例库，并集成于 CI/CD 自动化测试管道，实现持续化回归验证 [Fortinet](https://www.fortinet.com/resources/cyberglossary/data-leak?utm_source=chatgpt.com)[Cyberly](https://www.cyberly.org/en/how-do-you-use-sqlmap-to-escalate-privileges-via-sql-injection/index.html?utm_source=chatgpt.com)。

### 研究内容集中在：

- 已知漏洞与代码审计驱动的风险分类目录；
    
- OWASP ESAPI 驱动的统一输入校验库设计；
    
- 基于开源模糊测试工具的漏洞发现与用例生成；
    
- 注入、提权与泄露攻击用例库构建与维护。
    

### 技术路线分为三个主要步骤：

1. **风险识别与分类**
    
    - 调研 openGauss CVE 与社区安全公告；
        
    - 对 Server、DataKit、gs_portal、datachecker 源码进行静态审计与动态扫描。
        
2. **攻击用例库构建**
    
    - 汇总 SQL 注入、命令注入、RPC 篡改、权限提升、数据泄露等手法；
        
    - 利用 AFL++、libFuzzer、Honggfuzz 等工具生成模糊测试脚本。
        
3. **CI/CD 集成与回归验证**
    
    - 在 Jenkins/GitLab CI 中植入自动化测试任务；
        
    - 定时执行攻击用例集，输出覆盖率与风险回归报告。